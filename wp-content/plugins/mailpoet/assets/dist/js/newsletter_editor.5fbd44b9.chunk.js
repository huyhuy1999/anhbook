(window.mailpoetJsonp=window.mailpoetJsonp||[]).push([[6,3],{105:function(e,t,i){!function(i){"use strict";if(i){var o,n,r,s=(r=i.document.createTextNode("")).ownerDocument!==i.document&&"function"==typeof i.wrap&&i.wrap(r)===r?i.wrap(i):i,a=s.document,l=s.DocumentFragment||q,c=s.SVGElement||q,d=s.SVGSVGElement||q,h=s.SVGElementInstance||q,p=s.HTMLElement||s.Element,u=s.PointerEvent||s.MSPointerEvent,g=Math.hypot||function(e,t){return Math.sqrt(e*e+t*t)},f={},m=[],_=[],v=[],w=!1,y={},b={base:{accept:null,actionChecker:null,styleCursor:!0,preventDefault:"auto",origin:{x:0,y:0},deltaSource:"page",allowFrom:null,ignoreFrom:null,_context:a,dropChecker:null},drag:{enabled:!1,manualStart:!0,max:1/0,maxPerElement:1,snap:null,restrict:null,inertia:null,autoScroll:null,axis:"xy"},drop:{enabled:!1,accept:null,overlap:"pointer"},resize:{enabled:!1,manualStart:!1,max:1/0,maxPerElement:1,snap:null,restrict:null,inertia:null,autoScroll:null,square:!1,preserveAspectRatio:!1,axis:"xy",margin:NaN,edges:null,invert:"none"},gesture:{manualStart:!1,enabled:!1,max:1/0,maxPerElement:1,restrict:null},perAction:{manualStart:!1,max:1/0,maxPerElement:1,snap:{enabled:!1,endOnly:!1,range:1/0,targets:null,offsets:null,relativePoints:null},restrict:{enabled:!1,endOnly:!1},autoScroll:{enabled:!1,container:null,margin:60,speed:300},inertia:{enabled:!1,resistance:10,minSpeed:100,endSpeed:10,allowResume:!0,zeroResumeDelta:!0,smoothEndDuration:300}},_holdDuration:600},x={interaction:null,i:null,x:0,y:0,scroll:function(){var e,t,i,o,n=x.interaction.target.options[x.interaction.prepared.name].autoScroll,r=n.container||ue(x.interaction.element),s=(new Date).getTime(),a=(s-x.prevTimeX)/1e3,l=(s-x.prevTimeY)/1e3;n.velocity?(e=n.velocity.x,t=n.velocity.y):e=t=n.speed,o=t*l,((i=e*a)>=1||o>=1)&&(X(r)?r.scrollBy(x.x*i,x.y*o):r&&(r.scrollLeft+=x.x*i,r.scrollTop+=x.y*o),i>=1&&(x.prevTimeX=s),o>=1&&(x.prevTimeY=s)),x.isScrolling&&(z(x.i),x.i=I(x.scroll))},isScrolling:!1,prevTimeX:0,prevTimeY:0,start:function(e){x.isScrolling=!0,z(x.i),x.interaction=e,x.prevTimeX=(new Date).getTime(),x.prevTimeY=(new Date).getTime(),x.i=I(x.scroll)},stop:function(){x.isScrolling=!1,z(x.i)}},k="ontouchstart"in s||s.DocumentTouch&&a instanceof s.DocumentTouch,C=u&&!/Chrome/.test(navigator.userAgent),S=k||C?20:10,T=1,V=0,B=1/0,E=a.all&&!s.atob?{drag:"move",resizex:"e-resize",resizey:"s-resize",resizexy:"se-resize",resizetop:"n-resize",resizeleft:"w-resize",resizebottom:"s-resize",resizeright:"e-resize",resizetopleft:"se-resize",resizebottomright:"se-resize",resizetopright:"ne-resize",resizebottomleft:"ne-resize",gesture:""}:{drag:"move",resizex:"ew-resize",resizey:"ns-resize",resizexy:"nwse-resize",resizetop:"ns-resize",resizeleft:"ew-resize",resizebottom:"ns-resize",resizeright:"ew-resize",resizetopleft:"nwse-resize",resizebottomright:"nwse-resize",resizetopright:"nesw-resize",resizebottomleft:"nesw-resize",gesture:""},M={drag:!0,resize:!0,gesture:!0},P="onmousewheel"in a?"mousewheel":"wheel",A=["dragstart","dragmove","draginertiastart","dragend","dragenter","dragleave","dropactivate","dropdeactivate","dropmove","drop","resizestart","resizemove","resizeinertiastart","resizeend","gesturestart","gesturemove","gestureinertiastart","gestureend","down","move","up","cancel","tap","doubletap","hold"],D={},R="Opera"==navigator.appName&&k&&navigator.userAgent.match("Presto"),O=/iP(hone|od|ad)/.test(navigator.platform)&&/OS 7[^\d]/.test(navigator.appVersion),F="matches"in Element.prototype?"matches":"webkitMatchesSelector"in Element.prototype?"webkitMatchesSelector":"mozMatchesSelector"in Element.prototype?"mozMatchesSelector":"oMatchesSelector"in Element.prototype?"oMatchesSelector":"msMatchesSelector",I=i.requestAnimationFrame,z=i.cancelAnimationFrame,N=function(){var e="attachEvent"in s&&!("addEventListener"in s),t=e?"attachEvent":"addEventListener",i=e?"detachEvent":"removeEventListener",o=e?"on":"",n=[],r=[],a=[];function l(){this.returnValue=!1}function c(){this.cancelBubble=!0}function d(){this.cancelBubble=!0,this.immediatePropagationStopped=!0}return{add:function(i,s,h,p){var u=Ge(n,i),g=r[u];if(g||(g={events:{},typeCount:0},u=n.push(i)-1,r.push(g),a.push(e?{supplied:[],wrapped:[],useCount:[]}:null)),g.events[s]||(g.events[s]=[],g.typeCount++),!Ke(g.events[s],h)){var f;if(e){var m=a[u],_=Ge(m.supplied,h),v=m.wrapped[_]||function(e){e.immediatePropagationStopped||(e.target=e.srcElement,e.currentTarget=i,e.preventDefault=e.preventDefault||l,e.stopPropagation=e.stopPropagation||c,e.stopImmediatePropagation=e.stopImmediatePropagation||d,/mouse|click/.test(e.type)&&(e.pageX=e.clientX+ue(i).document.documentElement.scrollLeft,e.pageY=e.clientY+ue(i).document.documentElement.scrollTop),h(e))};f=i[t](o+s,v,Boolean(p)),-1===_?(m.supplied.push(h),m.wrapped.push(v),m.useCount.push(1)):m.useCount[_]++}else f=i[t](s,h,p||!1);return g.events[s].push(h),f}},remove:function t(s,l,c,d){var h,p,u,g=Ge(n,s),f=r[g],m=c;if(f&&f.events)if(e&&(u=Ge((p=a[g]).supplied,c),m=p.wrapped[u]),"all"!==l){if(f.events[l]){var _=f.events[l].length;if("all"===c){for(h=0;h<_;h++)t(s,l,f.events[l][h],Boolean(d));return}for(h=0;h<_;h++)if(f.events[l][h]===c){s[i](o+l,m,d||!1),f.events[l].splice(h,1),e&&p&&(p.useCount[u]--,0===p.useCount[u]&&(p.supplied.splice(u,1),p.wrapped.splice(u,1),p.useCount.splice(u,1)));break}f.events[l]&&0===f.events[l].length&&(f.events[l]=null,f.typeCount--)}f.typeCount||(r.splice(g,1),n.splice(g,1),a.splice(g,1))}else for(l in f.events)f.events.hasOwnProperty(l)&&t(s,l,"all")},useAttachEvent:e,_elements:n,_targets:r,_attachedListeners:a}}(),L={webkit:/(Movement[XY]|Radius[XY]|RotationAngle|Force)$/};Re.prototype={getPageXY:function(e,t){return ce(e,t)},getClientXY:function(e,t){return de(e,t)},setEventXY:function(e,t){return i=e,ce(n=(o=t).length>1?_e(o):o[0],f),i.page.x=f.x,i.page.y=f.y,de(n,f),i.client.x=f.x,i.client.y=f.y,void(i.timeStamp=(new Date).getTime());var i,o,n},pointerOver:function(e,t,i){if(!this.prepared.name&&this.mouse){var n=[],r=[],s=this.element;this.addPointer(e),!this.target||!Be(this.target,this.element,i)&&Ee(this.target,this.element,i)||(this.target=null,this.element=null,this.matches=[],this.matchElements=[]);var a=_.get(i),l=a&&!Be(a,i,i)&&Ee(a,i,i)&&We(a.getAction(e,t,this,i),a);l&&!De(a,i,l)&&(l=null),l?(this.target=a,this.element=i,this.matches=[],this.matchElements=[]):(_.forEachSelector(function(e,t){e&&Ve(e,i)&&!Be(e,i,i)&&Ee(e,i,i)&&Qe(i,t)&&(n.push(e),r.push(i))}),this.validateSelector(e,t,n,r)?(this.matches=n,this.matchElements=r,this.pointerHover(e,t,this.matches,this.matchElements),N.add(i,C?o.move:"mousemove",$.pointerHover)):this.target&&(Ce(s,i)?(this.pointerHover(e,t,this.matches,this.matchElements),N.add(this.element,C?o.move:"mousemove",$.pointerHover)):(this.target=null,this.element=null,this.matches=[],this.matchElements=[])))}},pointerHover:function(e,t,i,o,n,r){var s,a=this.target;!this.prepared.name&&this.mouse?(this.setEventXY(this.curCoords,[e]),n?s=this.validateSelector(e,t,n,r):a&&(s=We(a.getAction(this.pointers[0],t,this,this.element),this.target)),a&&a.options.styleCursor&&(a._doc.documentElement.style.cursor=s?Ne(s):"")):this.prepared.name&&this.checkAndPreventDefault(t,a,this.element)},pointerOut:function(e,t,i){this.prepared.name||(_.get(i)||N.remove(i,C?o.move:"mousemove",$.pointerHover),this.target&&this.target.options.styleCursor&&!this.interacting()&&(this.target._doc.documentElement.style.cursor=""))},selectorDown:function(e,t,i,o){var r,s=this,a=N.useAttachEvent?oe({},t):t,l=i,c=this.addPointer(e);if(this.holdTimers[c]=setTimeout(function(){s.pointerHold(N.useAttachEvent?a:e,a,i,o)},b._holdDuration),this.pointerIsDown=!0,this.inertiaStatus.active&&this.target.selector)for(;Y(l);){if(l===this.element&&We(this.target.getAction(e,t,this,this.element),this.target).name===this.prepared.name)return z(this.inertiaStatus.i),this.inertiaStatus.active=!1,void this.collectEventTargets(e,t,i,"down");l=Te(l)}if(this.interacting())this.collectEventTargets(e,t,i,"down");else{for(this.setEventXY(this.curCoords,[e]),this.downEvent=t;Y(l)&&!r;)this.matches=[],this.matchElements=[],_.forEachSelector(d),r=this.validateSelector(e,t,this.matches,this.matchElements),l=Te(l);if(r)return this.prepared.name=r.name,this.prepared.axis=r.axis,this.prepared.edges=r.edges,this.collectEventTargets(e,t,i,"down"),this.pointerDown(e,t,i,o,r);this.downTimes[c]=(new Date).getTime(),this.downTargets[c]=i,ne(this.downPointer,e),re(this.prevCoords,this.curCoords),this.pointerWasMoved=!1,this.collectEventTargets(e,t,i,"down")}function d(e,t,o){var r=n?o.querySelectorAll(t):void 0;Ve(e,l)&&!Be(e,l,i)&&Ee(e,l,i)&&Qe(l,t,r)&&(s.matches.push(e),s.matchElements.push(l))}},pointerDown:function(e,t,i,o,n){if(n||this.inertiaStatus.active||!this.pointerWasMoved||!this.prepared.name){this.pointerIsDown=!0,this.downEvent=t;var r,s=this.addPointer(e);if(this.pointerIds.length>1&&this.target._element===this.element){var a=We(n||this.target.getAction(e,t,this,this.element),this.target);De(this.target,this.element,a)&&(r=a),this.prepared.name=null}else if(!this.prepared.name){var l=_.get(o);l&&!Be(l,o,i)&&Ee(l,o,i)&&(r=We(n||l.getAction(e,t,this,o),l))&&De(l,o,r)&&(this.target=l,this.element=o)}var c=this.target,d=c&&c.options;if(!c||!n&&this.prepared.name)this.inertiaStatus.active&&o===this.element&&We(c.getAction(e,t,this,this.element),c).name===this.prepared.name&&(z(this.inertiaStatus.i),this.inertiaStatus.active=!1,this.checkAndPreventDefault(t,c,this.element));else{if(r=r||We(n||c.getAction(e,t,this,o),c,this.element),this.setEventXY(this.startCoords,this.pointers),!r)return;d.styleCursor&&(c._doc.documentElement.style.cursor=Ne(r)),this.resizeAxes="resize"===r.name?r.axis:null,"gesture"===r&&this.pointerIds.length<2&&(r=null),this.prepared.name=r.name,this.prepared.axis=r.axis,this.prepared.edges=r.edges,this.snapStatus.snappedX=this.snapStatus.snappedY=this.restrictStatus.restrictedX=this.restrictStatus.restrictedY=NaN,this.downTimes[s]=(new Date).getTime(),this.downTargets[s]=i,ne(this.downPointer,e),re(this.prevCoords,this.startCoords),this.pointerWasMoved=!1,this.checkAndPreventDefault(t,c,this.element)}}else this.checkAndPreventDefault(t,this.target,this.element)},setModifications:function(e,t){var i=this.target,o=!0,n=Pe(i,this.prepared.name)&&(!i.options[this.prepared.name].snap.endOnly||t),r=Ae(i,this.prepared.name)&&(!i.options[this.prepared.name].restrict.endOnly||t);return n?this.setSnapping(e):this.snapStatus.locked=!1,r?this.setRestriction(e):this.restrictStatus.restricted=!1,n&&this.snapStatus.locked&&!this.snapStatus.changed?o=r&&this.restrictStatus.restricted&&this.restrictStatus.changed:r&&this.restrictStatus.restricted&&!this.restrictStatus.changed&&(o=!1),o},setStartOffsets:function(e,t,i){var o,n,r=t.getRect(i),s=be(t,i),a=t.options[this.prepared.name].snap,l=t.options[this.prepared.name].restrict;r?(this.startOffset.left=this.startCoords.page.x-r.left,this.startOffset.top=this.startCoords.page.y-r.top,this.startOffset.right=r.right-this.startCoords.page.x,this.startOffset.bottom=r.bottom-this.startCoords.page.y,o="width"in r?r.width:r.right-r.left,n="height"in r?r.height:r.bottom-r.top):this.startOffset.left=this.startOffset.top=this.startOffset.right=this.startOffset.bottom=0,this.snapOffsets.splice(0);var c=a&&"startCoords"===a.offset?{x:this.startCoords.page.x-s.x,y:this.startCoords.page.y-s.y}:a&&a.offset||{x:0,y:0};if(r&&a&&a.relativePoints&&a.relativePoints.length)for(var d=0;d<a.relativePoints.length;d++)this.snapOffsets.push({x:this.startOffset.left-o*a.relativePoints[d].x+c.x,y:this.startOffset.top-n*a.relativePoints[d].y+c.y});else this.snapOffsets.push(c);r&&l.elementRect?(this.restrictOffset.left=this.startOffset.left-o*l.elementRect.left,this.restrictOffset.top=this.startOffset.top-n*l.elementRect.top,this.restrictOffset.right=this.startOffset.right-o*(1-l.elementRect.right),this.restrictOffset.bottom=this.startOffset.bottom-n*(1-l.elementRect.bottom)):this.restrictOffset.left=this.restrictOffset.top=this.restrictOffset.right=this.restrictOffset.bottom=0},start:function(e,t,i){this.interacting()||!this.pointerIsDown||this.pointerIds.length<("gesture"===e.name?2:1)||(-1===Ge(v,this)&&v.push(this),this.prepared.name||this.setEventXY(this.startCoords,this.pointers),this.prepared.name=e.name,this.prepared.axis=e.axis,this.prepared.edges=e.edges,this.target=t,this.element=i,this.setStartOffsets(e.name,t,i),this.setModifications(this.startCoords.page),this.prevEvent=this[this.prepared.name+"Start"](this.downEvent))},pointerMove:function(e,t,i,o,r){if(this.inertiaStatus.active){var s=this.inertiaStatus.upCoords.page,a=this.inertiaStatus.upCoords.client,l={pageX:s.x+this.inertiaStatus.sx,pageY:s.y+this.inertiaStatus.sy,clientX:a.x+this.inertiaStatus.sx,clientY:a.y+this.inertiaStatus.sy};this.setEventXY(this.curCoords,[l])}else this.recordPointer(e),this.setEventXY(this.curCoords,this.pointers);var c,d,h=this.curCoords.page.x===this.prevCoords.page.x&&this.curCoords.page.y===this.prevCoords.page.y&&this.curCoords.client.x===this.prevCoords.client.x&&this.curCoords.client.y===this.prevCoords.client.y,p=this.mouse?0:Ge(this.pointerIds,he(e));if(this.pointerIsDown&&!this.pointerWasMoved&&(c=this.curCoords.client.x-this.startCoords.client.x,d=this.curCoords.client.y-this.startCoords.client.y,this.pointerWasMoved=g(c,d)>T),h||this.pointerIsDown&&!this.pointerWasMoved||(this.pointerIsDown&&clearTimeout(this.holdTimers[p]),this.collectEventTargets(e,t,i,"move")),this.pointerIsDown)if(h&&this.pointerWasMoved&&!r)this.checkAndPreventDefault(t,this.target,this.element);else if(se(this.pointerDelta,this.prevCoords,this.curCoords),this.prepared.name){if(this.pointerWasMoved&&(!this.inertiaStatus.active||e instanceof Ie&&/inertiastart/.test(e.type))){if(!this.interacting()&&(se(this.pointerDelta,this.prevCoords,this.curCoords),"drag"===this.prepared.name)){var u=Math.abs(c),f=Math.abs(d),m=this.target.options.drag.axis,v=u>f?"x":u<f?"y":"xy";if("xy"!==v&&"xy"!==m&&m!==v){this.prepared.name=null;for(var w=i;Y(w);){var y=_.get(w);if(y&&y!==this.target&&!y.options.drag.manualStart&&"drag"===y.getAction(this.downPointer,this.downEvent,this,w).name&&Me(v,y)){this.prepared.name="drag",this.target=y,this.element=w;break}w=Te(w)}if(!this.prepared.name){var b=this,x=function(e,t,o){var r=n?o.querySelectorAll(t):void 0;if(e!==b.target)return Ve(e,i)&&!e.options.drag.manualStart&&!Be(e,w,i)&&Ee(e,w,i)&&Qe(w,t,r)&&"drag"===e.getAction(b.downPointer,b.downEvent,b,w).name&&Me(v,e)&&De(e,w,"drag")?e:void 0};for(w=i;Y(w);){var k=_.forEachSelector(x);if(k){this.prepared.name="drag",this.target=k,this.element=w;break}w=Te(w)}}}}var C=!!this.prepared.name&&!this.interacting();if(C&&(this.target.options[this.prepared.name].manualStart||!De(this.target,this.element,this.prepared)))return void this.stop(t);if(this.prepared.name&&this.target)C&&this.start(this.prepared,this.target,this.element),(this.setModifications(this.curCoords.page,r)||C)&&(this.prevEvent=this[this.prepared.name+"Move"](t)),this.checkAndPreventDefault(t,this.target,this.element)}re(this.prevCoords,this.curCoords),(this.dragging||this.resizing)&&this.autoScrollMove(e)}},dragStart:function(e){var t=new Ie(this,e,"drag","start",this.element);this.dragging=!0,this.target.fire(t),this.activeDrops.dropzones=[],this.activeDrops.elements=[],this.activeDrops.rects=[],this.dynamicDrop||this.setActiveDrops(this.element);var i=this.getDropEvents(e,t);return i.activate&&this.fireActiveDrops(i.activate),t},dragMove:function(e){var t=this.target,i=new Ie(this,e,"drag","move",this.element),o=this.element,n=this.getDrop(i,e,o);this.dropTarget=n.dropzone,this.dropElement=n.element;var r=this.getDropEvents(e,i);return t.fire(i),r.leave&&this.prevDropTarget.fire(r.leave),r.enter&&this.dropTarget.fire(r.enter),r.move&&this.dropTarget.fire(r.move),this.prevDropTarget=this.dropTarget,this.prevDropElement=this.dropElement,i},resizeStart:function(e){var t=new Ie(this,e,"resize","start",this.element);if(this.prepared.edges){var i=this.target.getRect(this.element);if(this.target.options.resize.square||this.target.options.resize.preserveAspectRatio){var o=oe({},this.prepared.edges);o.top=o.top||o.left&&!o.bottom,o.left=o.left||o.top&&!o.right,o.bottom=o.bottom||o.right&&!o.top,o.right=o.right||o.bottom&&!o.left,this.prepared._linkedEdges=o}else this.prepared._linkedEdges=null;this.target.options.resize.preserveAspectRatio&&(this.resizeStartAspectRatio=i.width/i.height),this.resizeRects={start:i,current:oe({},i),restricted:oe({},i),previous:oe({},i),delta:{left:0,right:0,width:0,top:0,bottom:0,height:0}},t.rect=this.resizeRects.restricted,t.deltaRect=this.resizeRects.delta}return this.target.fire(t),this.resizing=!0,t},resizeMove:function(e){var t=new Ie(this,e,"resize","move",this.element),i=this.prepared.edges,o=this.target.options.resize.invert,n="reposition"===o||"negate"===o;if(i){var r,s=t.dx,a=t.dy,l=this.resizeRects.start,c=this.resizeRects.current,d=this.resizeRects.restricted,h=this.resizeRects.delta,p=oe(this.resizeRects.previous,d),u=i;if(this.target.options.resize.preserveAspectRatio){var g=this.resizeStartAspectRatio;i=this.prepared._linkedEdges,u.left&&u.bottom||u.right&&u.top?a=-s/g:u.left||u.right?a=s/g:(u.top||u.bottom)&&(s=a*g)}else this.target.options.resize.square&&(i=this.prepared._linkedEdges,u.left&&u.bottom||u.right&&u.top?a=-s:u.left||u.right?a=s:(u.top||u.bottom)&&(s=a));if(i.top&&(c.top+=a),i.bottom&&(c.bottom+=a),i.left&&(c.left+=s),i.right&&(c.right+=s),n){if(oe(d,c),"reposition"===o)d.top>d.bottom&&(r=d.top,d.top=d.bottom,d.bottom=r),d.left>d.right&&(r=d.left,d.left=d.right,d.right=r)}else d.top=Math.min(c.top,l.bottom),d.bottom=Math.max(c.bottom,l.top),d.left=Math.min(c.left,l.right),d.right=Math.max(c.right,l.left);for(var f in d.width=d.right-d.left,d.height=d.bottom-d.top,d)h[f]=d[f]-p[f];t.edges=this.prepared.edges,t.rect=d,t.deltaRect=h}return this.target.fire(t),t},gestureStart:function(e){var t=new Ie(this,e,"gesture","start",this.element);return t.ds=0,this.gesture.startDistance=this.gesture.prevDistance=t.distance,this.gesture.startAngle=this.gesture.prevAngle=t.angle,this.gesture.scale=1,this.gesturing=!0,this.target.fire(t),t},gestureMove:function(e){return this.pointerIds.length?((t=new Ie(this,e,"gesture","move",this.element)).ds=t.scale-this.gesture.scale,this.target.fire(t),this.gesture.prevAngle=t.angle,this.gesture.prevDistance=t.distance,t.scale===1/0||null===t.scale||void 0===t.scale||isNaN(t.scale)||(this.gesture.scale=t.scale),t):this.prevEvent;var t},pointerHold:function(e,t,i){this.collectEventTargets(e,t,i,"hold")},pointerUp:function(e,t,i,o){var n=this.mouse?0:Ge(this.pointerIds,he(e));clearTimeout(this.holdTimers[n]),this.collectEventTargets(e,t,i,"up"),this.collectEventTargets(e,t,i,"tap"),this.pointerEnd(e,t,i,o),this.removePointer(e)},pointerCancel:function(e,t,i,o){var n=this.mouse?0:Ge(this.pointerIds,he(e));clearTimeout(this.holdTimers[n]),this.collectEventTargets(e,t,i,"cancel"),this.pointerEnd(e,t,i,o),this.removePointer(e)},ie8Dblclick:function(e,t,i){this.prevTap&&t.clientX===this.prevTap.clientX&&t.clientY===this.prevTap.clientY&&i===this.prevTap.target&&(this.downTargets[0]=i,this.downTimes[0]=(new Date).getTime(),this.collectEventTargets(e,t,i,"tap"))},pointerEnd:function(e,t,i,o){var n,r=this.target,s=r&&r.options,a=s&&this.prepared.name&&s[this.prepared.name].inertia,l=this.inertiaStatus;if(this.interacting()){if(l.active&&!l.ending)return;var c,d,h,p=(new Date).getTime(),u=!1,g=Pe(r,this.prepared.name)&&s[this.prepared.name].snap.endOnly,f=Ae(r,this.prepared.name)&&s[this.prepared.name].restrict.endOnly,m=0,_=0;if(c=this.dragging?"x"===s.drag.axis?Math.abs(this.pointerDelta.client.vx):"y"===s.drag.axis?Math.abs(this.pointerDelta.client.vy):this.pointerDelta.client.speed:this.pointerDelta.client.speed,h=(d=a&&a.enabled&&"gesture"!==this.prepared.name&&t!==l.startEvent)&&p-this.curCoords.timeStamp<50&&c>a.minSpeed&&c>a.endSpeed,d&&!h&&(g||f)){var v={};v.snap=v.restrict=v,g&&(this.setSnapping(this.curCoords.page,v),v.locked&&(m+=v.dx,_+=v.dy)),f&&(this.setRestriction(this.curCoords.page,v),v.restricted&&(m+=v.dx,_+=v.dy)),(m||_)&&(u=!0)}if(h||u){if(re(l.upCoords,this.curCoords),this.pointers[0]=l.startEvent=new Ie(this,t,this.prepared.name,"inertiastart",this.element),l.t0=p,r.fire(l.startEvent),h){l.vx0=this.pointerDelta.client.vx,l.vy0=this.pointerDelta.client.vy,l.v0=c,this.calcInertia(l);var w,y=oe({},this.curCoords.page),b=be(r,this.element);if(y.x=y.x+l.xe-b.x,y.y=y.y+l.ye-b.y,(w={useStatusXY:!0,x:y.x,y:y.y,dx:0,dy:0,snap:null}).snap=w,m=_=0,g){var x=this.setSnapping(this.curCoords.page,w);x.locked&&(m+=x.dx,_+=x.dy)}if(f){var k=this.setRestriction(this.curCoords.page,w);k.restricted&&(m+=k.dx,_+=k.dy)}l.modifiedXe+=m,l.modifiedYe+=_,l.i=I(this.boundInertiaFrame)}else l.smoothEnd=!0,l.xe=m,l.ye=_,l.sx=l.sy=0,l.i=I(this.boundSmoothEndFrame);return void(l.active=!0)}(g||f)&&this.pointerMove(e,t,i,o,!0)}if(this.dragging){n=new Ie(this,t,"drag","end",this.element);var C=this.element,S=this.getDrop(n,t,C);this.dropTarget=S.dropzone,this.dropElement=S.element;var T=this.getDropEvents(t,n);T.leave&&this.prevDropTarget.fire(T.leave),T.enter&&this.dropTarget.fire(T.enter),T.drop&&this.dropTarget.fire(T.drop),T.deactivate&&this.fireActiveDrops(T.deactivate),r.fire(n)}else this.resizing?(n=new Ie(this,t,"resize","end",this.element),r.fire(n)):this.gesturing&&(n=new Ie(this,t,"gesture","end",this.element),r.fire(n));this.stop(t)},collectDrops:function(e){var t,i=[],o=[];for(e=e||this.element,t=0;t<_.length;t++)if(_[t].options.drop.enabled){var n=_[t],r=n.options.drop.accept;if(!(Y(r)&&r!==e||te(r)&&!Qe(e,r)))for(var s=n.selector?n._context.querySelectorAll(n.selector):[n._element],a=0,l=s.length;a<l;a++){var c=s[a];c!==e&&(i.push(n),o.push(c))}}return{dropzones:i,elements:o}},fireActiveDrops:function(e){var t,i,o,n;for(t=0;t<this.activeDrops.dropzones.length;t++)i=this.activeDrops.dropzones[t],(o=this.activeDrops.elements[t])!==n&&(e.target=o,i.fire(e)),n=o},setActiveDrops:function(e){var t=this.collectDrops(e,!0);this.activeDrops.dropzones=t.dropzones,this.activeDrops.elements=t.elements,this.activeDrops.rects=[];for(var i=0;i<this.activeDrops.dropzones.length;i++)this.activeDrops.rects[i]=this.activeDrops.dropzones[i].getRect(this.activeDrops.elements[i])},getDrop:function(e,t,i){var o=[];w&&this.setActiveDrops(i);for(var n=0;n<this.activeDrops.dropzones.length;n++){var r=this.activeDrops.dropzones[n],s=this.activeDrops.elements[n],a=this.activeDrops.rects[n];o.push(r.dropCheck(e,t,this.target,i,s,a)?s:null)}var l=function(e){var t,i,o,n,r,s=e[0],a=s?0:-1,l=[],h=[];for(n=1;n<e.length;n++)if((t=e[n])&&t!==s)if(s){if(t.parentNode!==t.ownerDocument)if(s.parentNode!==t.ownerDocument){if(!l.length)for(i=s;i.parentNode&&i.parentNode!==i.ownerDocument;)l.unshift(i),i=i.parentNode;if(s instanceof p&&t instanceof c&&!(t instanceof d)){if(t===s.parentNode)continue;i=t.ownerSVGElement}else i=t;for(h=[];i.parentNode!==i.ownerDocument;)h.unshift(i),i=i.parentNode;for(r=0;h[r]&&h[r]===l[r];)r++;var u=[h[r-1],h[r],l[r]];for(o=u[0].lastChild;o;){if(o===u[1]){s=t,a=n,l=[];break}if(o===u[2])break;o=o.previousSibling}}else s=t,a=n}else s=t,a=n;return a}(o);return{dropzone:this.activeDrops.dropzones[l]||null,element:this.activeDrops.elements[l]||null}},getDropEvents:function(e,t){var i={enter:null,leave:null,activate:null,deactivate:null,move:null,drop:null};return this.dropElement!==this.prevDropElement&&(this.prevDropTarget&&(i.leave={target:this.prevDropElement,dropzone:this.prevDropTarget,relatedTarget:t.target,draggable:t.interactable,dragEvent:t,interaction:this,timeStamp:t.timeStamp,type:"dragleave"},t.dragLeave=this.prevDropElement,t.prevDropzone=this.prevDropTarget),this.dropTarget&&(i.enter={target:this.dropElement,dropzone:this.dropTarget,relatedTarget:t.target,draggable:t.interactable,dragEvent:t,interaction:this,timeStamp:t.timeStamp,type:"dragenter"},t.dragEnter=this.dropElement,t.dropzone=this.dropTarget)),"dragend"===t.type&&this.dropTarget&&(i.drop={target:this.dropElement,dropzone:this.dropTarget,relatedTarget:t.target,draggable:t.interactable,dragEvent:t,interaction:this,timeStamp:t.timeStamp,type:"drop"},t.dropzone=this.dropTarget),"dragstart"===t.type&&(i.activate={target:null,dropzone:null,relatedTarget:t.target,draggable:t.interactable,dragEvent:t,interaction:this,timeStamp:t.timeStamp,type:"dropactivate"}),"dragend"===t.type&&(i.deactivate={target:null,dropzone:null,relatedTarget:t.target,draggable:t.interactable,dragEvent:t,interaction:this,timeStamp:t.timeStamp,type:"dropdeactivate"}),"dragmove"===t.type&&this.dropTarget&&(i.move={target:this.dropElement,dropzone:this.dropTarget,relatedTarget:t.target,draggable:t.interactable,dragEvent:t,interaction:this,dragmove:t,timeStamp:t.timeStamp,type:"dropmove"},t.dropzone=this.dropTarget),i},currentAction:function(){return(this.dragging?"drag":this.resizing&&"resize")||this.gesturing&&"gesture"||null},interacting:function(){return this.dragging||this.resizing||this.gesturing},clearTargets:function(){this.target=this.element=null,this.dropTarget=this.dropElement=this.prevDropTarget=this.prevDropElement=null},stop:function(e){if(this.interacting()){x.stop(),this.matches=[],this.matchElements=[];var t=this.target;t.options.styleCursor&&(t._doc.documentElement.style.cursor=""),e&&Q(e.preventDefault)&&this.checkAndPreventDefault(e,t,this.element),this.dragging&&(this.activeDrops.dropzones=this.activeDrops.elements=this.activeDrops.rects=null)}this.clearTargets(),this.pointerIsDown=this.snapStatus.locked=this.dragging=this.resizing=this.gesturing=!1,this.prepared.name=this.prevEvent=null,this.inertiaStatus.resumeDx=this.inertiaStatus.resumeDy=0;for(var i=0;i<this.pointers.length;i++)-1===Ge(this.pointerIds,he(this.pointers[i]))&&this.pointers.splice(i,1)},inertiaFrame:function(){var e,t,i,o,n,r,s,a=this.inertiaStatus,l=this.target.options[this.prepared.name].inertia.resistance,c=(new Date).getTime()/1e3-a.t0;if(c<a.te){var d=1-(Math.exp(-l*c)-a.lambda_v0)/a.one_ve_v0;if(a.modifiedXe===a.xe&&a.modifiedYe===a.ye)a.sx=a.xe*d,a.sy=a.ye*d;else{var h=(e=0,t=0,i=a.xe,o=a.ye,n=a.modifiedXe,r=a.modifiedYe,{x:xe(s=d,e,i,n),y:xe(s,t,o,r)});a.sx=h.x,a.sy=h.y}this.pointerMove(a.startEvent,a.startEvent),a.i=I(this.boundInertiaFrame)}else a.ending=!0,a.sx=a.modifiedXe,a.sy=a.modifiedYe,this.pointerMove(a.startEvent,a.startEvent),this.pointerEnd(a.startEvent,a.startEvent),a.active=a.ending=!1},smoothEndFrame:function(){var e=this.inertiaStatus,t=(new Date).getTime()-e.t0,i=this.target.options[this.prepared.name].inertia.smoothEndDuration;t<i?(e.sx=ke(t,0,e.xe,i),e.sy=ke(t,0,e.ye,i),this.pointerMove(e.startEvent,e.startEvent),e.i=I(this.boundSmoothEndFrame)):(e.ending=!0,e.sx=e.xe,e.sy=e.ye,this.pointerMove(e.startEvent,e.startEvent),this.pointerEnd(e.startEvent,e.startEvent),e.smoothEnd=e.active=e.ending=!1)},addPointer:function(e){var t=he(e),i=this.mouse?0:Ge(this.pointerIds,t);return-1===i&&(i=this.pointerIds.length),this.pointerIds[i]=t,this.pointers[i]=e,i},removePointer:function(e){var t=he(e),i=this.mouse?0:Ge(this.pointerIds,t);-1!==i&&(this.pointers.splice(i,1),this.pointerIds.splice(i,1),this.downTargets.splice(i,1),this.downTimes.splice(i,1),this.holdTimers.splice(i,1))},recordPointer:function(e){var t=this.mouse?0:Ge(this.pointerIds,he(e));-1!==t&&(this.pointers[t]=e)},collectEventTargets:function(e,t,i,o){var r=this.mouse?0:Ge(this.pointerIds,he(e));if("tap"!==o||!this.pointerWasMoved&&this.downTargets[r]&&this.downTargets[r]===i){for(var s=[],a=[],l=i;l;)je.isSet(l)&&je(l)._iEvents[o]&&(s.push(je(l)),a.push(l)),_.forEachSelector(c),l=Te(l);(s.length||"tap"===o)&&this.firePointers(e,t,i,s,a,o)}function c(e,t,r){var c=n?r.querySelectorAll(t):void 0;e._iEvents[o]&&Y(l)&&Ve(e,l)&&!Be(e,l,i)&&Ee(e,l,i)&&Qe(l,t,c)&&(s.push(e),a.push(l))}},firePointers:function(e,t,i,o,n,r){var s,a,l,c=this.mouse?0:Ge(this.pointerIds,he(e)),d={};for("doubletap"===r?d=e:(ne(d,t),t!==e&&ne(d,e),d.preventDefault=ze,d.stopPropagation=Ie.prototype.stopPropagation,d.stopImmediatePropagation=Ie.prototype.stopImmediatePropagation,d.interaction=this,d.timeStamp=(new Date).getTime(),d.originalEvent=t,d.originalPointer=e,d.type=r,d.pointerId=he(e),d.pointerType=this.mouse?"mouse":C?te(e.pointerType)?e.pointerType:[,,"touch","pen","mouse"][e.pointerType]:"touch"),"tap"===r&&(d.dt=d.timeStamp-this.downTimes[c],a=d.timeStamp-this.tapTime,l=!!(this.prevTap&&"doubletap"!==this.prevTap.type&&this.prevTap.target===d.target&&a<500),d.double=l,this.tapTime=d.timeStamp),s=0;s<o.length&&(d.currentTarget=n[s],d.interactable=o[s],o[s].fire(d),!(d.immediatePropagationStopped||d.propagationStopped&&n[s+1]!==d.currentTarget));s++);if(l){var h={};oe(h,d),h.dt=a,h.type="doubletap",this.collectEventTargets(h,t,i,"doubletap"),this.prevTap=h}else"tap"===r&&(this.prevTap=d)},validateSelector:function(e,t,i,o){for(var n=0,r=i.length;n<r;n++){var s=i[n],a=o[n],l=We(s.getAction(e,t,this,a),s);if(l&&De(s,a,l))return this.target=s,this.element=a,l}},setSnapping:function(e,t){var i,o,n,r=this.target.options[this.prepared.name].snap,s=[];if((t=t||this.snapStatus).useStatusXY)o={x:t.x,y:t.y};else{var a=be(this.target,this.element);(o=oe({},e)).x-=a.x,o.y-=a.y}t.realX=o.x,t.realY=o.y,o.x=o.x-this.inertiaStatus.resumeDx,o.y=o.y-this.inertiaStatus.resumeDy;for(var l=r.targets?r.targets.length:0,c=0;c<this.snapOffsets.length;c++){var d={x:o.x-this.snapOffsets[c].x,y:o.y-this.snapOffsets[c].y};for(n=0;n<l;n++)(i=Q(r.targets[n])?r.targets[n](d.x,d.y,this):r.targets[n])&&s.push({x:Z(i.x)?i.x+this.snapOffsets[c].x:d.x,y:Z(i.y)?i.y+this.snapOffsets[c].y:d.y,range:Z(i.range)?i.range:r.range})}var h,p={target:null,inRange:!1,distance:0,range:0,dx:0,dy:0};for(n=0,l=s.length;n<l;n++){var u=(i=s[n]).range,f=i.x-o.x,m=i.y-o.y,_=g(f,m),v=_<=u;u===1/0&&p.inRange&&p.range!==1/0&&(v=!1),p.target&&!(v?p.inRange&&u!==1/0?_/u<p.distance/p.range:u===1/0&&p.range!==1/0||_<p.distance:!p.inRange&&_<p.distance)||(u===1/0&&(v=!0),p.target=i,p.distance=_,p.range=u,p.inRange=v,p.dx=f,p.dy=m,t.range=u)}return p.target?(h=t.snappedX!==p.target.x||t.snappedY!==p.target.y,t.snappedX=p.target.x,t.snappedY=p.target.y):(h=!0,t.snappedX=NaN,t.snappedY=NaN),t.dx=p.dx,t.dy=p.dy,t.changed=h||p.inRange&&!t.locked,t.locked=p.inRange,t},setRestriction:function(e,t){var i,o,n,r,s=this.target,a=s&&s.options[this.prepared.name].restrict,l=a&&a.restriction;return l?(i=i=(t=t||this.restrictStatus).useStatusXY?{x:t.x,y:t.y}:oe({},e),t.snap&&t.snap.locked&&(i.x+=t.snap.dx||0,i.y+=t.snap.dy||0),i.x-=this.inertiaStatus.resumeDx,i.y-=this.inertiaStatus.resumeDy,t.dx=0,t.dy=0,t.restricted=!1,te(l)&&!(l="parent"===l?Te(this.element):"self"===l?s.getRect(this.element):Se(this.element,l))?t:(Q(l)&&(l=l(i.x,i.y,this.element)),Y(l)&&(l=fe(l)),o=l,l?"x"in l&&"y"in l?(n=Math.max(Math.min(o.x+o.width-this.restrictOffset.right,i.x),o.x+this.restrictOffset.left),r=Math.max(Math.min(o.y+o.height-this.restrictOffset.bottom,i.y),o.y+this.restrictOffset.top)):(n=Math.max(Math.min(o.right-this.restrictOffset.right,i.x),o.left+this.restrictOffset.left),r=Math.max(Math.min(o.bottom-this.restrictOffset.bottom,i.y),o.top+this.restrictOffset.top)):(n=i.x,r=i.y),t.dx=n-i.x,t.dy=r-i.y,t.changed=t.restrictedX!==n||t.restrictedY!==r,t.restricted=!(!t.dx&&!t.dy),t.restrictedX=n,t.restrictedY=r,t)):t},checkAndPreventDefault:function(e,t,i){if(t=t||this.target){var o=t.options,n=o.preventDefault;if("auto"!==n||!i||/^(input|select|textarea)$/i.test(e.target.nodeName))"always"!==n||e.preventDefault();else{if(/down|start/i.test(e.type)&&"drag"===this.prepared.name&&"xy"!==o.drag.axis)return;if(o[this.prepared.name]&&o[this.prepared.name].manualStart&&!this.interacting())return;e.preventDefault()}}},calcInertia:function(e){var t=this.target.options[this.prepared.name].inertia,i=t.resistance,o=-Math.log(t.endSpeed/e.v0)/i;e.x0=this.prevEvent.pageX,e.y0=this.prevEvent.pageY,e.t0=e.startEvent.timeStamp/1e3,e.sx=e.sy=0,e.modifiedXe=e.xe=(e.vx0-o)/i,e.modifiedYe=e.ye=(e.vy0-o)/i,e.te=o,e.lambda_v0=i/e.v0,e.one_ve_v0=1-t.endSpeed/e.v0},autoScrollMove:function(e){if(this.interacting()&&function(e,t){var i=e.options;return/^resize/.test(t)&&(t="resize"),i[t].autoScroll&&i[t].autoScroll.enabled}(this.target,this.prepared.name))if(this.inertiaStatus.active)x.x=x.y=0;else{var t,i,o,n,r=this.target.options[this.prepared.name].autoScroll,s=r.container||ue(this.element);if(X(s))n=e.clientX<x.margin,t=e.clientY<x.margin,i=e.clientX>s.innerWidth-x.margin,o=e.clientY>s.innerHeight-x.margin;else{var a=ge(s);n=e.clientX<a.left+x.margin,t=e.clientY<a.top+x.margin,i=e.clientX>a.right-x.margin,o=e.clientY>a.bottom-x.margin}x.x=i?1:n?-1:0,x.y=o?1:t?-1:0,x.isScrolling||(x.margin=r.margin,x.speed=r.speed,x.start(this))}},_updateEventTargets:function(e,t){this._eventTarget=e,this._curEventTarget=t}},Ie.prototype={preventDefault:q,stopImmediatePropagation:function(){this.immediatePropagationStopped=this.propagationStopped=!0},stopPropagation:function(){this.propagationStopped=!0}};for(var $={},W=["dragStart","dragMove","resizeStart","resizeMove","gestureStart","gestureMove","pointerOver","pointerOut","pointerHover","selectorDown","pointerDown","pointerMove","pointerUp","pointerCancel","pointerEnd","addPointer","removePointer","recordPointer","autoScrollMove"],H=0,U=W.length;H<U;H++){var j=W[H];$[j]=Fe(j)}_.indexOfElement=function(e,t){t=t||a;for(var i=0;i<this.length;i++){var o=this[i];if(o.selector===e&&o._context===t||!o.selector&&o._element===e)return i}return-1},_.get=function(e,t){return this[this.indexOfElement(e,t&&t.context)]},_.forEachSelector=function(e){for(var t=0;t<this.length;t++){var i=this[t];if(i.selector){var o=e(i,i.selector,i._context,t,this);if(void 0!==o)return o}}},qe.prototype={setOnEvents:function(e,t){return"drop"===e?(Q(t.ondrop)&&(this.ondrop=t.ondrop),Q(t.ondropactivate)&&(this.ondropactivate=t.ondropactivate),Q(t.ondropdeactivate)&&(this.ondropdeactivate=t.ondropdeactivate),Q(t.ondragenter)&&(this.ondragenter=t.ondragenter),Q(t.ondragleave)&&(this.ondragleave=t.ondragleave),Q(t.ondropmove)&&(this.ondropmove=t.ondropmove)):(e="on"+e,Q(t.onstart)&&(this[e+"start"]=t.onstart),Q(t.onmove)&&(this[e+"move"]=t.onmove),Q(t.onend)&&(this[e+"end"]=t.onend),Q(t.oninertiastart)&&(this[e+"inertiastart"]=t.oninertiastart)),this},draggable:function(e){return K(e)?(this.options.drag.enabled=!1!==e.enabled,this.setPerAction("drag",e),this.setOnEvents("drag",e),/^x$|^y$|^xy$/.test(e.axis)?this.options.drag.axis=e.axis:null===e.axis&&delete this.options.drag.axis,this):ee(e)?(this.options.drag.enabled=e,this):this.options.drag},setPerAction:function(e,t){for(var i in t)i in b[e]&&(K(t[i])?(this.options[e][i]=oe(this.options[e][i]||{},t[i]),K(b.perAction[i])&&"enabled"in b.perAction[i]&&(this.options[e][i].enabled=!1!==t[i].enabled)):ee(t[i])&&K(b.perAction[i])?this.options[e][i].enabled=t[i]:void 0!==t[i]&&(this.options[e][i]=t[i]))},dropzone:function(e){return K(e)?(this.options.drop.enabled=!1!==e.enabled,this.setOnEvents("drop",e),/^(pointer|center)$/.test(e.overlap)?this.options.drop.overlap=e.overlap:Z(e.overlap)&&(this.options.drop.overlap=Math.max(Math.min(1,e.overlap),0)),"accept"in e&&(this.options.drop.accept=e.accept),"checker"in e&&(this.options.drop.checker=e.checker),this):ee(e)?(this.options.drop.enabled=e,this):this.options.drop},dropCheck:function(e,t,i,o,n,r){var s=!1;if(!(r=r||this.getRect(n)))return!!this.options.drop.checker&&this.options.drop.checker(e,t,s,this,n,i,o);var a=this.options.drop.overlap;if("pointer"===a){var l,c,d=ce(e),h=be(i,o);d.x+=h.x,d.y+=h.y,l=d.x>r.left&&d.x<r.right,c=d.y>r.top&&d.y<r.bottom,s=l&&c}var p=i.getRect(o);if("center"===a){var u=p.left+p.width/2,g=p.top+p.height/2;s=u>=r.left&&u<=r.right&&g>=r.top&&g<=r.bottom}Z(a)&&(s=Math.max(0,Math.min(r.right,p.right)-Math.max(r.left,p.left))*Math.max(0,Math.min(r.bottom,p.bottom)-Math.max(r.top,p.top))/(p.width*p.height)>=a);return this.options.drop.checker&&(s=this.options.drop.checker(e,t,s,this,n,i,o)),s},dropChecker:function(e){return Q(e)?(this.options.drop.checker=e,this):null===e?(delete this.options.getRect,this):this.options.drop.checker},accept:function(e){return Y(e)?(this.options.drop.accept=e,this):ie(e)?(this.options.drop.accept=e,this):null===e?(delete this.options.drop.accept,this):this.options.drop.accept},resizable:function(e){return K(e)?(this.options.resize.enabled=!1!==e.enabled,this.setPerAction("resize",e),this.setOnEvents("resize",e),/^x$|^y$|^xy$/.test(e.axis)?this.options.resize.axis=e.axis:null===e.axis&&(this.options.resize.axis=b.resize.axis),ee(e.preserveAspectRatio)?this.options.resize.preserveAspectRatio=e.preserveAspectRatio:ee(e.square)&&(this.options.resize.square=e.square),this):ee(e)?(this.options.resize.enabled=e,this):this.options.resize},squareResize:function(e){return ee(e)?(this.options.resize.square=e,this):null===e?(delete this.options.resize.square,this):this.options.resize.square},gesturable:function(e){return K(e)?(this.options.gesture.enabled=!1!==e.enabled,this.setPerAction("gesture",e),this.setOnEvents("gesture",e),this):ee(e)?(this.options.gesture.enabled=e,this):this.options.gesture},autoScroll:function(e){return K(e)?e=oe({actions:["drag","resize"]},e):ee(e)&&(e={actions:["drag","resize"],enabled:e}),this.setOptions("autoScroll",e)},snap:function(e){var t=this.setOptions("snap",e);return t===this?this:t.drag},setOptions:function(e,t){var i,o=t&&G(t.actions)?t.actions:["drag"];if(K(t)||ee(t)){for(i=0;i<o.length;i++){var n=/resize/.test(o[i])?"resize":o[i];if(K(this.options[n])){var r=this.options[n][e];K(t)?(oe(r,t),r.enabled=!1!==t.enabled,"snap"===e&&("grid"===r.mode?r.targets=[je.createSnapGrid(oe({offset:r.gridOffset||{x:0,y:0}},r.grid||{}))]:"anchor"===r.mode?r.targets=r.anchors:"path"===r.mode&&(r.targets=r.paths),"elementOrigin"in t&&(r.relativePoints=[t.elementOrigin]))):ee(t)&&(r.enabled=t)}}return this}var s={},a=["drag","resize","gesture"];for(i=0;i<a.length;i++)e in b[a[i]]&&(s[a[i]]=this.options[a[i]][e]);return s},inertia:function(e){var t=this.setOptions("inertia",e);return t===this?this:t.drag},getAction:function(e,t,i,o){var n=this.defaultActionChecker(e,i,o);return this.options.actionChecker?this.options.actionChecker(e,t,n,this,o,i):n},defaultActionChecker:$e,actionChecker:function(e){return Q(e)?(this.options.actionChecker=e,this):null===e?(delete this.options.actionChecker,this):this.options.actionChecker},getRect:function(e){return e=e||this._element,this.selector&&!Y(e)&&(e=this._context.querySelector(this.selector)),fe(e)},rectChecker:function(e){return Q(e)?(this.getRect=e,this):null===e?(delete this.options.getRect,this):this.getRect},styleCursor:function(e){return ee(e)?(this.options.styleCursor=e,this):null===e?(delete this.options.styleCursor,this):this.options.styleCursor},preventDefault:function(e){return/^(always|never|auto)$/.test(e)?(this.options.preventDefault=e,this):ee(e)?(this.options.preventDefault=e?"always":"never",this):this.options.preventDefault},origin:function(e){return ie(e)?(this.options.origin=e,this):K(e)?(this.options.origin=e,this):this.options.origin},deltaSource:function(e){return"page"===e||"client"===e?(this.options.deltaSource=e,this):this.options.deltaSource},restrict:function(e){if(!K(e))return this.setOptions("restrict",e);for(var t,i=["drag","resize","gesture"],o=0;o<i.length;o++){var n=i[o];if(n in e){var r=oe({actions:[n],restriction:e[n]},e);t=this.setOptions("restrict",r)}}return t},context:function(){return this._context},_context:a,ignoreFrom:function(e){return ie(e)?(this.options.ignoreFrom=e,this):Y(e)?(this.options.ignoreFrom=e,this):this.options.ignoreFrom},allowFrom:function(e){return ie(e)?(this.options.allowFrom=e,this):Y(e)?(this.options.allowFrom=e,this):this.options.allowFrom},element:function(){return this._element},fire:function(e){if(!e||!e.type||!Ke(A,e.type))return this;var t,i,o,n="on"+e.type;if(e.type in this._iEvents)for(i=0,o=(t=this._iEvents[e.type]).length;i<o&&!e.immediatePropagationStopped;i++)t[i].name,t[i](e);if(Q(this[n])&&(this[n].name,this[n](e)),e.type in D&&(t=D[e.type]))for(i=0,o=t.length;i<o&&!e.immediatePropagationStopped;i++)t[i].name,t[i](e);return this},on:function(e,t,i){var o;if(te(e)&&-1!==e.search(" ")&&(e=e.trim().split(/ +/)),G(e)){for(o=0;o<e.length;o++)this.on(e[o],t,i);return this}if(K(e)){for(var n in e)this.on(n,e[n],t);return this}if("wheel"===e&&(e=P),i=!!i,Ke(A,e))e in this._iEvents?this._iEvents[e].push(t):this._iEvents[e]=[t];else if(this.selector){if(!y[e])for(y[e]={selectors:[],contexts:[],listeners:[]},o=0;o<m.length;o++)N.add(m[o],e,He),N.add(m[o],e,Ue,!0);var r,s=y[e];for(r=s.selectors.length-1;r>=0&&(s.selectors[r]!==this.selector||s.contexts[r]!==this._context);r--);-1===r&&(r=s.selectors.length,s.selectors.push(this.selector),s.contexts.push(this._context),s.listeners.push([])),s.listeners[r].push([t,i])}else N.add(this._element,e,t,i);return this},off:function(e,t,i){var o;if(te(e)&&-1!==e.search(" ")&&(e=e.trim().split(/ +/)),G(e)){for(o=0;o<e.length;o++)this.off(e[o],t,i);return this}if(K(e)){for(var n in e)this.off(n,e[n],t);return this}var r,s=-1;if(i=!!i,"wheel"===e&&(e=P),Ke(A,e))(r=this._iEvents[e])&&-1!==(s=Ge(r,t))&&this._iEvents[e].splice(s,1);else if(this.selector){var a=y[e],l=!1;if(!a)return this;for(s=a.selectors.length-1;s>=0;s--)if(a.selectors[s]===this.selector&&a.contexts[s]===this._context){var c=a.listeners[s];for(o=c.length-1;o>=0;o--){var d=c[o][0],h=c[o][1];if(d===t&&h===i){c.splice(o,1),c.length||(a.selectors.splice(s,1),a.contexts.splice(s,1),a.listeners.splice(s,1),N.remove(this._context,e,He),N.remove(this._context,e,Ue,!0),a.selectors.length||(y[e]=null)),l=!0;break}}if(l)break}}else N.remove(this._element,e,t,i);return this},set:function(e){K(e)||(e={}),this.options=oe({},b.base);var t,i=["drag","drop","resize","gesture"],o=["draggable","dropzone","resizable","gesturable"],n=oe(oe({},b.perAction),e[r]||{});for(t=0;t<i.length;t++){var r=i[t];this.options[r]=oe({},b[r]),this.setPerAction(r,n),this[o[t]](e[r])}var s=["accept","actionChecker","allowFrom","deltaSource","dropChecker","ignoreFrom","origin","preventDefault","rectChecker","styleCursor"];for(t=0,U=s.length;t<U;t++){var a=s[t];this.options[a]=b.base[a],a in e&&this[a](e[a])}return this},unset:function(){if(N.remove(this._element,"all"),te(this.selector))for(var e in y)for(var t=y[e],i=0;i<t.selectors.length;i++){t.selectors[i]===this.selector&&t.contexts[i]===this._context&&(t.selectors.splice(i,1),t.contexts.splice(i,1),t.listeners.splice(i,1),t.selectors.length||(y[e]=null)),N.remove(this._context,e,He),N.remove(this._context,e,Ue,!0);break}else N.remove(this,"all"),this.options.styleCursor&&(this._element.style.cursor="");return this.dropzone(!1),_.splice(Ge(_,this),1),je}},qe.prototype.snap=Ye(qe.prototype.snap,"Interactable#snap is deprecated. See the new documentation for snapping at http://interactjs.io/docs/snapping"),qe.prototype.restrict=Ye(qe.prototype.restrict,"Interactable#restrict is deprecated. See the new documentation for resticting at http://interactjs.io/docs/restriction"),qe.prototype.inertia=Ye(qe.prototype.inertia,"Interactable#inertia is deprecated. See the new documentation for inertia at http://interactjs.io/docs/inertia"),qe.prototype.autoScroll=Ye(qe.prototype.autoScroll,"Interactable#autoScroll is deprecated. See the new documentation for autoScroll at http://interactjs.io/docs/#autoscroll"),qe.prototype.squareResize=Ye(qe.prototype.squareResize,"Interactable#squareResize is deprecated. See http://interactjs.io/docs/#resize-square"),qe.prototype.accept=Ye(qe.prototype.accept,"Interactable#accept is deprecated. use Interactable#dropzone({ accept: target }) instead"),qe.prototype.dropChecker=Ye(qe.prototype.dropChecker,"Interactable#dropChecker is deprecated. use Interactable#dropzone({ dropChecker: checkerFunction }) instead"),qe.prototype.context=Ye(qe.prototype.context,"Interactable#context as a method is deprecated. It will soon be a DOM Node instead"),je.isSet=function(e,t){return-1!==_.indexOfElement(e,t&&t.context)},je.on=function(e,t,i){if(te(e)&&-1!==e.search(" ")&&(e=e.trim().split(/ +/)),G(e)){for(var o=0;o<e.length;o++)je.on(e[o],t,i);return je}if(K(e)){for(var n in e)je.on(n,e[n],t);return je}return Ke(A,e)?D[e]?D[e].push(t):D[e]=[t]:N.add(a,e,t,i),je},je.off=function(e,t,i){if(te(e)&&-1!==e.search(" ")&&(e=e.trim().split(/ +/)),G(e)){for(var o=0;o<e.length;o++)je.off(e[o],t,i);return je}if(K(e)){for(var n in e)je.off(n,e[n],t);return je}var r;Ke(A,e)?e in D&&-1!==(r=Ge(D[e],t))&&D[e].splice(r,1):N.remove(a,e,t,i);return je},je.enableDragging=Ye(function(e){return null!=e?(M.drag=e,je):M.drag},"interact.enableDragging is deprecated and will soon be removed."),je.enableResizing=Ye(function(e){return null!=e?(M.resize=e,je):M.resize},"interact.enableResizing is deprecated and will soon be removed."),je.enableGesturing=Ye(function(e){return null!=e?(M.gesture=e,je):M.gesture},"interact.enableGesturing is deprecated and will soon be removed."),je.eventTypes=A,je.debug=function(){var e=v[0]||new Re;return{interactions:v,target:e.target,dragging:e.dragging,resizing:e.resizing,gesturing:e.gesturing,prepared:e.prepared,matches:e.matches,matchElements:e.matchElements,prevCoords:e.prevCoords,startCoords:e.startCoords,pointerIds:e.pointerIds,pointers:e.pointers,addPointer:$.addPointer,removePointer:$.removePointer,recordPointer:$.recordPointer,snap:e.snapStatus,restrict:e.restrictStatus,inertia:e.inertiaStatus,downTime:e.downTimes[0],downEvent:e.downEvent,downPointer:e.downPointer,prevEvent:e.prevEvent,Interactable:qe,interactables:_,pointerIsDown:e.pointerIsDown,defaultOptions:b,defaultActionChecker:$e,actionCursors:E,dragMove:$.dragMove,resizeMove:$.resizeMove,gestureMove:$.gestureMove,pointerUp:$.pointerUp,pointerDown:$.pointerDown,pointerMove:$.pointerMove,pointerHover:$.pointerHover,eventTypes:A,events:N,globalEvents:D,delegatedEvents:y,prefixedPropREs:L}},je.getPointerAverage=_e,je.getTouchBBox=ve,je.getTouchDistance=we,je.getTouchAngle=ye,je.getElementRect=fe,je.getElementClientRect=ge,je.matchesSelector=Qe,je.closest=Se,je.margin=Ye(function(e){return Z(e)?(S=e,je):S},"interact.margin is deprecated. Use interact(target).resizable({ margin: number }); instead."),je.supportsTouch=function(){return k},je.supportsPointerEvent=function(){return C},je.stop=function(e){for(var t=v.length-1;t>=0;t--)v[t].stop(e);return je},je.dynamicDrop=function(e){return ee(e)?(w=e,je):w},je.pointerMoveTolerance=function(e){return Z(e)?(T=e,this):T},je.maxInteractions=function(e){return Z(e)?(B=e,this):B},je.createSnapGrid=function(e){return function(t,i){var o=0,n=0;K(e.offset)&&(o=e.offset.x,n=e.offset.y);var r=Math.round((t-o)/e.x),s=Math.round((i-n)/e.y);return{x:r*e.x+o,y:s*e.y+n,range:e.range}}},Je(a),F in Element.prototype&&Q(Element.prototype[F])||(n=function(e,t,i){for(var o=0,n=(i=i||e.parentNode.querySelectorAll(t)).length;o<n;o++)if(i[o]===e)return!0;return!1}),function(){for(var e=0,t=["ms","moz","webkit","o"],o=0;o<t.length&&!i.requestAnimationFrame;++o)I=i[t[o]+"RequestAnimationFrame"],z=i[t[o]+"CancelAnimationFrame"]||i[t[o]+"CancelRequestAnimationFrame"];I||(I=function(t){var i=(new Date).getTime(),o=Math.max(0,16-(i-e)),n=setTimeout(function(){t(i+o)},o);return e=i+o,n}),z||(z=function(e){clearTimeout(e)})}(),e.exports&&(t=e.exports=je),t.interact=je}function q(){}function Y(e){if(!e||"object"!=typeof e)return!1;var t=ue(e)||s;return/object|function/.test(typeof t.Element)?e instanceof t.Element:1===e.nodeType&&"string"==typeof e.nodeName}function X(e){return e===s||!(!e||!e.Window)&&e instanceof e.Window}function J(e){return!!e&&e instanceof l}function G(e){return K(e)&&void 0!==typeof e.length&&Q(e.splice)}function K(e){return!!e&&"object"==typeof e}function Q(e){return"function"==typeof e}function Z(e){return"number"==typeof e}function ee(e){return"boolean"==typeof e}function te(e){return"string"==typeof e}function ie(e){return!!te(e)&&(a.querySelector(e),!0)}function oe(e,t){for(var i in t)e[i]=t[i];return e}function ne(e,t){for(var i in t){var o=!1;for(var n in L)if(0===i.indexOf(n)&&L[n].test(i)){o=!0;break}o||(e[i]=t[i])}return e}function re(e,t){e.page=e.page||{},e.page.x=t.page.x,e.page.y=t.page.y,e.client=e.client||{},e.client.x=t.client.x,e.client.y=t.client.y,e.timeStamp=t.timeStamp}function se(e,t,i){e.page.x=i.page.x-t.page.x,e.page.y=i.page.y-t.page.y,e.client.x=i.client.x-t.client.x,e.client.y=i.client.y-t.client.y,e.timeStamp=(new Date).getTime()-t.timeStamp;var o=Math.max(e.timeStamp/1e3,.001);e.page.speed=g(e.page.x,e.page.y)/o,e.page.vx=e.page.x/o,e.page.vy=e.page.y/o,e.client.speed=g(e.client.x,e.page.y)/o,e.client.vx=e.client.x/o,e.client.vy=e.client.y/o}function ae(e){return e instanceof s.Event||k&&s.Touch&&e instanceof s.Touch}function le(e,t,i){return e=e||"page",(i=i||{}).x=t[e+"X"],i.y=t[e+"Y"],i}function ce(e,t){return t=t||{},R&&ae(e)?(le("screen",e,t),t.x+=s.scrollX,t.y+=s.scrollY):le("page",e,t),t}function de(e,t){return t=t||{},R&&ae(e)?le("screen",e,t):le("client",e,t),t}function he(e){return Z(e.pointerId)?e.pointerId:e.identifier}function pe(e){return e instanceof h?e.correspondingUseElement:e}function ue(e){if(X(e))return e;var t=e.ownerDocument||e;return t.defaultView||t.parentWindow||s}function ge(e){var t=e instanceof c?e.getBoundingClientRect():e.getClientRects()[0];return t&&{left:t.left,right:t.right,top:t.top,bottom:t.bottom,width:t.width||t.right-t.left,height:t.height||t.bottom-t.top}}function fe(e){var t,i=ge(e);if(!O&&i){var o={x:(t=(t=ue(e))||s).scrollX||t.document.documentElement.scrollLeft,y:t.scrollY||t.document.documentElement.scrollTop};i.left+=o.x,i.right+=o.x,i.top+=o.y,i.bottom+=o.y}return i}function me(e){var t=[];return G(e)?(t[0]=e[0],t[1]=e[1]):"touchend"===e.type?1===e.touches.length?(t[0]=e.touches[0],t[1]=e.changedTouches[0]):0===e.touches.length&&(t[0]=e.changedTouches[0],t[1]=e.changedTouches[1]):(t[0]=e.touches[0],t[1]=e.touches[1]),t}function _e(e){for(var t,i={pageX:0,pageY:0,clientX:0,clientY:0,screenX:0,screenY:0},o=0;o<e.length;o++)for(t in i)i[t]+=e[o][t];for(t in i)i[t]/=e.length;return i}function ve(e){if(e.length||e.touches&&e.touches.length>1){var t=me(e),i=Math.min(t[0].pageX,t[1].pageX),o=Math.min(t[0].pageY,t[1].pageY);return{x:i,y:o,left:i,top:o,width:Math.max(t[0].pageX,t[1].pageX)-i,height:Math.max(t[0].pageY,t[1].pageY)-o}}}function we(e,t){var i=(t=t||b.deltaSource)+"X",o=t+"Y",n=me(e),r=n[0][i]-n[1][i],s=n[0][o]-n[1][o];return g(r,s)}function ye(e,t,i){var o=(i=i||b.deltaSource)+"X",n=i+"Y",r=me(e),s=r[0][o]-r[1][o],a=r[0][n]-r[1][n],l=180*Math.atan(a/s)/Math.PI;if(Z(t)){var c=(l-t)%360;c>315?l-=360+l/360|0:c>135?l-=180+l/360|0:c<-315?l+=360+l/360|0:c<-135&&(l+=180+l/360|0)}return l}function be(e,t){var i=e?e.options.origin:b.origin;return"parent"===i?i=Te(t):"self"===i?i=e.getRect(t):ie(i)&&(i=Se(t,i)||{x:0,y:0}),Q(i)&&(i=i(e&&t)),Y(i)&&(i=fe(i)),i.x="x"in i?i.x:i.left,i.y="y"in i?i.y:i.top,i}function xe(e,t,i,o){var n=1-e;return n*n*t+2*n*e*i+e*e*o}function ke(e,t,i,o){return-i*(e/=o)*(e-2)+t}function Ce(e,t){for(;t;){if(t===e)return!0;t=t.parentNode}return!1}function Se(e,t){for(var i=Te(e);Y(i);){if(Qe(i,t))return i;i=Te(i)}return null}function Te(e){var t=e.parentNode;if(J(t)){for(;(t=t.host)&&J(t););return t}return t}function Ve(e,t){return e._context===t.ownerDocument||Ce(e._context,t)}function Be(e,t,i){var o=e.options.ignoreFrom;return!(!o||!Y(i))&&(te(o)?Ze(i,o,t):!!Y(o)&&Ce(o,i))}function Ee(e,t,i){var o=e.options.allowFrom;return!o||!!Y(i)&&(te(o)?Ze(i,o,t):!!Y(o)&&Ce(o,i))}function Me(e,t){if(!t)return!1;var i=t.options.drag.axis;return"xy"===e||"xy"===i||i===e}function Pe(e,t){var i=e.options;return/^resize/.test(t)&&(t="resize"),i[t].snap&&i[t].snap.enabled}function Ae(e,t){var i=e.options;return/^resize/.test(t)&&(t="resize"),i[t].restrict&&i[t].restrict.enabled}function De(e,t,i){for(var o=e.options,n=o[i.name].max,r=o[i.name].maxPerElement,s=0,a=0,l=0,c=0,d=v.length;c<d;c++){var h=v[c],p=h.prepared.name;if(h.interacting()){if(++s>=B)return!1;if(h.target===e){if((a+=p===i.name|0)>=n)return!1;if(h.element===t&&(l++,p!==i.name||l>=r))return!1}}}return B>0}function Re(){if(this.target=null,this.element=null,this.dropTarget=null,this.dropElement=null,this.prevDropTarget=null,this.prevDropElement=null,this.prepared={name:null,axis:null,edges:null},this.matches=[],this.matchElements=[],this.inertiaStatus={active:!1,smoothEnd:!1,ending:!1,startEvent:null,upCoords:{},xe:0,ye:0,sx:0,sy:0,t0:0,vx0:0,vys:0,duration:0,resumeDx:0,resumeDy:0,lambda_v0:0,one_ve_v0:0,i:null},Q(Function.prototype.bind))this.boundInertiaFrame=this.inertiaFrame.bind(this),this.boundSmoothEndFrame=this.smoothEndFrame.bind(this);else{var e=this;this.boundInertiaFrame=function(){return e.inertiaFrame()},this.boundSmoothEndFrame=function(){return e.smoothEndFrame()}}this.activeDrops={dropzones:[],elements:[],rects:[]},this.pointers=[],this.pointerIds=[],this.downTargets=[],this.downTimes=[],this.holdTimers=[],this.prevCoords={page:{x:0,y:0},client:{x:0,y:0},timeStamp:0},this.curCoords={page:{x:0,y:0},client:{x:0,y:0},timeStamp:0},this.startCoords={page:{x:0,y:0},client:{x:0,y:0},timeStamp:0},this.pointerDelta={page:{x:0,y:0,vx:0,vy:0,speed:0},client:{x:0,y:0,vx:0,vy:0,speed:0},timeStamp:0},this.downEvent=null,this.downPointer={},this._eventTarget=null,this._curEventTarget=null,this.prevEvent=null,this.tapTime=0,this.prevTap=null,this.startOffset={left:0,right:0,top:0,bottom:0},this.restrictOffset={left:0,right:0,top:0,bottom:0},this.snapOffsets=[],this.gesture={start:{x:0,y:0},startDistance:0,prevDistance:0,distance:0,scale:1,startAngle:0,prevAngle:0},this.snapStatus={x:0,y:0,dx:0,dy:0,realX:0,realY:0,snappedX:0,snappedY:0,targets:[],locked:!1,changed:!1},this.restrictStatus={dx:0,dy:0,restrictedX:0,restrictedY:0,snap:null,restricted:!1,changed:!1},this.restrictStatus.snap=this.snapStatus,this.pointerIsDown=!1,this.pointerWasMoved=!1,this.gesturing=!1,this.dragging=!1,this.resizing=!1,this.resizeAxes="xy",this.mouse=!1,v.push(this)}function Oe(e,t,i){var o,n=0,r=v.length,s=/mouse/i.test(e.pointerType||t)||4===e.pointerType,a=he(e);if(/down|start/i.test(t))for(n=0;n<r;n++){var l=i;if((o=v[n]).inertiaStatus.active&&o.target.options[o.prepared.name].inertia.allowResume&&o.mouse===s)for(;l;){if(l===o.element)return o;l=Te(l)}}if(s||!k&&!C){for(n=0;n<r;n++)if(v[n].mouse&&!v[n].inertiaStatus.active)return v[n];for(n=0;n<r;n++)if(v[n].mouse&&(!/down/.test(t)||!v[n].inertiaStatus.active))return o;return(o=new Re).mouse=!0,o}for(n=0;n<r;n++)if(Ke(v[n].pointerIds,a))return v[n];if(/up|end|out/i.test(t))return null;for(n=0;n<r;n++)if((!(o=v[n]).prepared.name||o.target.options.gesture.enabled)&&!o.interacting()&&(s||!o.mouse))return o;return new Re}function Fe(e){return function(t){var i,o,n=pe(t.path?t.path[0]:t.target),r=pe(t.currentTarget);if(k&&/touch/.test(t.type))for(V=(new Date).getTime(),o=0;o<t.changedTouches.length;o++){var s=t.changedTouches[o];(i=Oe(s,t.type,n))&&(i._updateEventTargets(n,r),i[e](s,t,n,r))}else{if(!C&&/mouse/.test(t.type)){for(o=0;o<v.length;o++)if(!v[o].mouse&&v[o].pointerIsDown)return;if((new Date).getTime()-V<500)return}if(!(i=Oe(t,t.type,n)))return;i._updateEventTargets(n,r),i[e](t,t,n,r)}}}function Ie(e,t,i,o,n,r){var s,a,l=e.target,c=e.snapStatus,d=e.restrictStatus,h=e.pointers,p=(l&&l.options||b).deltaSource,u=p+"X",f=p+"Y",m=l?l.options:b,_=be(l,n),v="start"===o,w="end"===o,y=v?e.startCoords:e.curCoords;n=n||e.element,a=oe({},y.page),s=oe({},y.client),a.x-=_.x,a.y-=_.y,s.x-=_.x,s.y-=_.y;var x=m[i].snap&&m[i].snap.relativePoints;!Pe(l,i)||v&&x&&x.length||(this.snap={range:c.range,locked:c.locked,x:c.snappedX,y:c.snappedY,realX:c.realX,realY:c.realY,dx:c.dx,dy:c.dy},c.locked&&(a.x+=c.dx,a.y+=c.dy,s.x+=c.dx,s.y+=c.dy)),!Ae(l,i)||v&&m[i].restrict.elementRect||!d.restricted||(a.x+=d.dx,a.y+=d.dy,s.x+=d.dx,s.y+=d.dy,this.restrict={dx:d.dx,dy:d.dy}),this.pageX=a.x,this.pageY=a.y,this.clientX=s.x,this.clientY=s.y,this.x0=e.startCoords.page.x-_.x,this.y0=e.startCoords.page.y-_.y,this.clientX0=e.startCoords.client.x-_.x,this.clientY0=e.startCoords.client.y-_.y,this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.button=t.button,this.buttons=t.buttons,this.target=n,this.t0=e.downTimes[0],this.type=i+(o||""),this.interaction=e,this.interactable=l;var k=e.inertiaStatus;if(k.active&&(this.detail="inertia"),r&&(this.relatedTarget=r),w?"client"===p?(this.dx=s.x-e.startCoords.client.x,this.dy=s.y-e.startCoords.client.y):(this.dx=a.x-e.startCoords.page.x,this.dy=a.y-e.startCoords.page.y):v?(this.dx=0,this.dy=0):"inertiastart"===o?(this.dx=e.prevEvent.dx,this.dy=e.prevEvent.dy):"client"===p?(this.dx=s.x-e.prevEvent.clientX,this.dy=s.y-e.prevEvent.clientY):(this.dx=a.x-e.prevEvent.pageX,this.dy=a.y-e.prevEvent.pageY),e.prevEvent&&"inertia"===e.prevEvent.detail&&!k.active&&m[i].inertia&&m[i].inertia.zeroResumeDelta&&(k.resumeDx+=this.dx,k.resumeDy+=this.dy,this.dx=this.dy=0),"resize"===i&&e.resizeAxes?m.resize.square?("y"===e.resizeAxes?this.dx=this.dy:this.dy=this.dx,this.axes="xy"):(this.axes=e.resizeAxes,"x"===e.resizeAxes?this.dy=0:"y"===e.resizeAxes&&(this.dx=0)):"gesture"===i&&(this.touches=[h[0],h[1]],v?(this.distance=we(h,p),this.box=ve(h),this.scale=1,this.ds=0,this.angle=ye(h,void 0,p),this.da=0):w||t instanceof Ie?(this.distance=e.prevEvent.distance,this.box=e.prevEvent.box,this.scale=e.prevEvent.scale,this.ds=this.scale-1,this.angle=e.prevEvent.angle,this.da=this.angle-e.gesture.startAngle):(this.distance=we(h,p),this.box=ve(h),this.scale=this.distance/e.gesture.startDistance,this.angle=ye(h,e.gesture.prevAngle,p),this.ds=this.scale-e.gesture.prevScale,this.da=this.angle-e.gesture.prevAngle)),v)this.timeStamp=e.downTimes[0],this.dt=0,this.duration=0,this.speed=0,this.velocityX=0,this.velocityY=0;else if("inertiastart"===o)this.timeStamp=e.prevEvent.timeStamp,this.dt=e.prevEvent.dt,this.duration=e.prevEvent.duration,this.speed=e.prevEvent.speed,this.velocityX=e.prevEvent.velocityX,this.velocityY=e.prevEvent.velocityY;else if(this.timeStamp=(new Date).getTime(),this.dt=this.timeStamp-e.prevEvent.timeStamp,this.duration=this.timeStamp-e.downTimes[0],t instanceof Ie){var C=this[u]-e.prevEvent[u],S=this[f]-e.prevEvent[f],T=this.dt/1e3;this.speed=g(C,S)/T,this.velocityX=C/T,this.velocityY=S/T}else this.speed=e.pointerDelta[p].speed,this.velocityX=e.pointerDelta[p].vx,this.velocityY=e.pointerDelta[p].vy;if((w||"inertiastart"===o)&&e.prevEvent.speed>600&&this.timeStamp-e.prevEvent.timeStamp<150){var V=180*Math.atan2(e.prevEvent.velocityY,e.prevEvent.velocityX)/Math.PI;V<0&&(V+=360);var B=112.5<=V&&V<247.5,E=202.5<=V&&V<337.5,M=!B&&(292.5<=V||V<67.5),P=!E&&22.5<=V&&V<157.5;this.swipe={up:E,down:P,left:B,right:M,angle:V,speed:e.prevEvent.speed,velocity:{x:e.prevEvent.velocityX,y:e.prevEvent.velocityY}}}}function ze(){this.originalEvent.preventDefault()}function Ne(e){var t="";if("drag"===e.name&&(t=E.drag),"resize"===e.name)if(e.axis)t=E[e.name+e.axis];else if(e.edges){for(var i="resize",o=["top","bottom","left","right"],n=0;n<4;n++)e.edges[o[n]]&&(i+=o[n]);t=E[i]}return t}function Le(e,t,i,o,n,r,s){if(!t)return!1;if(!0===t){var a=Z(r.width)?r.width:r.right-r.left,l=Z(r.height)?r.height:r.bottom-r.top;if(a<0&&("left"===e?e="right":"right"===e&&(e="left")),l<0&&("top"===e?e="bottom":"bottom"===e&&(e="top")),"left"===e)return i.x<(a>=0?r.left:r.right)+s;if("top"===e)return i.y<(l>=0?r.top:r.bottom)+s;if("right"===e)return i.x>(a>=0?r.right:r.left)-s;if("bottom"===e)return i.y>(l>=0?r.bottom:r.top)-s}return!!Y(o)&&(Y(t)?t===o:Ze(o,t,n))}function $e(e,t,i){var o,n=this.getRect(i),r=!1,s=null,a=null,l=oe({},t.curCoords.page),c=this.options;if(!n)return null;if(M.resize&&c.resize.enabled){var d=c.resize;if(o={left:!1,right:!1,top:!1,bottom:!1},K(d.edges)){for(var h in o)o[h]=Le(h,d.edges[h],l,t._eventTarget,i,n,d.margin||S);o.left=o.left&&!o.right,o.top=o.top&&!o.bottom,r=o.left||o.right||o.top||o.bottom}else{var p="y"!==c.resize.axis&&l.x>n.right-S,u="x"!==c.resize.axis&&l.y>n.bottom-S;r=p||u,a=(p?"x":"")+(u?"y":"")}}return s=r?"resize":M.drag&&c.drag.enabled?"drag":null,M.gesture&&t.pointerIds.length>=2&&!t.dragging&&!t.resizing&&(s="gesture"),s?{name:s,axis:a,edges:o}:null}function We(e,t){if(!K(e))return null;var i=e.name,o=t.options;return("resize"===i&&o.resize.enabled||"drag"===i&&o.drag.enabled||"gesture"===i&&o.gesture.enabled)&&M[i]?("resize"!==i&&"resizeyx"!==i||(i="resizexy"),e):null}function He(e,t){var i={},o=y[e.type],n=pe(e.path?e.path[0]:e.target),r=n;for(var s in t=!!t,e)i[s]=e[s];for(i.originalEvent=e,i.preventDefault=ze;Y(r);){for(var a=0;a<o.selectors.length;a++){var l=o.selectors[a],c=o.contexts[a];if(Qe(r,l)&&Ce(c,n)&&Ce(c,r)){var d=o.listeners[a];i.currentTarget=r;for(var h=0;h<d.length;h++)d[h][1]===t&&d[h][0](i)}}r=Te(r)}}function Ue(e){return He.call(this,e,!0)}function je(e,t){return _.get(e,t)||new qe(e,t)}function qe(e,t){var i;if(this._element=e,this._iEvents=this._iEvents||{},ie(e)){this.selector=e;var n=t&&t.context;i=n?ue(n):s,n&&(i.Node?n instanceof i.Node:Y(n)||n===i.document)&&(this._context=n)}else i=ue(e),Y(e)&&(C?(N.add(this._element,o.down,$.pointerDown),N.add(this._element,o.move,$.pointerHover)):(N.add(this._element,"mousedown",$.pointerDown),N.add(this._element,"mousemove",$.pointerHover),N.add(this._element,"touchstart",$.pointerDown),N.add(this._element,"touchmove",$.pointerHover)));this._doc=i.document,Ke(m,this._doc)||Je(this._doc),_.push(this),this.set(t)}function Ye(e,t){var i=!1;return function(){return i||(s.console.warn(t),i=!0),e.apply(this,arguments)}}function Xe(e){for(var t=0;t<v.length;t++)v[t].pointerEnd(e,e)}function Je(e){if(!Ke(m,e)){var t=e.defaultView||e.parentWindow;for(var i in y)N.add(e,i,He),N.add(e,i,Ue,!0);C?(o=u===t.MSPointerEvent?{up:"MSPointerUp",down:"MSPointerDown",over:"mouseover",out:"mouseout",move:"MSPointerMove",cancel:"MSPointerCancel"}:{up:"pointerup",down:"pointerdown",over:"pointerover",out:"pointerout",move:"pointermove",cancel:"pointercancel"},N.add(e,o.down,$.selectorDown),N.add(e,o.move,$.pointerMove),N.add(e,o.over,$.pointerOver),N.add(e,o.out,$.pointerOut),N.add(e,o.up,$.pointerUp),N.add(e,o.cancel,$.pointerCancel),N.add(e,o.move,$.autoScrollMove)):(N.add(e,"mousedown",$.selectorDown),N.add(e,"mousemove",$.pointerMove),N.add(e,"mouseup",$.pointerUp),N.add(e,"mouseover",$.pointerOver),N.add(e,"mouseout",$.pointerOut),N.add(e,"touchstart",$.selectorDown),N.add(e,"touchmove",$.pointerMove),N.add(e,"touchend",$.pointerUp),N.add(e,"touchcancel",$.pointerCancel),N.add(e,"mousemove",$.autoScrollMove),N.add(e,"touchmove",$.autoScrollMove)),N.add(t,"blur",Xe);try{if(t.frameElement){var n=t.frameElement.ownerDocument,r=n.defaultView;N.add(n,"mouseup",$.pointerEnd),N.add(n,"touchend",$.pointerEnd),N.add(n,"touchcancel",$.pointerEnd),N.add(n,"pointerup",$.pointerEnd),N.add(n,"MSPointerUp",$.pointerEnd),N.add(r,"blur",Xe)}}catch(e){je.windowParentError=e}N.add(e,"dragstart",function(e){for(var t=0;t<v.length;t++){var i=v[t];if(i.element&&(i.element===e.target||Ce(i.element,e.target)))return void i.checkAndPreventDefault(e,i.target,i.element)}}),N.useAttachEvent&&(N.add(e,"selectstart",function(e){var t=v[0];t.currentAction()&&t.checkAndPreventDefault(e)}),N.add(e,"dblclick",Fe("ie8Dblclick"))),m.push(e)}}function Ge(e,t){for(var i=0,o=e.length;i<o;i++)if(e[i]===t)return i;return-1}function Ke(e,t){return-1!==Ge(e,t)}function Qe(e,t,o){return n?n(e,t,o):(s!==i&&(t=t.replace(/\/deep\//g," ")),e[F](t))}function Ze(e,t,i){for(;Y(e);){if(Qe(e,t))return!0;if((e=Te(e))===i)return Qe(e,t)}return!1}}("undefined"==typeof window?void 0:window)},13:function(e,t,i){e.exports=function(e,t,i){"use strict";e="default"in e?e.default:e,t="default"in t?t.default:t,i="default"in i?i.default:i;var o=function(e){return function(t){for(var i=arguments.length,o=Array(i>1?i-1:0),n=1;n<i;n++)o[n-1]=arguments[n];return e.apply(t,o)}},n=e.Model.extend,r=function e(i,o){t.isObject(i)&&(i=i.prev+" is going to be removed in the future. Please use "+i.next+" instead."+(i.url?" See: "+i.url:"")),Se.DEV_MODE&&(void 0!==o&&o||e._cache[i]||(e._warn("Deprecation warning: "+i),e._cache[i]=!0))};r._console="undefined"!=typeof console?console:{},r._warn=function(){var e=r._console.warn||r._console.log||t.noop;return e.apply(r._console,arguments)},r._cache={};var s=function(e){return document.documentElement.contains(e&&e.parentNode)},a=function(e,i){var o=this;e&&t.each(i,function(t){var i=e[t];void 0!==i&&(o[t]=i)})},l=function(e){if(e)return this.options&&void 0!==this.options[e]?this.options[e]:this[e]},c=function(e){var i=this;return t.reduce(e,function(e,o,n){return t.isFunction(o)||(o=i[o]),o&&(e[n]=o),e},{})},d=/(^|:)(\w)/gi;function h(e,t,i){return i.toUpperCase()}var p=t.memoize(function(e){return"on"+e.replace(d,h)});function u(e){for(var i=arguments.length,o=Array(i>1?i-1:0),n=1;n<i;n++)o[n-1]=arguments[n];var r=p(e),s=l.call(this,r),a=void 0;return t.isFunction(s)&&(a=s.apply(this,o)),this.trigger.apply(this,arguments),a}function g(e){for(var i=arguments.length,o=Array(i>1?i-1:0),n=1;n<i;n++)o[n-1]=arguments[n];return t.isFunction(e.triggerMethod)?e.triggerMethod.apply(e,o):u.apply(e,o)}function f(e,i,o){e._getImmediateChildren&&t.each(e._getImmediateChildren(),function(e){o(e)&&g(e,i,e)})}function m(e){return!e._isAttached}function _(e){return!!m(e)&&(e._isAttached=!0,!0)}function v(e){return e._isAttached}function w(e){return!!v(e)&&(e._isAttached=!1,!0)}function y(e){e._isAttached&&e._isRendered&&g(e,"dom:refresh",e)}function b(){f(this,"before:attach",m)}function x(){f(this,"attach",_),y(this)}function k(){f(this,"before:detach",v)}function C(){f(this,"detach",w)}function S(){y(this)}function T(e){e._areViewEventsMonitored||(e._areViewEventsMonitored=!0,e.on({"before:attach":b,attach:x,"before:detach":k,detach:C,render:S}))}var V=["description","fileName","lineNumber","name","message","number"],B=n.call(Error,{urlRoot:"http://marionettejs.com/docs/v3.2.0/",constructor:function(e,i){t.isObject(e)?e=(i=e).message:i||(i={});var o=Error.call(this,e);t.extend(this,t.pick(o,V),t.pick(i,V)),this.captureStackTrace(),i.url&&(this.url=this.urlRoot+i.url)},captureStackTrace:function(){Error.captureStackTrace&&Error.captureStackTrace(this,B)},toString:function(){return this.name+": "+this.message+(this.url?" See: "+this.url:"")}});function E(e,i,o,n){if(i&&o){if(!t.isObject(o))throw new B({message:"Bindings must be an object.",url:"marionette.functions.html#marionettebindevents"});t.each(o,function(o,r){t.isString(o)?function(e,i,o,n,r){var s=n.split(/\s+/);t.each(s,function(t){var n=e[t];if(!n)throw new B('Method "'+t+'" was configured as an event handler, but does not exist.');e[r](i,o,n)})}(e,i,r,o,n):e[n](i,r,o)})}}function M(e,t){return E(this,e,t,"listenTo"),this}function P(e,t){return E(this,e,t,"stopListening"),this}function A(e,i,o,n){if(i&&o){if(!t.isObject(o))throw new B({message:"Bindings must be an object.",url:"marionette.functions.html#marionettebindrequests"});var r=c.call(e,o);i[n](r,e)}}function D(e,t){return A(this,e,t,"reply"),this}function R(e,t){return A(this,e,t,"stopReplying"),this}B.extend=n;var O={normalizeMethods:c,_setOptions:function(){for(var e=arguments.length,i=Array(e),o=0;o<e;o++)i[o]=arguments[o];this.options=t.extend.apply(t,[{},t.result(this,"options")].concat(i))},mergeOptions:a,getOption:l,bindEvents:M,unbindEvents:P},F={_initRadio:function(){var e=t.result(this,"channelName");if(e){if(!i)throw new B({name:"BackboneRadioMissing",message:'The dependency "backbone.radio" is missing.'});var o=this._channel=i.channel(e),n=t.result(this,"radioEvents");this.bindEvents(o,n);var r=t.result(this,"radioRequests");this.bindRequests(o,r),this.on("destroy",this._destroyRadio)}},_destroyRadio:function(){this._channel.stopReplying(null,null,this)},getChannel:function(){return this._channel},bindEvents:M,unbindEvents:P,bindRequests:D,unbindRequests:R},I=["channelName","radioEvents","radioRequests"],z=function(e){this._setOptions(e),this.mergeOptions(e,I),this.cid=t.uniqueId(this.cidPrefix),this._initRadio(),this.initialize.apply(this,arguments)};z.extend=n,t.extend(z.prototype,e.Events,O,F,{cidPrefix:"mno",_isDestroyed:!1,isDestroyed:function(){return this._isDestroyed},initialize:function(){},destroy:function(){if(this._isDestroyed)return this;for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return this.triggerMethod.apply(this,["before:destroy",this].concat(t)),this._isDestroyed=!0,this.triggerMethod.apply(this,["destroy",this].concat(t)),this.stopListening(),this},triggerMethod:u});var N={createBuffer:function(){return document.createDocumentFragment()},appendChildren:function(t,i){e.$(t).append(i)},beforeEl:function(t,i){e.$(t).before(i)},replaceEl:function(e,t){if(e!==t){var i=t.parentNode;i&&i.replaceChild(e,t)}},detachContents:function(t){e.$(t).contents().detach()},setInnerContent:function(t,i){e.$(t).html(i)},removeEl:function(t){e.$(t).remove()},findEls:function(t,i){return e.$(t,i)}},L=function(e){this.templateId=e};t.extend(L,{templateCaches:{},get:function(e,t){var i=this.templateCaches[e];return i||(i=new L(e),this.templateCaches[e]=i),i.load(t)},clear:function(){for(var e=void 0,t=arguments.length,i=Array(t),o=0;o<t;o++)i[o]=arguments[o];var n=i.length;if(n>0)for(e=0;e<n;e++)delete this.templateCaches[i[e]];else this.templateCaches={}}}),t.extend(L.prototype,N,{load:function(e){if(this.compiledTemplate)return this.compiledTemplate;var t=this.loadTemplate(this.templateId,e);return this.compiledTemplate=this.compileTemplate(t,e),this.compiledTemplate},loadTemplate:function(e,t){var i=this.findEls(e);if(!i.length)throw new B({name:"NoTemplateError",message:'Could not find template: "'+e+'"'});return i.html()},compileTemplate:function(e,i){return t.template(e,i)}});var $=t.invokeMap||t.invoke;function W(e){if(Array.isArray(e)){for(var t=0,i=Array(e.length);t<e.length;t++)i[t]=e[t];return i}return Array.from(e)}function H(e,i){return t.chain(i).map(function(i,o){var n=function(e,i){return e.behaviorClass?e.behaviorClass:t.isFunction(e)?e:t.isFunction(Se.Behaviors.behaviorsLookup)?Se.Behaviors.behaviorsLookup(e,i)[i]:Se.Behaviors.behaviorsLookup[i]}(i,o),r=i===n?{}:i,s=new n(r,e),a=H(e,t.result(s,"behaviors"));return[s].concat(a)}).flatten().value()}var U={_initBehaviors:function(){this._behaviors=this._getBehaviors()},_getBehaviors:function(){var e=t.result(this,"behaviors");return t.isObject(e)?H(this,e):{}},_getBehaviorTriggers:function(){var e=$(this._behaviors,"getTriggers");return t.extend.apply(t,[{}].concat(W(e)))},_getBehaviorEvents:function(){var e=$(this._behaviors,"getEvents");return t.extend.apply(t,[{}].concat(W(e)))},_proxyBehaviorViewProperties:function(){$(this._behaviors,"proxyViewProperties")},_delegateBehaviorEntityEvents:function(){$(this._behaviors,"delegateEntityEvents")},_undelegateBehaviorEntityEvents:function(){$(this._behaviors,"undelegateEntityEvents")},_destroyBehaviors:function(e){$.apply(void 0,[this._behaviors,"destroy"].concat(W(e)))},_bindBehaviorUIElements:function(){$(this._behaviors,"bindUIElements")},_unbindBehaviorUIElements:function(){$(this._behaviors,"unbindUIElements")},_triggerEventOnBehaviors:function(){for(var e=this._behaviors,t=0,i=e&&e.length;t<i;t++)u.apply(e[t],arguments)}},j={_delegateEntityEvents:function(e,i){this._undelegateEntityEvents(e,i);var o=t.result(this,"modelEvents");M.call(this,e,o);var n=t.result(this,"collectionEvents");M.call(this,i,n)},_undelegateEntityEvents:function(e,i){var o=t.result(this,"modelEvents");P.call(this,e,o);var n=t.result(this,"collectionEvents");P.call(this,i,n)}},q=/^(\S+)\s*(.*)$/,Y=function(e){var i=e.match(q);return function(e,i){return[e+t.uniqueId(".evt"),i].join(" ")}(i[1],i[2])},X={triggersStopPropagation:!0,triggersPreventDefault:!0};function J(e){return!!X[e]}var G={_getViewTriggers:function(e,i){return t.reduce(i,function(i,o,n){return n=Y(n),i[n]=function(e,i){t.isString(i)&&(i={event:i});var o=i.event,n=!!i.preventDefault;J("triggersPreventDefault")&&(n=!1!==i.preventDefault);var r=!!i.stopPropagation;return J("triggersStopPropagation")&&(r=!1!==i.stopPropagation),function(t){n&&t.preventDefault(),r&&t.stopPropagation(),e.triggerMethod(o,e,t)}}(e,o),i},{})}},K=function(e,t){return e.replace(/@ui\.[a-zA-Z-_$0-9]*/g,function(e){return t[e.slice(4)]})},Q={normalizeUIKeys:function(e){var i=this._getUIBindings();return function(e,i){return t.reduce(e,function(e,t,o){var n=K(o,i);return e[n]=t,e},{})}(e,i)},normalizeUIString:function(e){var t=this._getUIBindings();return K(e,t)},normalizeUIValues:function(e,i){var o=this._getUIBindings();return function e(i,o,n){return t.each(i,function(r,s){t.isString(r)?i[s]=K(r,o):t.isObject(r)&&t.isArray(n)&&(t.extend(r,e(t.pick(r,n),o)),t.each(n,function(e){var i=r[e];t.isString(i)&&(r[e]=K(i,o))}))}),i}(e,o,i)},_getUIBindings:function(){var e=t.result(this,"_uiBindings"),i=t.result(this,"ui");return e||i},_bindUIElements:function(){var e=this;if(this.ui){this._uiBindings||(this._uiBindings=this.ui);var i=t.result(this,"_uiBindings");this._ui={},t.each(i,function(t,i){e._ui[i]=e.$(t)}),this.ui=this._ui}},_unbindUIElements:function(){var e=this;this.ui&&this._uiBindings&&(t.each(this.ui,function(t,i){delete e.ui[i]}),this.ui=this._uiBindings,delete this._uiBindings,delete this._ui)},_getUI:function(e){return this._ui[e]}},Z={supportsRenderLifecycle:!0,supportsDestroyLifecycle:!0,_isDestroyed:!1,isDestroyed:function(){return!!this._isDestroyed},_isRendered:!1,isRendered:function(){return!!this._isRendered},_isAttached:!1,isAttached:function(){return!!this._isAttached},delegateEvents:function(i){this._proxyBehaviorViewProperties(),this._buildEventProxies();var o=this._getEvents(i);void 0===i&&(this.events=o);var n=t.extend({},this._getBehaviorEvents(),o,this._getBehaviorTriggers(),this.getTriggers());return e.View.prototype.delegateEvents.call(this,n),this},_getEvents:function(e){var i=e||this.events;return t.isFunction(i)?this.normalizeUIKeys(i.call(this)):this.normalizeUIKeys(i)},getTriggers:function(){if(this.triggers){var e=this.normalizeUIKeys(t.result(this,"triggers"));return this._getViewTriggers(this,e)}},delegateEntityEvents:function(){return this._delegateEntityEvents(this.model,this.collection),this._delegateBehaviorEntityEvents(),this},undelegateEntityEvents:function(){return this._undelegateEntityEvents(this.model,this.collection),this._undelegateBehaviorEntityEvents(),this},destroy:function(){if(this._isDestroyed)return this;for(var e=!!this._isAttached,t=arguments.length,i=Array(t),o=0;o<t;o++)i[o]=arguments[o];return this.triggerMethod.apply(this,["before:destroy",this].concat(i)),e&&this.triggerMethod("before:detach",this),this.unbindUIElements(),this.removeEl(this.el),e&&(this._isAttached=!1,this.triggerMethod("detach",this)),this._removeChildren(),this._destroyBehaviors(i),this._isDestroyed=!0,this._isRendered=!1,this.triggerMethod.apply(this,["destroy",this].concat(i)),this.stopListening(),this},bindUIElements:function(){return this._bindUIElements(),this._bindBehaviorUIElements(),this},unbindUIElements:function(){return this._unbindUIElements(),this._unbindBehaviorUIElements(),this},getUI:function(e){return this._getUI(e)},childViewEventPrefix:"childview",triggerMethod:function(){var e=u.apply(this,arguments);return this._triggerEventOnBehaviors.apply(this,arguments),e},_buildEventProxies:function(){this._childViewEvents=t.result(this,"childViewEvents"),this._childViewTriggers=t.result(this,"childViewTriggers")},_proxyChildViewEvents:function(e){this.listenTo(e,"all",this._childViewEventHandler)},_childViewEventHandler:function(e){for(var i=this.normalizeMethods(this._childViewEvents),o=arguments.length,n=Array(o>1?o-1:0),r=1;r<o;r++)n[r-1]=arguments[r];void 0!==i&&t.isFunction(i[e])&&i[e].apply(this,n);var s=this._childViewTriggers;s&&t.isString(s[e])&&this.triggerMethod.apply(this,[s[e]].concat(n));var a=t.result(this,"childViewEventPrefix");if(!1!==a){var l=a+":"+e;this.triggerMethod.apply(this,[l].concat(n))}}};function ee(e){e.supportsDestroyLifecycle||g(e,"before:destroy",e);var t=!!e._isAttached;t&&g(e,"before:detach",e),e.remove(),t&&(e._isAttached=!1,g(e,"detach",e)),e._isDestroyed=!0,e.supportsDestroyLifecycle||g(e,"destroy",e)}t.extend(Z,N,U,O,j,G,Q);var te=["allowMissingEl","parentEl","replaceElement"],ie=z.extend({cidPrefix:"mnr",replaceElement:!1,_isReplaced:!1,constructor:function(t){if(this._setOptions(t),this.mergeOptions(t,te),this._initEl=this.el=this.getOption("el"),this.el=this.el instanceof e.$?this.el[0]:this.el,!this.el)throw new B({name:"NoElError",message:'An "el" must be specified for a region.'});this.$el=this.getEl(this.el),z.call(this,t)},show:function(e,t){if(this._ensureElement(t))return(e=this._getView(e,t))===this.currentView?this:(this.triggerMethod("before:show",this,e,t),e._isAttached||this.empty(t),this._setupChildView(e),this._renderView(e),this._attachView(e,t),this.currentView=e,this.triggerMethod("show",this,e,t),this)},_setupChildView:function(e){T(e),this._proxyChildViewEvents(e),e.on("destroy",this._empty,this)},_proxyChildViewEvents:function(e){var t=this._parentView;t&&t._proxyChildViewEvents(e)},_renderView:function(e){e._isRendered||(e.supportsRenderLifecycle||g(e,"before:render",e),e.render(),e.supportsRenderLifecycle||(e._isRendered=!0,g(e,"render",e)))},_attachView:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=!e._isAttached&&s(this.el),n=void 0===i.replaceElement?!!t.result(this,"replaceElement"):!!i.replaceElement;o&&g(e,"before:attach",e),n?this._replaceEl(e):this.attachHtml(e),o&&(e._isAttached=!0,g(e,"attach",e))},_ensureElement:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(t.isObject(this.el)||(this.$el=this.getEl(this.el),this.el=this.$el[0]),!this.$el||0===this.$el.length){var i=void 0===e.allowMissingEl?!!t.result(this,"allowMissingEl"):!!e.allowMissingEl;if(i)return!1;throw new B('An "el" must exist in DOM for this region '+this.cid)}return!0},_getView:function(t){if(!t)throw new B({name:"ViewNotValid",message:"The view passed is undefined and therefore invalid. You must pass a view instance to show."});if(t._isDestroyed)throw new B({name:"ViewDestroyedError",message:'View (cid: "'+t.cid+'") has already been destroyed and cannot be used.'});if(t instanceof e.View)return t;var i=this._getViewOptions(t);return new le(i)},_getViewOptions:function(e){return t.isFunction(e)?{template:e}:t.isObject(e)?e:{template:function(){return e}}},getEl:function(e){return this.findEls(e,t.result(this,"parentEl"))},_replaceEl:function(e){this._restoreEl(),e.on("before:destroy",this._restoreEl,this),this.replaceEl(e.el,this.el),this._isReplaced=!0},_restoreEl:function(){if(this._isReplaced){var e=this.currentView;e&&(this.replaceEl(this.el,e.el),this._isReplaced=!1)}},isReplaced:function(){return!!this._isReplaced},attachHtml:function(e){this.appendChildren(this.el,e.el)},empty:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{allowMissingEl:!0},t=this.currentView;if(!t)return this._ensureElement(e)&&this.detachHtml(),this;var i=!e.preventDestroy;return i||r("The preventDestroy option is deprecated. Use Region#detachView"),this._empty(t,i),this},_empty:function(e,t){e.off("destroy",this._empty,this),this.triggerMethod("before:empty",this,e),this._restoreEl(),delete this.currentView,e._isDestroyed||(this._removeView(e,t),this._stopChildViewEvents(e)),this.triggerMethod("empty",this,e)},_stopChildViewEvents:function(e){var t=this._parentView;t&&this._parentView.stopListening(e)},_removeView:function(e,t){t?e.destroy?e.destroy():ee(e):this._detachView(e)},detachView:function(){var e=this.currentView;if(e)return this._empty(e),e},_detachView:function(e){var t=!!e._isAttached;t&&g(e,"before:detach",e),this.detachHtml(),t&&(e._isAttached=!1,g(e,"detach",e))},detachHtml:function(){this.detachContents(this.el)},hasView:function(){return!!this.currentView},reset:function(e){return this.empty(e),this.$el&&(this.el=this._initEl),delete this.$el,this},destroy:function(e){return this.reset(e),z.prototype.destroy.apply(this,arguments)}});t.extend(ie.prototype,N);var oe=function(e,i){return e instanceof ie?e:function(e,i){var o=t.extend({},i);if(t.isString(e))return t.extend(o,{el:e}),ne(o);if(t.isFunction(e))return t.extend(o,{regionClass:e}),ne(o);if(t.isObject(e))return e.selector&&r("The selector option on a Region definition object is deprecated. Use el to pass a selector string"),t.extend(o,{el:e.selector},e),ne(o);throw new B({message:"Improper region configuration type.",url:"marionette.region.html#region-configuration-types"})}(e,i)};function ne(e){var i=e.regionClass,o=t.omit(e,"regionClass");return new i(o)}var re={regionClass:ie,_initRegions:function(){this.regions=this.regions||{},this._regions={},this.addRegions(t.result(this,"regions"))},_reInitRegions:function(){$(this._regions,"reset")},addRegion:function(e,t){var i={};return i[e]=t,this.addRegions(i)[e]},addRegions:function(e){if(!t.isEmpty(e))return e=this.normalizeUIValues(e,["selector","el"]),this.regions=t.extend({},this.regions,e),this._addRegions(e)},_addRegions:function(e){var i=this,o={regionClass:this.regionClass,parentEl:t.partial(t.result,this,"el")};return t.reduce(e,function(e,t,n){return e[n]=oe(t,o),i._addRegion(e[n],n),e},{})},_addRegion:function(e,t){this.triggerMethod("before:add:region",this,t,e),e._parentView=this,this._regions[t]=e,this.triggerMethod("add:region",this,t,e)},removeRegion:function(e){var t=this._regions[e];return this._removeRegion(t,e),t},removeRegions:function(){var e=this.getRegions();return t.each(this._regions,t.bind(this._removeRegion,this)),e},_removeRegion:function(e,t){this.triggerMethod("before:remove:region",this,t,e),e.destroy(),delete this.regions[t],delete this._regions[t],this.triggerMethod("remove:region",this,t,e)},emptyRegions:function(){var e=this.getRegions();return $(e,"empty"),e},hasRegion:function(e){return!!this.getRegion(e)},getRegion:function(e){return this._regions[e]},getRegions:function(){return t.clone(this._regions)},showChildView:function(e,t){for(var i=this.getRegion(e),o=arguments.length,n=Array(o>2?o-2:0),r=2;r<o;r++)n[r-2]=arguments[r];return i.show.apply(i,[t].concat(n))},detachChildView:function(e){return this.getRegion(e).detachView()},getChildView:function(e){return this.getRegion(e).currentView}},se={render:function(e,i){if(!e)throw new B({name:"TemplateNotFoundError",message:"Cannot render the template since its false, null or undefined."});var o=t.isFunction(e)?e:L.get(e);return o(i)}},ae=["behaviors","childViewEventPrefix","childViewEvents","childViewTriggers","collectionEvents","events","modelEvents","regionClass","regions","template","templateContext","triggers","ui"],le=e.View.extend({constructor:function(i){this.render=t.bind(this.render,this),this._setOptions(i),this.mergeOptions(i,ae),T(this),this._initBehaviors(),this._initRegions();var o=Array.prototype.slice.call(arguments);o[0]=this.options,e.View.prototype.constructor.apply(this,o),this.delegateEntityEvents()},serializeData:function(){return this.model||this.collection?this.model?this.serializeModel():{items:this.serializeCollection()}:{}},serializeModel:function(){return this.model?t.clone(this.model.attributes):{}},serializeCollection:function(){return this.collection?this.collection.map(function(e){return t.clone(e.attributes)}):{}},setElement:function(){var t=!!this.el;return e.View.prototype.setElement.apply(this,arguments),t&&(this._isRendered=!!this.$el.length,this._isAttached=s(this.el)),this._isRendered&&this.bindUIElements(),this},render:function(){return this._isDestroyed?this:(this.triggerMethod("before:render",this),this._isRendered&&this._reInitRegions(),this._renderTemplate(),this.bindUIElements(),this._isRendered=!0,this.triggerMethod("render",this),this)},_renderTemplate:function(){var e=this.getTemplate();if(!1!==e){var t=this.mixinTemplateContext(this.serializeData()),i=se.render(e,t,this);this.attachElContent(i)}},getTemplate:function(){return this.template},mixinTemplateContext:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=t.result(this,"templateContext");return t.extend(e,i)},attachElContent:function(e){return this.setInnerContent(this.el,e),this},_removeChildren:function(){this.removeRegions()},_getImmediateChildren:function(){return t.chain(this.getRegions()).map("currentView").compact().value()}});t.extend(le.prototype,Z,re);var ce,de,he=["forEach","each","map","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","toArray","first","initial","rest","last","without","isEmpty","pluck","reduce"],pe=function(e){this._views={},this._indexByModel={},this._indexByCustom={},this._updateLength(),t.each(e,t.bind(this.add,this))};ce=pe.prototype,de="_views",t.each(he,function(e){ce[e]=function(){var i=t.values(t.result(this,de)),o=[i].concat(t.toArray(arguments));return t[e].apply(t,o)}}),t.extend(pe.prototype,{add:function(e,t){return this._add(e,t)._updateLength()},_add:function(e,t){var i=e.cid;return this._views[i]=e,e.model&&(this._indexByModel[e.model.cid]=i),t&&(this._indexByCustom[t]=i),this},findByModel:function(e){return this.findByModelCid(e.cid)},findByModelCid:function(e){var t=this._indexByModel[e];return this.findByCid(t)},findByCustom:function(e){var t=this._indexByCustom[e];return this.findByCid(t)},findByIndex:function(e){return t.values(this._views)[e]},findByCid:function(e){return this._views[e]},remove:function(e){return this._remove(e)._updateLength()},_remove:function(e){var i=e.cid;return e.model&&delete this._indexByModel[e.model.cid],t.some(this._indexByCustom,t.bind(function(e,t){if(e===i)return delete this._indexByCustom[t],!0},this)),delete this._views[i],this},_updateLength:function(){return this.length=t.size(this._views),this}});var ue=["behaviors","childView","childViewEventPrefix","childViewEvents","childViewOptions","childViewTriggers","collectionEvents","events","filter","emptyView","emptyViewOptions","modelEvents","reorderOnSort","sort","triggers","ui","viewComparator"],ge=e.View.extend({sort:!0,constructor:function(i){this.render=t.bind(this.render,this),this._setOptions(i),this.mergeOptions(i,ue),T(this),this._initBehaviors(),this.once("render",this._initialEvents),this._initChildViewStorage(),this._bufferedChildren=[];var o=Array.prototype.slice.call(arguments);o[0]=this.options,e.View.prototype.constructor.apply(this,o),this.delegateEntityEvents()},_startBuffering:function(){this._isBuffering=!0},_endBuffering:function(){var e=!!this._isAttached,i=e?this._getImmediateChildren():[];this._isBuffering=!1,t.each(i,function(e){g(e,"before:attach",e)}),this.attachBuffer(this,this._createBuffer()),t.each(i,function(e){e._isAttached=!0,g(e,"attach",e)}),this._bufferedChildren=[]},_getImmediateChildren:function(){return t.values(this.children._views)},_initialEvents:function(){this.collection&&(this.listenTo(this.collection,"add",this._onCollectionAdd),this.listenTo(this.collection,"update",this._onCollectionUpdate),this.listenTo(this.collection,"reset",this.render),this.sort&&this.listenTo(this.collection,"sort",this._sortViews))},_onCollectionAdd:function(e,i,o){var n=void 0!==o.at&&(o.index||i.indexOf(e));(this.filter||!1===n)&&(n=t.indexOf(this._filteredSortedModels(n),e)),this._shouldAddChild(e,n)&&(this._destroyEmptyView(),this._addChild(e,n))},_onCollectionUpdate:function(e,t){var i=t.changes;this._removeChildModels(i.removed)},_removeChildModels:function(e){var t=this._getRemovedViews(e);t.length&&(this.children._updateLength(),this._updateIndices(t,!1),this.isEmpty()&&this._showEmptyView())},_getRemovedViews:function(e){var i=this;return t.reduce(e,function(e,t){var o=t&&i.children.findByModel(t);return!o||o._isDestroyed?e:(i._removeChildView(o),e.push(o),e)},[])},_removeChildView:function(e){this.triggerMethod("before:remove:child",this,e),this.children._remove(e),e.destroy?e.destroy():ee(e),this.stopListening(e),this.triggerMethod("remove:child",this,e)},setElement:function(){var t=!!this.el;return e.View.prototype.setElement.apply(this,arguments),t&&(this._isAttached=s(this.el)),this},render:function(){return this._isDestroyed?this:(this.triggerMethod("before:render",this),this._renderChildren(),this._isRendered=!0,this.triggerMethod("render",this),this)},setFilter:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=t.preventRender,o=this._isRendered&&!this._isDestroyed,n=this.filter!==e,r=o&&n&&!i;if(r){var s=this._filteredSortedModels();this.filter=e;var a=this._filteredSortedModels();this._applyModelDeltas(a,s)}else this.filter=e;return this},removeFilter:function(e){return this.setFilter(null,e)},_applyModelDeltas:function(e,i){var o=this,n={};t.each(e,function(e,t){var i=!o.children.findByModel(e);i&&o._onCollectionAdd(e,o.collection,{at:t}),n[e.cid]=!0});var r=t.filter(i,function(e){return!n[e.cid]&&o.children.findByModel(e)});this._removeChildModels(r)},reorder:function(){var e=this,i=this.children,o=this._filteredSortedModels();if(!o.length&&this._showingEmptyView)return this;var n,r,s=t.some(o,function(e){return!i.findByModel(e)});return s?this.render():(n=[],r=i.reduce(function(e,i){var r=t.indexOf(o,i.model);return-1===r?(n.push(i.model),e):(i._index=r,e[r]=i.el,e)},new Array(o.length)),e.triggerMethod("before:reorder",e),e._appendReorderedChildren(r),e._removeChildModels(n),e.triggerMethod("reorder",e)),this},resortView:function(){return this.reorderOnSort?this.reorder():this._renderChildren(),this},_sortViews:function(){var e=this,i=this._filteredSortedModels(),o=t.find(i,function(t,i){var o=e.children.findByModel(t);return!o||o._index!==i});o&&this.resortView()},_emptyViewIndex:-1,_appendReorderedChildren:function(e){this.appendChildren(this.el,e)},_renderChildren:function(){this._isRendered&&(this._destroyEmptyView(),this._destroyChildren());var e=this._filteredSortedModels();this.isEmpty({processedModels:e})?this._showEmptyView():(this.triggerMethod("before:render:children",this),this._startBuffering(),this._showCollection(e),this._endBuffering(),this.triggerMethod("render:children",this))},_createView:function(e,t){var i=this._getChildView(e),o=this._getChildViewOptions(e,t),n=this.buildChildView(e,i,o);return n},_setupChildView:function(e,t){T(e),this._proxyChildViewEvents(e),this.sort&&(e._index=t)},_showCollection:function(e){t.each(e,t.bind(this._addChild,this)),this.children._updateLength()},_filteredSortedModels:function(e){if(!this.collection||!this.collection.length)return[];var t=this.getViewComparator(),i=this.collection.models;if(e=Math.min(Math.max(e,0),i.length-1),t){var o=void 0;e&&(o=i[e],i=i.slice(0,e).concat(i.slice(e+1))),i=this._sortModelsBy(i,t),o&&i.splice(e,0,o)}return i=this._filterModels(i)},getViewComparator:function(){return this.viewComparator},_filterModels:function(e){var i=this;return this.filter&&(e=t.filter(e,function(e,t){return i._shouldAddChild(e,t)})),e},_sortModelsBy:function(e,i){return"string"==typeof i?t.sortBy(e,function(e){return e.get(i)}):1===i.length?t.sortBy(e,t.bind(i,this)):t.clone(e).sort(t.bind(i,this))},_showEmptyView:function(){var i=this._getEmptyView();if(i&&!this._showingEmptyView){this._showingEmptyView=!0;var o=new e.Model,n=this.emptyViewOptions||this.childViewOptions;t.isFunction(n)&&(n=n.call(this,o,this._emptyViewIndex));var r=this.buildChildView(o,i,n);this.triggerMethod("before:render:empty",this,r),this.addChildView(r,0),this.triggerMethod("render:empty",this,r)}},_destroyEmptyView:function(){this._showingEmptyView&&(this.triggerMethod("before:remove:empty",this),this._destroyChildren(),delete this._showingEmptyView,this.triggerMethod("remove:empty",this))},_getEmptyView:function(){var e=this.emptyView;if(e)return this._getView(e)},_getChildView:function(e){var t=this.childView;if(!t)throw new B({name:"NoChildViewError",message:'A "childView" must be specified'});if(!(t=this._getView(t,e)))throw new B({name:"InvalidChildViewError",message:'"childView" must be a view class or a function that returns a view class'});return t},_getView:function(i,o){return i.prototype instanceof e.View||i===e.View?i:t.isFunction(i)?i.call(this,o):void 0},_addChild:function(e,t){var i=this._createView(e,t);return this.addChildView(i,t),i},_getChildViewOptions:function(e,i){return t.isFunction(this.childViewOptions)?this.childViewOptions(e,i):this.childViewOptions},addChildView:function(e,t){return this.triggerMethod("before:add:child",this,e),this._setupChildView(e,t),this._isBuffering?this.children._add(e):(this._updateIndices(e,!0),this.children.add(e)),this._renderView(e),this._attachView(e,t),this.triggerMethod("add:child",this,e),e},_updateIndices:function(e,i){if(this.sort)if(i){var o=t.isArray(e)?t.max(e,"_index"):e;t.isObject(o)&&this.children.each(function(e){e._index>=o._index&&(e._index+=1)})}else t.each(t.sortBy(this.children._views,"_index"),function(e,t){e._index=t})},_renderView:function(e){e._isRendered||(e.supportsRenderLifecycle||g(e,"before:render",e),e.render(),e.supportsRenderLifecycle||(e._isRendered=!0,g(e,"render",e)))},_attachView:function(e,t){var i=!e._isAttached&&!this._isBuffering&&this._isAttached;i&&g(e,"before:attach",e),this.attachHtml(this,e,t),i&&(e._isAttached=!0,g(e,"attach",e))},buildChildView:function(e,i,o){var n=t.extend({model:e},o);return new i(n)},removeChildView:function(e){return!e||e._isDestroyed?e:(this._removeChildView(e),this.children._updateLength(),this._updateIndices(e,!1),e)},isEmpty:function(e){var i=void 0;return t.result(e,"processedModels")?i=e.processedModels:(i=this.collection?this.collection.models:[],i=this._filterModels(i)),0===i.length},attachBuffer:function(e,t){this.appendChildren(e.el,t)},_createBuffer:function(){var e=this,i=this.createBuffer();return t.each(this._bufferedChildren,function(t){e.appendChildren(i,t.el)}),i},attachHtml:function(e,t,i){e._isBuffering?e._bufferedChildren.splice(i,0,t):e._insertBefore(t,i)||e._insertAfter(t)},_insertBefore:function(e,t){var i=void 0,o=this.sort&&t<this.children.length-1;return o&&(i=this.children.find(function(e){return e._index===t+1})),!!i&&(this.beforeEl(i.el,e.el),!0)},_insertAfter:function(e){this.appendChildren(this.el,e.el)},_initChildViewStorage:function(){this.children=new pe},_removeChildren:function(){this._destroyChildren()},_destroyChildren:function(e){this.children.length&&(this.triggerMethod("before:destroy:children",this),this.children.each(t.bind(this._removeChildView,this)),this.children._updateLength(),this.triggerMethod("destroy:children",this))},_shouldAddChild:function(e,i){var o=this.filter;return!t.isFunction(o)||o.call(this,e,i,this.collection)}});t.extend(ge.prototype,Z);var fe=["childViewContainer","template","templateContext"],me=ge.extend({constructor:function(e){r("CompositeView is deprecated. Convert to View at your earliest convenience"),this.mergeOptions(e,fe),ge.prototype.constructor.apply(this,arguments)},_initialEvents:function(){this.collection&&(this.listenTo(this.collection,"add",this._onCollectionAdd),this.listenTo(this.collection,"update",this._onCollectionUpdate),this.listenTo(this.collection,"reset",this.renderChildren),this.sort&&this.listenTo(this.collection,"sort",this._sortViews))},_getChildView:function(e){var t=this.childView;if(!t)return this.constructor;if(!(t=this._getView(t,e)))throw new B({name:"InvalidChildViewError",message:'"childView" must be a view class or a function that returns a view class'});return t},serializeData:function(){return this.serializeModel()},render:function(){return this._isDestroyed?this:(this._isRendering=!0,this.resetChildViewContainer(),this.triggerMethod("before:render",this),this._renderTemplate(),this.bindUIElements(),this.renderChildren(),this._isRendering=!1,this._isRendered=!0,this.triggerMethod("render",this),this)},renderChildren:function(){(this._isRendered||this._isRendering)&&ge.prototype._renderChildren.call(this)},attachBuffer:function(e,t){var i=this.getChildViewContainer(e);this.appendChildren(i,t)},_insertAfter:function(e){var t=this.getChildViewContainer(this,e);this.appendChildren(t,e.el)},_appendReorderedChildren:function(e){var t=this.getChildViewContainer(this);this.appendChildren(t,e)},getChildViewContainer:function(e,i){if(e.$childViewContainer)return e.$childViewContainer;var o=void 0,n=e.childViewContainer;if(n){var r=t.result(e,"childViewContainer");if((o="@"===r.charAt(0)&&e.ui?e.ui[r.substr(4)]:this.findEls(r,e.$el)).length<=0)throw new B({name:"ChildViewContainerMissingError",message:'The specified "childViewContainer" was not found: '+e.childViewContainer})}else o=e.$el;return e.$childViewContainer=o,o},resetChildViewContainer:function(){this.$childViewContainer&&(this.$childViewContainer=void 0)}}),_e=t.pick(le.prototype,"serializeModel","getTemplate","_renderTemplate","mixinTemplateContext","attachElContent");t.extend(me.prototype,_e);var ve=["collectionEvents","events","modelEvents","triggers","ui"],we=z.extend({cidPrefix:"mnb",constructor:function(e,i){this.view=i,this.defaults=t.clone(t.result(this,"defaults",{})),this._setOptions(this.defaults,e),this.mergeOptions(this.options,ve),this.ui=t.extend({},t.result(this,"ui"),t.result(i,"ui")),z.apply(this,arguments)},$:function(){return this.view.$.apply(this.view,arguments)},destroy:function(){return this.stopListening(),this},proxyViewProperties:function(){return this.$el=this.view.$el,this.el=this.view.el,this},bindUIElements:function(){return this._bindUIElements(),this},unbindUIElements:function(){return this._unbindUIElements(),this},getUI:function(e){return this._getUI(e)},delegateEntityEvents:function(){return this._delegateEntityEvents(this.view.model,this.view.collection),this},undelegateEntityEvents:function(){return this._undelegateEntityEvents(this.view.model,this.view.collection),this},getEvents:function(){var e=this,i=this.normalizeUIKeys(t.result(this,"events"));return t.reduce(i,function(i,o,n){if(t.isFunction(o)||(o=e[o]),o)return n=Y(n),i[n]=t.bind(o,e),i},{})},getTriggers:function(){if(this.triggers){var e=this.normalizeUIKeys(t.result(this,"triggers"));return this._getViewTriggers(this.view,e)}}});t.extend(we.prototype,j,G,Q);var ye=["region","regionClass"],be=z.extend({cidPrefix:"mna",constructor:function(e){this._setOptions(e),this.mergeOptions(e,ye),this._initRegion(),z.prototype.constructor.apply(this,arguments)},regionClass:ie,_initRegion:function(){var e=this.region;if(e){var t={regionClass:this.regionClass};this._region=oe(e,t)}},getRegion:function(){return this._region},showView:function(e){for(var t=this.getRegion(),i=arguments.length,o=Array(i>1?i-1:0),n=1;n<i;n++)o[n-1]=arguments[n];return t.show.apply(t,[e].concat(o))},getView:function(){return this.getRegion().currentView},start:function(e){return this.triggerMethod("before:start",this,e),this.triggerMethod("start",this,e),this}}),xe=["appRoutes","controller"],ke=e.Router.extend({constructor:function(t){this._setOptions(t),this.mergeOptions(t,xe),e.Router.apply(this,arguments);var i=this.appRoutes,o=this._getController();this.processAppRoutes(o,i),this.on("route",this._processOnRoute,this)},appRoute:function(e,t){var i=this._getController();return this._addAppRoute(i,e,t),this},_processOnRoute:function(e,i){if(t.isFunction(this.onRoute)){var o=t.invert(this.appRoutes)[e];this.onRoute(e,o,i)}},processAppRoutes:function(e,i){var o=this;if(!i)return this;var n=t.keys(i).reverse();return t.each(n,function(t){o._addAppRoute(e,t,i[t])}),this},_getController:function(){return this.controller},_addAppRoute:function(e,i,o){var n=e[o];if(!n)throw new B('Method "'+o+'" was not found on the controller');this.route(i,o,t.bind(n,e))},triggerMethod:u});t.extend(ke.prototype,O);var Ce=e.Marionette,Se=e.Marionette={};return Se.noConflict=function(){return e.Marionette=Ce,this},Se.bindEvents=o(M),Se.unbindEvents=o(P),Se.bindRequests=o(D),Se.unbindRequests=o(R),Se.mergeOptions=o(a),Se.getOption=o(l),Se.normalizeMethods=o(c),Se.extend=n,Se.isNodeAttached=s,Se.deprecate=r,Se.triggerMethod=o(u),Se.triggerMethodOn=g,Se.isEnabled=J,Se.setEnabled=function(e,t){return X[e]=t},Se.monitorViewEvents=T,Se.Behaviors={},Se.Behaviors.behaviorsLookup=function(){throw new B({message:"You must define where your behaviors are stored.",url:"marionette.behaviors.md#behaviorslookup"})},Se.Application=be,Se.AppRouter=ke,Se.Renderer=se,Se.TemplateCache=L,Se.View=le,Se.CollectionView=ge,Se.CompositeView=me,Se.Behavior=we,Se.Region=ie,Se.Error=B,Se.Object=z,Se.DEV_MODE=!1,Se.FEATURES=X,Se.VERSION="3.2.0",Se}(i(34),i(3),i(93))},255:function(e,t,i){e.exports=i(511)},32:function(e,t){Backbone.SuperModel=function(e,t){var i=function(t){return e.isString(t)&&(t=t.split(".")),t},o=function(e,t,o){t=i(t),lastKeyIndex=t.length-1;for(var n=0;n<lastKeyIndex;++n)key=t[n],key in e||(e[key]={}),e=e[key];o(e,t[lastKeyIndex])},n=function(o,r,s){r=i(r);var a=e.first(r),l=o.get(a);l instanceof t.Model&&n(l,e.rest(r),s),s(o,r)},r=function(t,i,o){var n;i&&(n=e.result(t,"relations")[i]);return o&&!n&&(n=a),null==n&&(n=a),n},s=function(t,i,o){var n=e.result(t,"name");return n&&!i[n]&&(i[n]=t),i},a=t.Model.extend({relations:{},unsafeAttributes:[],name:null,_valueForCollection:function(t){return!!e.isArray(t)&&(!(t.length>=1)||e.isObject(t[0]))},_nestedSet:function(i,o,n){for(var c=(i=i.split(".")).length-1,d=this,h=0;h<c;++h){var p=i[h];if(!d.attributes[p]){var u=new(r(d,p,o));d.attributes[p]=s(d,u)}d=d.attributes[p]}var g=i[c];if(!e.isArray(o)&&e.isObject(o)&&function(e){return e.constructor===Object}(o))if(0===e.size(o))d.attributes[g]=new a;else for(var f in o){var m=g+"."+f;d._nestedSet(m,o[f],n)}else if(this._valueForCollection(o)){var _=r(d,g,o);_.prototype instanceof t.Model&&(_=l);var v=new _(o);v=s(d,v),d.attributes[g]=v}else 1==i.length?d.attributes[g]=o:d.set(g,o,e.extend({skipNested:!0,forceChange:!0},n));n.silent||function(t){for(var i=t.length-1;i>=0;i--){var o=t.slice(0,i),n=t.slice(i);if(1!=n.length){var r=this;(o=o.join(".")).length>0&&(r=this.get(o));for(var s=e.first(n),a=e.rest(n),l=[s],c=0;c<a.length;c++)s=[s,a[c]].join("."),l.push(s);for(var d=0;d<l.length;d++){var h=l[d],p=r.trigger;p&&e.isFunction(p)&&p.call(r,"change:"+h,r,r.get(h))}}}}.call(this,i)},_setChanging:function(){this._previousAttributes=this.toJSON(),this.changed={}},_triggerChanges:function(e,t,i){e.length&&(this._pending=!0);for(var o=0,n=e.length;o<n;o++)i||(i=this.get(e[o])),1==e[o].split(".").length&&this.trigger("change:"+e[o],this,i,t)},_setChange:function(t,i,n){var r,s,a=this.get(t);return t=t.split("."),!e.isEqual(a,i)||n.forceChange?(r=this.changed,s=i,o(r,t,function(e,t){e[t]=s}),!0):(function(e,t){o(e,t,function(e,t){delete e[t]})}(this.changed,t),!1)},set:function(e,t,i){var o,r,s,a,l,c,d;if(null==e)return this;if("object"==typeof e?(r=e,i=t):(r={})[e]=t,i=i||{},!this._validate(r,i))return!1;s=i.unset,l=i.silent,a=[],c=this._changing,d=i.skipNested,this._changing=!0,c||this._setChanging(),this.idAttribute in r&&(this.id=r[this.idAttribute]);var h=function(e,t){delete e.attributes[t]};for(o in r)t=r[o],this._setChange(o,t,i)&&a.push(o),s?n(this,o,h):d?this.attributes[o]=t:this._nestedSet(o,t,i);if(l||this._triggerChanges(a,i),c)return this;if(!l)for(;this._pending;)this._pending=!1,this.trigger("change",this,i);return this._pending=!1,this._changing=!1,this},get:function(t){var i=t?t.split("."):[];if(i.length>1){var o=this.attributes[e.first(i)];if(!o)return;var n=e.rest(i).join(".");return e.isFunction(o.get)?o.get(n):o[n]}return this.attributes[t]},toJSON:function(t){t=t||{};var i=e.result(this,"unsafeAttributes");t.except&&(i=e.union(i,t.except));var o=e.clone(this.attributes);return e.each(i,function(e){delete o[e]}),e.each(o,function(t,i){t&&e.isFunction(t.toJSON)&&(o[i]=t.toJSON())}),o},hasChanged:function(t){return null==t?!e.isEmpty(this.changed):(i=this.changed,n=!1,o(i,t,function(t,i){n=e.has(t,i)}),n);var i,n},previous:function(e){return null!=e&&this._previousAttributes?function(e,t,o){for(var n=(t=i(t)).length,r=0;r<n;r++){if(!e||"object"!=typeof e)return o;e=e[t[r]]}return void 0===e?o:e}(this._previousAttributes,e):null},clear:function(e){for(var i in this.id=void 0,this.attributes){var o=this.attributes[i];o instanceof t.Model?o.clear():o instanceof t.Collection?o.reset():this.unset(i)}return this}}),l=t.Collection.extend({model:a});return a}(_,Backbone),e.exports=Backbone.SuperModel},382:function(e,t,i){var o;!function(n,r,s){if(n){for(var a,l={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},c={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},d={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},h={option:"alt",command:"meta",return:"enter",escape:"esc",plus:"+",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"},p=1;p<20;++p)l[111+p]="f"+p;for(p=0;p<=9;++p)l[p+96]=p.toString();v.prototype.bind=function(e,t,i){return e=e instanceof Array?e:[e],this._bindMultiple.call(this,e,t,i),this},v.prototype.unbind=function(e,t){return this.bind.call(this,e,function(){},t)},v.prototype.trigger=function(e,t){return this._directMap[e+":"+t]&&this._directMap[e+":"+t]({},e),this},v.prototype.reset=function(){return this._callbacks={},this._directMap={},this},v.prototype.stopCallback=function(e,t){if((" "+t.className+" ").indexOf(" mousetrap ")>-1)return!1;if(function e(t,i){return null!==t&&t!==r&&(t===i||e(t.parentNode,i))}(t,this.target))return!1;if("composedPath"in e&&"function"==typeof e.composedPath){var i=e.composedPath()[0];i!==e.target&&(t=i)}return"INPUT"==t.tagName||"SELECT"==t.tagName||"TEXTAREA"==t.tagName||t.isContentEditable},v.prototype.handleKey=function(){return this._handleKey.apply(this,arguments)},v.addKeycodes=function(e){for(var t in e)e.hasOwnProperty(t)&&(l[t]=e[t]);a=null},v.init=function(){var e=v(r);for(var t in e)"_"!==t.charAt(0)&&(v[t]=function(t){return function(){return e[t].apply(e,arguments)}}(t))},v.init(),n.Mousetrap=v,e.exports&&(e.exports=v),void 0===(o=function(){return v}.call(t,i,t,e))||(e.exports=o)}function u(e,t,i){e.addEventListener?e.addEventListener(t,i,!1):e.attachEvent("on"+t,i)}function g(e){if("keypress"==e.type){var t=String.fromCharCode(e.which);return e.shiftKey||(t=t.toLowerCase()),t}return l[e.which]?l[e.which]:c[e.which]?c[e.which]:String.fromCharCode(e.which).toLowerCase()}function f(e){return"shift"==e||"ctrl"==e||"alt"==e||"meta"==e}function m(e,t,i){return i||(i=function(){if(!a)for(var e in a={},l)e>95&&e<112||l.hasOwnProperty(e)&&(a[l[e]]=e);return a}()[e]?"keydown":"keypress"),"keypress"==i&&t.length&&(i="keydown"),i}function _(e,t){var i,o,n,r=[];for(i=function(e){return"+"===e?["+"]:(e=e.replace(/\+{2}/g,"+plus")).split("+")}(e),n=0;n<i.length;++n)o=i[n],h[o]&&(o=h[o]),t&&"keypress"!=t&&d[o]&&(o=d[o],r.push("shift")),f(o)&&r.push(o);return{key:o,modifiers:r,action:t=m(o,r,t)}}function v(e){var t=this;if(e=e||r,!(t instanceof v))return new v(e);t.target=e,t._callbacks={},t._directMap={};var i,o={},n=!1,s=!1,a=!1;function l(e){e=e||{};var t,i=!1;for(t in o)e[t]?i=!0:o[t]=0;i||(a=!1)}function c(e,i,n,r,s,a){var l,c,d,h,p=[],u=n.type;if(!t._callbacks[e])return[];for("keyup"==u&&f(e)&&(i=[e]),l=0;l<t._callbacks[e].length;++l)if(c=t._callbacks[e][l],(r||!c.seq||o[c.seq]==c.level)&&u==c.action&&("keypress"==u&&!n.metaKey&&!n.ctrlKey||(d=i,h=c.modifiers,d.sort().join(",")===h.sort().join(",")))){var g=!r&&c.combo==s,m=r&&c.seq==r&&c.level==a;(g||m)&&t._callbacks[e].splice(l,1),p.push(c)}return p}function d(e,i,o,n){t.stopCallback(i,i.target||i.srcElement,o,n)||!1===e(i,o)&&(function(e){e.preventDefault?e.preventDefault():e.returnValue=!1}(i),function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}(i))}function h(e){"number"!=typeof e.which&&(e.which=e.keyCode);var i=g(e);i&&("keyup"!=e.type||n!==i?t.handleKey(i,function(e){var t=[];return e.shiftKey&&t.push("shift"),e.altKey&&t.push("alt"),e.ctrlKey&&t.push("ctrl"),e.metaKey&&t.push("meta"),t}(e),e):n=!1)}function p(e,t,r,s){function c(t){return function(){a=t,++o[e],clearTimeout(i),i=setTimeout(l,1e3)}}function h(t){d(r,t,e),"keyup"!==s&&(n=g(t)),setTimeout(l,10)}o[e]=0;for(var p=0;p<t.length;++p){var u=p+1===t.length?h:c(s||_(t[p+1]).action);m(t[p],u,s,e,p)}}function m(e,i,o,n,r){t._directMap[e+":"+o]=i;var s,a=(e=e.replace(/\s+/g," ")).split(" ");a.length>1?p(e,a,i,o):(s=_(e,o),t._callbacks[s.key]=t._callbacks[s.key]||[],c(s.key,s.modifiers,{type:s.action},n,e,r),t._callbacks[s.key][n?"unshift":"push"]({callback:i,modifiers:s.modifiers,action:s.action,seq:n,level:r,combo:e}))}t._handleKey=function(e,t,i){var o,n=c(e,t,i),r={},h=0,p=!1;for(o=0;o<n.length;++o)n[o].seq&&(h=Math.max(h,n[o].level));for(o=0;o<n.length;++o)if(n[o].seq){if(n[o].level!=h)continue;p=!0,r[n[o].seq]=1,d(n[o].callback,i,n[o].combo,n[o].seq)}else p||d(n[o].callback,i,n[o].combo);var u="keypress"==i.type&&s;i.type!=a||f(e)||u||l(r),s=p&&"keydown"==i.type},t._bindMultiple=function(e,t,i){for(var o=0;o<e.length;++o)m(e[o],t,i)},u(e,"keypress",h),u(e,"keydown",h),u(e,"keyup",h)}}("undefined"!=typeof window?window:null,"undefined"!=typeof window?document:null)},4:function(e,t){e.exports=jQuery},401:function(e,t){
/*! @source http://purl.eligrey.com/github/Blob.js/blob/master/Blob.js */
!function(e){"use strict";if(e.URL=e.URL||e.webkitURL,e.Blob&&e.URL)try{return void new Blob}catch(e){}var t=e.BlobBuilder||e.WebKitBlobBuilder||e.MozBlobBuilder||function(e){var t=function(e){return Object.prototype.toString.call(e).match(/^\[object\s(.*)\]$/)[1]},i=function(){this.data=[]},o=function(e,t,i){this.data=e,this.size=e.length,this.type=t,this.encoding=i},n=i.prototype,r=o.prototype,s=e.FileReaderSync,a=function(e){this.code=this[this.name=e]},l="NOT_FOUND_ERR SECURITY_ERR ABORT_ERR NOT_READABLE_ERR ENCODING_ERR NO_MODIFICATION_ALLOWED_ERR INVALID_STATE_ERR SYNTAX_ERR".split(" "),c=l.length,d=e.URL||e.webkitURL||e,h=d.createObjectURL,p=d.revokeObjectURL,u=d,g=e.btoa,f=e.atob,m=e.ArrayBuffer,_=e.Uint8Array,v=/^[\w-]+:\/*\[?[\w\.:-]+\]?(?::[0-9]+)?/;for(o.fake=r.fake=!0;c--;)a.prototype[l[c]]=c+1;return d.createObjectURL||(u=e.URL=function(e){var t,i=document.createElementNS("http://www.w3.org/1999/xhtml","a");return i.href=e,"origin"in i||("data:"===i.protocol.toLowerCase()?i.origin=null:(t=e.match(v),i.origin=t&&t[1])),i}),u.createObjectURL=function(e){var t,i=e.type;return null===i&&(i="application/octet-stream"),e instanceof o?(t="data:"+i,"base64"===e.encoding?t+";base64,"+e.data:"URI"===e.encoding?t+","+decodeURIComponent(e.data):g?t+";base64,"+g(e.data):t+","+encodeURIComponent(e.data)):h?h.call(d,e):void 0},u.revokeObjectURL=function(e){"data:"!==e.substring(0,5)&&p&&p.call(d,e)},n.append=function(e){var i=this.data;if(_&&(e instanceof m||e instanceof _)){for(var n="",r=new _(e),l=0,c=r.length;l<c;l++)n+=String.fromCharCode(r[l]);i.push(n)}else if("Blob"===t(e)||"File"===t(e)){if(!s)throw new a("NOT_READABLE_ERR");var d=new s;i.push(d.readAsBinaryString(e))}else e instanceof o?"base64"===e.encoding&&f?i.push(f(e.data)):"URI"===e.encoding?i.push(decodeURIComponent(e.data)):"raw"===e.encoding&&i.push(e.data):("string"!=typeof e&&(e+=""),i.push(unescape(encodeURIComponent(e))))},n.getBlob=function(e){return arguments.length||(e=null),new o(this.data.join(""),e,"raw")},n.toString=function(){return"[object BlobBuilder]"},r.slice=function(e,t,i){var n=arguments.length;return n<3&&(i=null),new o(this.data.slice(e,n>1?t:this.data.length),i,this.encoding)},r.toString=function(){return"[object Blob]"},r.close=function(){this.size=0,delete this.data},i}(e);e.Blob=function(e,i){var o=i&&i.type||"",n=new t;if(e)for(var r=0,s=e.length;r<s;r++)Uint8Array&&e[r]instanceof Uint8Array?n.append(e[r].buffer):n.append(e[r]);var a=n.getBlob(o);return!a.slice&&a.webkitSlice&&(a.slice=a.webkitSlice),a};var i=Object.getPrototypeOf||function(e){return e.__proto__};e.Blob.prototype=i(new e.Blob)}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content||this),e.exports=window.Blob},402:function(e,t,i){var o,n=n||function(e){"use strict";if(!(void 0===e||"undefined"!=typeof navigator&&/MSIE [1-9]\./.test(navigator.userAgent))){var t=e.document,i=function(){return e.URL||e.webkitURL||e},o=t.createElementNS("http://www.w3.org/1999/xhtml","a"),n="download"in o,r=/constructor/i.test(e.HTMLElement)||e.safari,s=/CriOS\/[\d]+/.test(navigator.userAgent),a=function(t){(e.setImmediate||e.setTimeout)(function(){throw t},0)},l=function(e){setTimeout(function(){"string"==typeof e?i().revokeObjectURL(e):e.remove()},4e4)},c=function(e){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob([String.fromCharCode(65279),e],{type:e.type}):e},d=function(t,d,h){h||(t=c(t));var p,u=this,g="application/octet-stream"===t.type,f=function(){!function(e,t,i){for(var o=(t=[].concat(t)).length;o--;){var n=e["on"+t[o]];if("function"==typeof n)try{n.call(e,i||e)}catch(e){a(e)}}}(u,"writestart progress write writeend".split(" "))};if(u.readyState=u.INIT,n)return p=i().createObjectURL(t),void setTimeout(function(){var e,t;o.href=p,o.download=d,e=o,t=new MouseEvent("click"),e.dispatchEvent(t),f(),l(p),u.readyState=u.DONE});!function(){if((s||g&&r)&&e.FileReader){var o=new FileReader;return o.onloadend=function(){var t=s?o.result:o.result.replace(/^data:[^;]*;/,"data:attachment/file;");e.open(t,"_blank")||(e.location.href=t),t=void 0,u.readyState=u.DONE,f()},o.readAsDataURL(t),void(u.readyState=u.INIT)}p||(p=i().createObjectURL(t)),g?e.location.href=p:e.open(p,"_blank")||(e.location.href=p);u.readyState=u.DONE,f(),l(p)}()},h=d.prototype;return"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob?function(e,t,i){return t=t||e.name||"download",i||(e=c(e)),navigator.msSaveOrOpenBlob(e,t)}:(h.abort=function(){},h.readyState=h.INIT=0,h.WRITING=1,h.DONE=2,h.error=h.onwritestart=h.onprogress=h.onwrite=h.onabort=h.onerror=h.onwriteend=null,function(e,t,i){return new d(e,t||e.name||"download",i)})}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content);
/*! @source http://purl.eligrey.com/github/FileSaver.js/blob/master/FileSaver.js */e.exports?e.exports.saveAs=n:null!==i(508)&&null!==i(509)&&(void 0===(o=function(){return n}.call(t,i,t,e))||(e.exports=o))},506:function(e,t){
/**
@license Sticky-kit v1.1.2 | WTFPL | Leaf Corcoran 2015 | http://leafo.net
 */
(function(){var e,t;e=this.jQuery||window.jQuery,t=e(window),e.fn.stick_in_parent=function(i){var o,n,r,s,a,l,c,d,h,p,u,g,f;for(null==i&&(i={}),f=i.sticky_class,l=i.inner_scrolling,g=i.recalc_every,u=i.parent,h=i.offset_top,d=i.spacer,r=i.bottoming,null==h&&(h=0),null==u&&(u=void 0),null==l&&(l=!0),null==f&&(f="is_stuck"),o=e(document),null==r&&(r=!0),p=function(e){var t,i;return window.getComputedStyle?(e[0],t=window.getComputedStyle(e[0]),i=parseFloat(t.getPropertyValue("width"))+parseFloat(t.getPropertyValue("margin-left"))+parseFloat(t.getPropertyValue("margin-right")),"border-box"!==t.getPropertyValue("box-sizing")&&(i+=parseFloat(t.getPropertyValue("border-left-width"))+parseFloat(t.getPropertyValue("border-right-width"))+parseFloat(t.getPropertyValue("padding-left"))+parseFloat(t.getPropertyValue("padding-right"))),i):e.outerWidth(!0)},s=function(i,n,s,a,c,m,_,v){var w,y,b,x,k,C,S,T,V,B,E,M;if(!i.data("sticky_kit")){if(i.data("sticky_kit",!0),k=o.height(),S=i.parent(),null!=u&&(S=S.closest(u)),!S.length)throw"failed to find stick parent";return b=!1,w=!1,(E=null!=d?d&&i.closest(d):e("<div />"))&&E.css("position",i.css("position")),(T=function(){var e,t,r;if(!v)return k=o.height(),e=parseInt(S.css("border-top-width"),10),t=parseInt(S.css("padding-top"),10),n=parseInt(S.css("padding-bottom"),10),s=S.offset().top+e+t,a=S.height(),b&&(b=!1,w=!1,null==d&&(i.insertAfter(E),E.detach()),i.css({position:"",top:"",width:"",bottom:""}).removeClass(f),r=!0),c=i.offset().top-(parseInt(i.css("margin-top"),10)||0)-h,m=i.outerHeight(!0),_=i.css("float"),E&&E.css({width:p(i),height:m,display:i.css("display"),"vertical-align":i.css("vertical-align"),float:_}),r?M():void 0})(),x=void 0,C=h,B=g,M=function(){var e,p,u,y,V,M;if(!v)return u=!1,null!=B&&(B-=1)<=0&&(B=g,T(),u=!0),u||o.height()===k||(T(),u=!0),y=t.scrollTop(),null!=x&&(p=y-x),x=y,b?(r&&(V=y+m+C>a+s,w&&!V&&(w=!1,i.css({position:"fixed",bottom:"",top:C}).trigger("sticky_kit:unbottom"))),y<c&&(b=!1,C=h,null==d&&("left"!==_&&"right"!==_||i.insertAfter(E),E.detach()),e={position:"",width:"",top:""},i.css(e).removeClass(f).trigger("sticky_kit:unstick")),l&&(M=t.height(),m+h>M&&(w||(C-=p,C=Math.max(M-m,C),C=Math.min(h,C),b&&i.css({top:C+"px"}))))):y>c&&(b=!0,(e={position:"fixed",top:C}).width="border-box"===i.css("box-sizing")?i.outerWidth()+"px":i.width()+"px",i.css(e).addClass(f),null==d&&(i.after(E),"left"!==_&&"right"!==_||E.append(i)),i.trigger("sticky_kit:stick")),b&&r&&(null==V&&(V=y+m+C>a+s),!w&&V)?(w=!0,"static"===S.css("position")&&S.css({position:"relative"}),i.css({position:"absolute",bottom:n,top:"auto"}).trigger("sticky_kit:bottom")):void 0},V=function(){return T(),M()},y=function(){if(v=!0,t.off("touchmove",M),t.off("scroll",M),t.off("resize",V),e(document.body).off("sticky_kit:recalc",V),i.off("sticky_kit:detach",y),i.removeData("sticky_kit"),i.css({position:"",bottom:"",top:"",width:""}),S.position("position",""),b)return null==d&&("left"!==_&&"right"!==_||i.insertAfter(E),E.remove()),i.removeClass(f)},t.on("touchmove",M),t.on("scroll",M),t.on("resize",V),e(document.body).on("sticky_kit:recalc",V),i.on("sticky_kit:detach",y),setTimeout(M,0)}},a=0,c=this.length;a<c;a++)n=this[a],s(e(n));return this}}).call(this)},507:function(e,t,i){var o,n,r,s=i(4);!function(e){if(!e.jQuery){var t=function(e,i){return new t.fn.init(e,i)};t.isWindow=function(e){return null!=e&&e==e.window},t.type=function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?o[r.call(e)]||"object":typeof e},t.isArray=Array.isArray||function(e){return"array"===t.type(e)},t.isPlainObject=function(e){var i;if(!e||"object"!==t.type(e)||e.nodeType||t.isWindow(e))return!1;try{if(e.constructor&&!n.call(e,"constructor")&&!n.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(e){return!1}for(i in e);return void 0===i||n.call(e,i)},t.each=function(e,t,i){var o=0,n=e.length,r=l(e);if(i){if(r)for(;o<n&&!1!==t.apply(e[o],i);o++);else for(o in e)if(!1===t.apply(e[o],i))break}else if(r)for(;o<n&&!1!==t.call(e[o],o,e[o]);o++);else for(o in e)if(!1===t.call(e[o],o,e[o]))break;return e},t.data=function(e,o,n){if(void 0===n){var r=(s=e[t.expando])&&i[s];if(void 0===o)return r;if(r&&o in r)return r[o]}else if(void 0!==o){var s=e[t.expando]||(e[t.expando]=++t.uuid);return i[s]=i[s]||{},i[s][o]=n,n}},t.removeData=function(e,o){var n=e[t.expando],r=n&&i[n];r&&t.each(o,function(e,t){delete r[t]})},t.extend=function(){var e,i,o,n,r,s,a=arguments[0]||{},l=1,c=arguments.length,d=!1;for("boolean"==typeof a&&(d=a,a=arguments[l]||{},l++),"object"!=typeof a&&"function"!==t.type(a)&&(a={}),l===c&&(a=this,l--);l<c;l++)if(null!=(r=arguments[l]))for(n in r)e=a[n],a!==(o=r[n])&&(d&&o&&(t.isPlainObject(o)||(i=t.isArray(o)))?(i?(i=!1,s=e&&t.isArray(e)?e:[]):s=e&&t.isPlainObject(e)?e:{},a[n]=t.extend(d,s,o)):void 0!==o&&(a[n]=o));return a},t.queue=function(e,i,o){if(e){i=(i||"fx")+"queue";var n,r,s,a=t.data(e,i);return o?(!a||t.isArray(o)?a=t.data(e,i,(s=r||[],null!=(n=o)&&(l(Object(n))?function(e,t){for(var i=+t.length,o=0,n=e.length;o<i;)e[n++]=t[o++];if(i!=i)for(;void 0!==t[o];)e[n++]=t[o++];e.length=n}(s,"string"==typeof n?[n]:n):[].push.call(s,n)),s)):a.push(o),a):a||[]}},t.dequeue=function(e,i){t.each(e.nodeType?[e]:e,function(e,o){i=i||"fx";var n=t.queue(o,i),r=n.shift();"inprogress"===r&&(r=n.shift()),r&&("fx"===i&&n.unshift("inprogress"),r.call(o,function(){t.dequeue(o,i)}))})},t.fn=t.prototype={init:function(e){if(e.nodeType)return this[0]=e,this;throw new Error("Not a DOM node.")},offset:function(){var t=this[0].getBoundingClientRect?this[0].getBoundingClientRect():{top:0,left:0};return{top:t.top+(e.pageYOffset||document.scrollTop||0)-(document.clientTop||0),left:t.left+(e.pageXOffset||document.scrollLeft||0)-(document.clientLeft||0)}},position:function(){function e(){for(var e=this.offsetParent||document;e&&"html"===!e.nodeType.toLowerCase&&"static"===e.style.position;)e=e.offsetParent;return e||document}var i=this[0],e=e.apply(i),o=this.offset(),n=/^(?:body|html)$/i.test(e.nodeName)?{top:0,left:0}:t(e).offset();return o.top-=parseFloat(i.style.marginTop)||0,o.left-=parseFloat(i.style.marginLeft)||0,e.style&&(n.top+=parseFloat(e.style.borderTopWidth)||0,n.left+=parseFloat(e.style.borderLeftWidth)||0),{top:o.top-n.top,left:o.left-n.left}}};var i={};t.expando="velocity"+(new Date).getTime(),t.uuid=0;for(var o={},n=o.hasOwnProperty,r=o.toString,s="Boolean Number String Function Array Date RegExp Object Error".split(" "),a=0;a<s.length;a++)o["[object "+s[a]+"]"]=s[a].toLowerCase();t.fn.init.prototype=t.fn,e.Velocity={Utilities:t}}function l(e){var i=e.length,o=t.type(e);return"function"!==o&&!t.isWindow(e)&&(!(1!==e.nodeType||!i)||("array"===o||0===i||"number"==typeof i&&i>0&&i-1 in e))}}(window),r=function(){return function(e,t,i,o){var n,r=function(){if(i.documentMode)return i.documentMode;for(var e=7;e>4;e--){var t=i.createElement("div");if(t.innerHTML="\x3c!--[if IE "+e+"]><span></span><![endif]--\x3e",t.getElementsByTagName("span").length)return t=null,e}return o}(),a=(n=0,t.webkitRequestAnimationFrame||t.mozRequestAnimationFrame||function(e){var t,i=(new Date).getTime();return t=Math.max(0,16-(i-n)),n=i+t,setTimeout(function(){e(i+t)},t)});function l(e){return d.isWrapped(e)?e=[].slice.call(e):d.isNode(e)&&(e=[e]),e}var c,d={isString:function(e){return"string"==typeof e},isArray:Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},isFunction:function(e){return"[object Function]"===Object.prototype.toString.call(e)},isNode:function(e){return e&&e.nodeType},isNodeList:function(e){return"object"==typeof e&&/^\[object (HTMLCollection|NodeList|Object)\]$/.test(Object.prototype.toString.call(e))&&e.length!==o&&(0===e.length||"object"==typeof e[0]&&e[0].nodeType>0)},isWrapped:function(e){return e&&(e.jquery||t.Zepto&&t.Zepto.zepto.isZ(e))},isSVG:function(e){return t.SVGElement&&e instanceof t.SVGElement},isEmptyObject:function(e){for(var t in e)return!1;return!0}},h=!1;if(e.fn&&e.fn.jquery?(c=e,h=!0):c=t.Velocity.Utilities,r<=8&&!h)throw new Error("Velocity: IE8 and below require jQuery to be loaded before Velocity.");if(!(r<=7)){var p=400,u="swing",g={State:{isMobile:/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),isAndroid:/Android/i.test(navigator.userAgent),isGingerbread:/Android 2\.3\.[3-7]/i.test(navigator.userAgent),isChrome:t.chrome,isFirefox:/Firefox/i.test(navigator.userAgent),prefixElement:i.createElement("div"),prefixMatches:{},scrollAnchor:null,scrollPropertyLeft:null,scrollPropertyTop:null,isTicking:!1,calls:[]},CSS:{},Utilities:c,Redirects:{},Easings:{},Promise:t.Promise,defaults:{queue:"",duration:p,easing:u,begin:o,complete:o,progress:o,display:o,visibility:o,loop:!1,delay:!1,mobileHA:!0,_cacheValues:!0},init:function(e){c.data(e,"velocity",{isSVG:d.isSVG(e),isAnimating:!1,computedStyle:null,tweensContainer:null,rootPropertyValueCache:{},transformCache:{}})},hook:null,mock:!1,version:{major:1,minor:2,patch:2},debug:!1};t.pageYOffset!==o?(g.State.scrollAnchor=t,g.State.scrollPropertyLeft="pageXOffset",g.State.scrollPropertyTop="pageYOffset"):(g.State.scrollAnchor=i.documentElement||i.body.parentNode||i.body,g.State.scrollPropertyLeft="scrollLeft",g.State.scrollPropertyTop="scrollTop");var f=function(){function e(e){return-e.tension*e.x-e.friction*e.v}function t(t,i,o){var n={x:t.x+o.dx*i,v:t.v+o.dv*i,tension:t.tension,friction:t.friction};return{dx:n.v,dv:e(n)}}function i(i,o){var n={dx:i.v,dv:e(i)},r=t(i,.5*o,n),s=t(i,.5*o,r),a=t(i,o,s),l=1/6*(n.dx+2*(r.dx+s.dx)+a.dx),c=1/6*(n.dv+2*(r.dv+s.dv)+a.dv);return i.x=i.x+l*o,i.v=i.v+c*o,i}return function e(t,o,n){var r,s,a,l={x:-1,v:0,tension:null,friction:null},c=[0],d=0;for(t=parseFloat(t)||500,o=parseFloat(o)||20,n=n||null,l.tension=t,l.friction=o,s=(r=null!==n)?(d=e(t,o))/n*.016:.016;a=i(a||l,s),c.push(1+a.x),d+=16,Math.abs(a.x)>1e-4&&Math.abs(a.v)>1e-4;);return r?function(e){return c[e*(c.length-1)|0]}:d}}();g.Easings={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},spring:function(e){return 1-Math.cos(4.5*e*Math.PI)*Math.exp(6*-e)}},c.each([["ease",[.25,.1,.25,1]],["ease-in",[.42,0,1,1]],["ease-out",[0,0,.58,1]],["ease-in-out",[.42,0,.58,1]],["easeInSine",[.47,0,.745,.715]],["easeOutSine",[.39,.575,.565,1]],["easeInOutSine",[.445,.05,.55,.95]],["easeInQuad",[.55,.085,.68,.53]],["easeOutQuad",[.25,.46,.45,.94]],["easeInOutQuad",[.455,.03,.515,.955]],["easeInCubic",[.55,.055,.675,.19]],["easeOutCubic",[.215,.61,.355,1]],["easeInOutCubic",[.645,.045,.355,1]],["easeInQuart",[.895,.03,.685,.22]],["easeOutQuart",[.165,.84,.44,1]],["easeInOutQuart",[.77,0,.175,1]],["easeInQuint",[.755,.05,.855,.06]],["easeOutQuint",[.23,1,.32,1]],["easeInOutQuint",[.86,0,.07,1]],["easeInExpo",[.95,.05,.795,.035]],["easeOutExpo",[.19,1,.22,1]],["easeInOutExpo",[1,0,0,1]],["easeInCirc",[.6,.04,.98,.335]],["easeOutCirc",[.075,.82,.165,1]],["easeInOutCirc",[.785,.135,.15,.86]]],function(e,t){g.Easings[t[0]]=y.apply(null,t[1])});var m=g.CSS={RegEx:{isHex:/^#([A-f\d]{3}){1,2}$/i,valueUnwrap:/^[A-z]+\((.*)\)$/i,wrappedValueAlreadyExtracted:/[0-9.]+ [0-9.]+ [0-9.]+( [0-9.]+)?/,valueSplit:/([A-z]+\(.+\))|(([A-z0-9#-.]+?)(?=\s|$))/gi},Lists:{colors:["fill","stroke","stopColor","color","backgroundColor","borderColor","borderTopColor","borderRightColor","borderBottomColor","borderLeftColor","outlineColor"],transformsBase:["translateX","translateY","scale","scaleX","scaleY","skewX","skewY","rotateZ"],transforms3D:["transformPerspective","translateZ","scaleZ","rotateX","rotateY"]},Hooks:{templates:{textShadow:["Color X Y Blur","black 0px 0px 0px"],boxShadow:["Color X Y Blur Spread","black 0px 0px 0px 0px"],clip:["Top Right Bottom Left","0px 0px 0px 0px"],backgroundPosition:["X Y","0% 0%"],transformOrigin:["X Y Z","50% 50% 0px"],perspectiveOrigin:["X Y","50% 50%"]},registered:{},register:function(){for(var e=0;e<m.Lists.colors.length;e++){var t="color"===m.Lists.colors[e]?"0 0 0 1":"255 255 255 1";m.Hooks.templates[m.Lists.colors[e]]=["Red Green Blue Alpha",t]}var i,o,n;if(r)for(i in m.Hooks.templates){n=(o=m.Hooks.templates[i])[0].split(" ");var s=o[1].match(m.RegEx.valueSplit);"Color"===n[0]&&(n.push(n.shift()),s.push(s.shift()),m.Hooks.templates[i]=[n.join(" "),s.join(" ")])}for(i in m.Hooks.templates)for(var e in n=(o=m.Hooks.templates[i])[0].split(" ")){var a=i+n[e],l=e;m.Hooks.registered[a]=[i,l]}},getRoot:function(e){var t=m.Hooks.registered[e];return t?t[0]:e},cleanRootPropertyValue:function(e,t){return m.RegEx.valueUnwrap.test(t)&&(t=t.match(m.RegEx.valueUnwrap)[1]),m.Values.isCSSNullValue(t)&&(t=m.Hooks.templates[e][1]),t},extractValue:function(e,t){var i=m.Hooks.registered[e];if(i){var o=i[0],n=i[1];return(t=m.Hooks.cleanRootPropertyValue(o,t)).toString().match(m.RegEx.valueSplit)[n]}return t},injectValue:function(e,t,i){var o=m.Hooks.registered[e];if(o){var n,r=o[0],s=o[1];return(n=(i=m.Hooks.cleanRootPropertyValue(r,i)).toString().match(m.RegEx.valueSplit))[s]=t,n.join(" ")}return i}},Normalizations:{registered:{clip:function(e,t,i){switch(e){case"name":return"clip";case"extract":var o;return o=m.RegEx.wrappedValueAlreadyExtracted.test(i)?i:(o=i.toString().match(m.RegEx.valueUnwrap))?o[1].replace(/,(\s+)?/g," "):i;case"inject":return"rect("+i+")"}},blur:function(e,t,i){switch(e){case"name":return g.State.isFirefox?"filter":"-webkit-filter";case"extract":var o=parseFloat(i);if(!o&&0!==o){var n=i.toString().match(/blur\(([0-9]+[A-z]+)\)/i);o=n?n[1]:0}return o;case"inject":return parseFloat(i)?"blur("+i+")":"none"}},opacity:function(e,t,i){if(r<=8)switch(e){case"name":return"filter";case"extract":var o=i.toString().match(/alpha\(opacity=(.*)\)/i);return i=o?o[1]/100:1;case"inject":return t.style.zoom=1,parseFloat(i)>=1?"":"alpha(opacity="+parseInt(100*parseFloat(i),10)+")"}else switch(e){case"name":return"opacity";case"extract":case"inject":return i}}},register:function(){r<=9||g.State.isGingerbread||(m.Lists.transformsBase=m.Lists.transformsBase.concat(m.Lists.transforms3D));for(var e=0;e<m.Lists.transformsBase.length;e++)!function(){var t=m.Lists.transformsBase[e];m.Normalizations.registered[t]=function(e,i,n){switch(e){case"name":return"transform";case"extract":return w(i)===o||w(i).transformCache[t]===o?/^scale/i.test(t)?1:0:w(i).transformCache[t].replace(/[()]/g,"");case"inject":var r=!1;switch(t.substr(0,t.length-1)){case"translate":r=!/(%|px|em|rem|vw|vh|\d)$/i.test(n);break;case"scal":case"scale":g.State.isAndroid&&w(i).transformCache[t]===o&&n<1&&(n=1),r=!/(\d)$/i.test(n);break;case"skew":case"rotate":r=!/(deg|\d)$/i.test(n)}return r||(w(i).transformCache[t]="("+n+")"),w(i).transformCache[t]}}}();for(e=0;e<m.Lists.colors.length;e++)!function(){var t=m.Lists.colors[e];m.Normalizations.registered[t]=function(e,i,n){switch(e){case"name":return t;case"extract":var s;if(m.RegEx.wrappedValueAlreadyExtracted.test(n))s=n;else{var a,l={black:"rgb(0, 0, 0)",blue:"rgb(0, 0, 255)",gray:"rgb(128, 128, 128)",green:"rgb(0, 128, 0)",red:"rgb(255, 0, 0)",white:"rgb(255, 255, 255)"};/^[A-z]+$/i.test(n)?a=l[n]!==o?l[n]:l.black:m.RegEx.isHex.test(n)?a="rgb("+m.Values.hexToRgb(n).join(" ")+")":/^rgba?\(/i.test(n)||(a=l.black),s=(a||n).toString().match(m.RegEx.valueUnwrap)[1].replace(/,(\s+)?/g," ")}return r<=8||3!==s.split(" ").length||(s+=" 1"),s;case"inject":return r<=8?4===n.split(" ").length&&(n=n.split(/\s+/).slice(0,3).join(" ")):3===n.split(" ").length&&(n+=" 1"),(r<=8?"rgb":"rgba")+"("+n.replace(/\s+/g,",").replace(/\.(\d)+(?=,)/g,"")+")"}}}()}},Names:{camelCase:function(e){return e.replace(/-(\w)/g,function(e,t){return t.toUpperCase()})},SVGAttribute:function(e){var t="width|height|x|y|cx|cy|r|rx|ry|x1|x2|y1|y2";return(r||g.State.isAndroid&&!g.State.isChrome)&&(t+="|transform"),new RegExp("^("+t+")$","i").test(e)},prefixCheck:function(e){if(g.State.prefixMatches[e])return[g.State.prefixMatches[e],!0];for(var t=["","Webkit","Moz","ms","O"],i=0,o=t.length;i<o;i++){var n;if(n=0===i?e:t[i]+e.replace(/^\w/,function(e){return e.toUpperCase()}),d.isString(g.State.prefixElement.style[n]))return g.State.prefixMatches[e]=n,[n,!0]}return[e,!1]}},Values:{hexToRgb:function(e){var t;return e=e.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(e,t,i,o){return t+t+i+i+o+o}),(t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e))?[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]:[0,0,0]},isCSSNullValue:function(e){return 0==e||/^(none|auto|transparent|(rgba\(0, ?0, ?0, ?0\)))$/i.test(e)},getUnitType:function(e){return/^(rotate|skew)/i.test(e)?"deg":/(^(scale|scaleX|scaleY|scaleZ|alpha|flexGrow|flexHeight|zIndex|fontWeight)$)|((opacity|red|green|blue|alpha)$)/i.test(e)?"":"px"},getDisplayType:function(e){var t=e&&e.tagName.toString().toLowerCase();return/^(b|big|i|small|tt|abbr|acronym|cite|code|dfn|em|kbd|strong|samp|var|a|bdo|br|img|map|object|q|script|span|sub|sup|button|input|label|select|textarea)$/i.test(t)?"inline":/^(li)$/i.test(t)?"list-item":/^(tr)$/i.test(t)?"table-row":/^(table)$/i.test(t)?"table":/^(tbody)$/i.test(t)?"table-row-group":"block"},addClass:function(e,t){e.classList?e.classList.add(t):e.className+=(e.className.length?" ":"")+t},removeClass:function(e,t){e.classList?e.classList.remove(t):e.className=e.className.toString().replace(new RegExp("(^|\\s)"+t.split(" ").join("|")+"(\\s|$)","gi")," ")}},getPropertyValue:function(e,i,n,s){function a(e,i){var n=0;if(r<=8)n=c.css(e,i);else{var l,d=!1;function h(){d&&m.setPropertyValue(e,"display","none")}if(/^(width|height)$/.test(i)&&0===m.getPropertyValue(e,"display")&&(d=!0,m.setPropertyValue(e,"display",m.Values.getDisplayType(e))),!s){if("height"===i&&"border-box"!==m.getPropertyValue(e,"boxSizing").toString().toLowerCase()){var p=e.offsetHeight-(parseFloat(m.getPropertyValue(e,"borderTopWidth"))||0)-(parseFloat(m.getPropertyValue(e,"borderBottomWidth"))||0)-(parseFloat(m.getPropertyValue(e,"paddingTop"))||0)-(parseFloat(m.getPropertyValue(e,"paddingBottom"))||0);return h(),p}if("width"===i&&"border-box"!==m.getPropertyValue(e,"boxSizing").toString().toLowerCase()){var u=e.offsetWidth-(parseFloat(m.getPropertyValue(e,"borderLeftWidth"))||0)-(parseFloat(m.getPropertyValue(e,"borderRightWidth"))||0)-(parseFloat(m.getPropertyValue(e,"paddingLeft"))||0)-(parseFloat(m.getPropertyValue(e,"paddingRight"))||0);return h(),u}}l=w(e)===o?t.getComputedStyle(e,null):w(e).computedStyle?w(e).computedStyle:w(e).computedStyle=t.getComputedStyle(e,null),"borderColor"===i&&(i="borderTopColor"),""!==(n=9===r&&"filter"===i?l.getPropertyValue(i):l[i])&&null!==n||(n=e.style[i]),h()}if("auto"===n&&/^(top|right|bottom|left)$/i.test(i)){var g=a(e,"position");("fixed"===g||"absolute"===g&&/top|left/i.test(i))&&(n=c(e).position()[i]+"px")}return n}var l;if(m.Hooks.registered[i]){var d=i,h=m.Hooks.getRoot(d);n===o&&(n=m.getPropertyValue(e,m.Names.prefixCheck(h)[0])),m.Normalizations.registered[h]&&(n=m.Normalizations.registered[h]("extract",e,n)),l=m.Hooks.extractValue(d,n)}else if(m.Normalizations.registered[i]){var p,u;"transform"!==(p=m.Normalizations.registered[i]("name",e))&&(u=a(e,m.Names.prefixCheck(p)[0]),m.Values.isCSSNullValue(u)&&m.Hooks.templates[i]&&(u=m.Hooks.templates[i][1])),l=m.Normalizations.registered[i]("extract",e,u)}if(!/^[\d-]/.test(l))if(w(e)&&w(e).isSVG&&m.Names.SVGAttribute(i))if(/^(height|width)$/i.test(i))try{l=e.getBBox()[i]}catch(e){l=0}else l=e.getAttribute(i);else l=a(e,m.Names.prefixCheck(i)[0]);return m.Values.isCSSNullValue(l)&&(l=0),g.debug>=2&&console.log("Get "+i+": "+l),l},setPropertyValue:function(e,i,o,n,s){var a=i;if("scroll"===i)s.container?s.container["scroll"+s.direction]=o:"Left"===s.direction?t.scrollTo(o,s.alternateValue):t.scrollTo(s.alternateValue,o);else if(m.Normalizations.registered[i]&&"transform"===m.Normalizations.registered[i]("name",e))m.Normalizations.registered[i]("inject",e,o),a="transform",o=w(e).transformCache[i];else{if(m.Hooks.registered[i]){var l=i,c=m.Hooks.getRoot(i);n=n||m.getPropertyValue(e,c),o=m.Hooks.injectValue(l,o,n),i=c}if(m.Normalizations.registered[i]&&(o=m.Normalizations.registered[i]("inject",e,o),i=m.Normalizations.registered[i]("name",e)),a=m.Names.prefixCheck(i)[0],r<=8)try{e.style[a]=o}catch(e){g.debug&&console.log("Browser does not support ["+o+"] for ["+a+"]")}else w(e)&&w(e).isSVG&&m.Names.SVGAttribute(i)?e.setAttribute(i,o):e.style[a]=o;g.debug>=2&&console.log("Set "+i+" ("+a+"): "+o)}return[a,o]},flushTransformCache:function(e){var t="";if((r||g.State.isAndroid&&!g.State.isChrome)&&w(e).isSVG){function i(t){return parseFloat(m.getPropertyValue(e,t))}var o={translate:[i("translateX"),i("translateY")],skewX:[i("skewX")],skewY:[i("skewY")],scale:1!==i("scale")?[i("scale"),i("scale")]:[i("scaleX"),i("scaleY")],rotate:[i("rotateZ"),0,0]};c.each(w(e).transformCache,function(e){/^translate/i.test(e)?e="translate":/^scale/i.test(e)?e="scale":/^rotate/i.test(e)&&(e="rotate"),o[e]&&(t+=e+"("+o[e].join(" ")+") ",delete o[e])})}else{var n,s;c.each(w(e).transformCache,function(i){if(n=w(e).transformCache[i],"transformPerspective"===i)return s=n,!0;9===r&&"rotateZ"===i&&(i="rotate"),t+=i+n+" "}),s&&(t="perspective"+s+" "+t)}m.setPropertyValue(e,"transform",t)}};m.Hooks.register(),m.Normalizations.register(),g.hook=function(e,t,i){var n=o;return e=l(e),c.each(e,function(e,r){if(w(r)===o&&g.init(r),i===o)n===o&&(n=g.CSS.getPropertyValue(r,t));else{var s=g.CSS.setPropertyValue(r,t,i);"transform"===s[0]&&g.CSS.flushTransformCache(r),n=s}}),n};var _=function(){function e(){return n?T.promise||null:r}var n,r,s,a,h,u,f=arguments[0]&&(arguments[0].p||c.isPlainObject(arguments[0].properties)&&!arguments[0].properties.names||d.isString(arguments[0].properties));if(d.isWrapped(this)?(n=!1,s=0,a=this,r=this):(n=!0,s=1,a=f?arguments[0].elements||arguments[0].e:arguments[0]),a=l(a)){f?(h=arguments[0].properties||arguments[0].p,u=arguments[0].options||arguments[0].o):(h=arguments[s],u=arguments[s+1]);var v=a.length,y=0;if(!/^(stop|finish|finishAll)$/i.test(h)&&!c.isPlainObject(u)){u={};for(var C=s+1;C<arguments.length;C++)d.isArray(arguments[C])||!/^(fast|normal|slow)$/i.test(arguments[C])&&!/^\d/.test(arguments[C])?d.isString(arguments[C])||d.isArray(arguments[C])?u.easing=arguments[C]:d.isFunction(arguments[C])&&(u.complete=arguments[C]):u.duration=arguments[C]}var S,T={promise:null,resolver:null,rejecter:null};switch(n&&g.Promise&&(T.promise=new g.Promise(function(e,t){T.resolver=e,T.rejecter=t})),h){case"scroll":S="scroll";break;case"reverse":S="reverse";break;case"finish":case"finishAll":case"stop":c.each(a,function(e,t){w(t)&&w(t).delayTimer&&(clearTimeout(w(t).delayTimer.setTimeout),w(t).delayTimer.next&&w(t).delayTimer.next(),delete w(t).delayTimer),"finishAll"!==h||!0!==u&&!d.isString(u)||(c.each(c.queue(t,d.isString(u)?u:""),function(e,t){d.isFunction(t)&&t()}),c.queue(t,d.isString(u)?u:"",[]))});var V=[];return c.each(g.State.calls,function(e,t){t&&c.each(t[1],function(i,n){var r=u===o?"":u;if(!0!==r&&t[2].queue!==r&&(u!==o||!1!==t[2].queue))return!0;c.each(a,function(i,o){o===n&&((!0===u||d.isString(u))&&(c.each(c.queue(o,d.isString(u)?u:""),function(e,t){d.isFunction(t)&&t(null,!0)}),c.queue(o,d.isString(u)?u:"",[])),"stop"===h?(w(o)&&w(o).tweensContainer&&!1!==r&&c.each(w(o).tweensContainer,function(e,t){t.endValue=t.currentValue}),V.push(e)):"finish"!==h&&"finishAll"!==h||(t[2].duration=1))})})}),"stop"===h&&(c.each(V,function(e,t){k(t,!0)}),T.promise&&T.resolver(a)),e();default:if(!c.isPlainObject(h)||d.isEmptyObject(h)){if(d.isString(h)&&g.Redirects[h]){var B=(P=c.extend({},u)).duration,E=P.delay||0;return!0===P.backwards&&(a=c.extend(!0,[],a).reverse()),c.each(a,function(e,t){parseFloat(P.stagger)?P.delay=E+parseFloat(P.stagger)*e:d.isFunction(P.stagger)&&(P.delay=E+P.stagger.call(t,e,v)),P.drag&&(P.duration=parseFloat(B)||(/^(callout|transition)/.test(h)?1e3:p),P.duration=Math.max(P.duration*(P.backwards?1-e/v:(e+1)/v),.75*P.duration,200)),g.Redirects[h].call(t,t,P||{},e,v,a,T.promise?T:o)}),e()}var M="Velocity: First argument ("+h+") was not a property map, a known action, or a registered redirect. Aborting.";return T.promise?T.rejecter(new Error(M)):console.log(M),e()}S="start"}var P,A,D={lastParent:null,lastPosition:null,lastFontSize:null,lastPercentToPxWidth:null,lastPercentToPxHeight:null,lastEmToPx:null,remToPx:null,vwToPx:null,vhToPx:null},R=[];if(c.each(a,function(e,n){d.isNode(n)&&function(){var e,n=this,r=c.extend({},g.defaults,u),s={};switch(w(n)===o&&g.init(n),parseFloat(r.delay)&&!1!==r.queue&&c.queue(n,r.queue,function(e){g.velocityQueueEntryFlag=!0,w(n).delayTimer={setTimeout:setTimeout(e,parseFloat(r.delay)),next:e}}),r.duration.toString().toLowerCase()){case"fast":r.duration=200;break;case"normal":r.duration=p;break;case"slow":r.duration=600;break;default:r.duration=parseFloat(r.duration)||1}function l(l){if(r.begin&&0===y)try{r.begin.call(a,a)}catch(e){setTimeout(function(){throw e},1)}if("scroll"===S){var p,f,_,k=/^x$/i.test(r.axis)?"Left":"Top",C=parseFloat(r.offset)||0;r.container?d.isWrapped(r.container)||d.isNode(r.container)?(r.container=r.container[0]||r.container,_=(p=r.container["scroll"+k])+c(n).position()[k.toLowerCase()]+C):r.container=null:(p=g.State.scrollAnchor[g.State["scrollProperty"+k]],f=g.State.scrollAnchor[g.State["scrollProperty"+("Left"===k?"Top":"Left")]],_=c(n).offset()[k.toLowerCase()]+C),s={scroll:{rootPropertyValue:!1,startValue:p,currentValue:p,endValue:_,unitType:"",easing:r.easing,scrollData:{container:r.container,direction:k,alternateValue:f}},element:n},g.debug&&console.log("tweensContainer (scroll): ",s.scroll,n)}else if("reverse"===S){if(!w(n).tweensContainer)return void c.dequeue(n,r.queue);"none"===w(n).opts.display&&(w(n).opts.display="auto"),"hidden"===w(n).opts.visibility&&(w(n).opts.visibility="visible"),w(n).opts.loop=!1,w(n).opts.begin=null,w(n).opts.complete=null,u.easing||delete r.easing,u.duration||delete r.duration,r=c.extend({},w(n).opts,r);var V=c.extend(!0,{},w(n).tweensContainer);for(var B in V)if("element"!==B){var E=V[B].startValue;V[B].startValue=V[B].currentValue=V[B].endValue,V[B].endValue=E,d.isEmptyObject(u)||(V[B].easing=r.easing),g.debug&&console.log("reverse tweensContainer ("+B+"): "+JSON.stringify(V[B]),n)}s=V}else if("start"===S){function M(e,t){var i=o,s=o,a=o;return d.isArray(e)?(i=e[0],!d.isArray(e[1])&&/^[\d-]/.test(e[1])||d.isFunction(e[1])||m.RegEx.isHex.test(e[1])?a=e[1]:(d.isString(e[1])&&!m.RegEx.isHex.test(e[1])||d.isArray(e[1]))&&(s=t?e[1]:b(e[1],r.duration),e[2]!==o&&(a=e[2]))):i=e,t||(s=s||r.easing),d.isFunction(i)&&(i=i.call(n,y,v)),d.isFunction(a)&&(a=a.call(n,y,v)),[i||0,s,a]}for(var P in w(n).tweensContainer&&!0===w(n).isAnimating&&(V=w(n).tweensContainer),c.each(h,function(e,t){if(RegExp("^"+m.Lists.colors.join("$|^")+"$").test(e)){var i=M(t,!0),n=i[0],r=i[1],s=i[2];if(m.RegEx.isHex.test(n)){for(var a=["Red","Green","Blue"],l=m.Values.hexToRgb(n),c=s?m.Values.hexToRgb(s):o,d=0;d<a.length;d++){var p=[l[d]];r&&p.push(r),c!==o&&p.push(c[d]),h[e+a[d]]=p}delete h[e]}}}),h){var A=M(h[P]),O=A[0],F=A[1],I=A[2];P=m.Names.camelCase(P);var z=m.Hooks.getRoot(P),N=!1;if(w(n).isSVG||"tween"===z||!1!==m.Names.prefixCheck(z)[1]||m.Normalizations.registered[z]!==o){(r.display!==o&&null!==r.display&&"none"!==r.display||r.visibility!==o&&"hidden"!==r.visibility)&&/opacity|filter/.test(P)&&!I&&0!==O&&(I=0),r._cacheValues&&V&&V[P]?(I===o&&(I=V[P].endValue+V[P].unitType),N=w(n).rootPropertyValueCache[z]):m.Hooks.registered[P]?I===o?(N=m.getPropertyValue(n,z),I=m.getPropertyValue(n,P,N)):N=m.Hooks.templates[z][1]:I===o&&(I=m.getPropertyValue(n,P));var L,$,W,H=!1;if(I=(L=j(P,I))[0],W=L[1],O=(L=j(P,O))[0].replace(/^([+-\/*])=/,function(e,t){return H=t,""}),$=L[1],I=parseFloat(I)||0,O=parseFloat(O)||0,"%"===$&&(/^(fontSize|lineHeight)$/.test(P)?(O/=100,$="em"):/^scale/.test(P)?(O/=100,$=""):/(Red|Green|Blue)$/i.test(P)&&(O=O/100*255,$="")),/[\/*]/.test(H))$=W;else if(W!==$&&0!==I)if(0===O)$=W;else{e=e||q();var U=/margin|padding|left|right|width|text|word|letter/i.test(P)||/X$/.test(P)||"x"===P?"x":"y";switch(W){case"%":I*="x"===U?e.percentToPxWidth:e.percentToPxHeight;break;case"px":break;default:I*=e[W+"ToPx"]}switch($){case"%":I*=1/("x"===U?e.percentToPxWidth:e.percentToPxHeight);break;case"px":break;default:I*=1/e[$+"ToPx"]}}switch(H){case"+":O=I+O;break;case"-":O=I-O;break;case"*":O*=I;break;case"/":O=I/O}s[P]={rootPropertyValue:N,startValue:I,currentValue:I,endValue:O,unitType:$,easing:F},g.debug&&console.log("tweensContainer ("+P+"): "+JSON.stringify(s[P]),n)}else g.debug&&console.log("Skipping ["+z+"] due to a lack of browser support.");function j(e,t){var i,o;return o=(t||"0").toString().toLowerCase().replace(/[%A-z]+$/,function(e){return i=e,""}),i||(i=m.Values.getUnitType(e)),[o,i]}function q(){var e={myParent:n.parentNode||i.body,position:m.getPropertyValue(n,"position"),fontSize:m.getPropertyValue(n,"fontSize")},o=e.position===D.lastPosition&&e.myParent===D.lastParent,r=e.fontSize===D.lastFontSize;D.lastParent=e.myParent,D.lastPosition=e.position,D.lastFontSize=e.fontSize;var s={};if(r&&o)s.emToPx=D.lastEmToPx,s.percentToPxWidth=D.lastPercentToPxWidth,s.percentToPxHeight=D.lastPercentToPxHeight;else{var a=w(n).isSVG?i.createElementNS("http://www.w3.org/2000/svg","rect"):i.createElement("div");g.init(a),e.myParent.appendChild(a),c.each(["overflow","overflowX","overflowY"],function(e,t){g.CSS.setPropertyValue(a,t,"hidden")}),g.CSS.setPropertyValue(a,"position",e.position),g.CSS.setPropertyValue(a,"fontSize",e.fontSize),g.CSS.setPropertyValue(a,"boxSizing","content-box"),c.each(["minWidth","maxWidth","width","minHeight","maxHeight","height"],function(e,t){g.CSS.setPropertyValue(a,t,"100%")}),g.CSS.setPropertyValue(a,"paddingLeft","100em"),s.percentToPxWidth=D.lastPercentToPxWidth=(parseFloat(m.getPropertyValue(a,"width",null,!0))||1)/100,s.percentToPxHeight=D.lastPercentToPxHeight=(parseFloat(m.getPropertyValue(a,"height",null,!0))||1)/100,s.emToPx=D.lastEmToPx=(parseFloat(m.getPropertyValue(a,"paddingLeft"))||1)/100,e.myParent.removeChild(a)}return null===D.remToPx&&(D.remToPx=parseFloat(m.getPropertyValue(i.body,"fontSize"))||16),null===D.vwToPx&&(D.vwToPx=parseFloat(t.innerWidth)/100,D.vhToPx=parseFloat(t.innerHeight)/100),s.remToPx=D.remToPx,s.vwToPx=D.vwToPx,s.vhToPx=D.vhToPx,g.debug>=1&&console.log("Unit ratios: "+JSON.stringify(s),n),s}}s.element=n}s.element&&(m.Values.addClass(n,"velocity-animating"),R.push(s),""===r.queue&&(w(n).tweensContainer=s,w(n).opts=r),w(n).isAnimating=!0,y===v-1?(g.State.calls.push([R,a,r,null,T.resolver]),!1===g.State.isTicking&&(g.State.isTicking=!0,x())):y++)}!1!==g.mock&&(!0===g.mock?r.duration=r.delay=1:(r.duration*=parseFloat(g.mock)||1,r.delay*=parseFloat(g.mock)||1)),r.easing=b(r.easing,r.duration),r.begin&&!d.isFunction(r.begin)&&(r.begin=null),r.progress&&!d.isFunction(r.progress)&&(r.progress=null),r.complete&&!d.isFunction(r.complete)&&(r.complete=null),r.display!==o&&null!==r.display&&(r.display=r.display.toString().toLowerCase(),"auto"===r.display&&(r.display=g.CSS.Values.getDisplayType(n))),r.visibility!==o&&null!==r.visibility&&(r.visibility=r.visibility.toString().toLowerCase()),r.mobileHA=r.mobileHA&&g.State.isMobile&&!g.State.isGingerbread,!1===r.queue?r.delay?setTimeout(l,r.delay):l():c.queue(n,r.queue,function(e,t){if(!0===t)return T.promise&&T.resolver(a),!0;g.velocityQueueEntryFlag=!0,l()}),""!==r.queue&&"fx"!==r.queue||"inprogress"===c.queue(n)[0]||c.dequeue(n)}.call(n)}),(P=c.extend({},g.defaults,u)).loop=parseInt(P.loop),A=2*P.loop-1,P.loop)for(var O=0;O<A;O++){var F={delay:P.delay,progress:P.progress};O===A-1&&(F.display=P.display,F.visibility=P.visibility,F.complete=P.complete),_(a,"reverse",F)}return e()}};(g=c.extend(_,g)).animate=_;var v=t.requestAnimationFrame||a;return g.State.isMobile||i.hidden===o||i.addEventListener("visibilitychange",function(){i.hidden?(v=function(e){return setTimeout(function(){e(!0)},16)},x()):v=t.requestAnimationFrame||a}),e.Velocity=g,e!==t&&(e.fn.velocity=_,e.fn.velocity.defaults=g.defaults),c.each(["Down","Up"],function(e,t){g.Redirects["slide"+t]=function(e,i,n,r,s,a){var l=c.extend({},i),d=l.begin,h=l.complete,p={height:"",marginTop:"",marginBottom:"",paddingTop:"",paddingBottom:""},u={};l.display===o&&(l.display="Down"===t?"inline"===g.CSS.Values.getDisplayType(e)?"inline-block":"block":"none"),l.begin=function(){for(var i in d&&d.call(s,s),p){u[i]=e.style[i];var o=g.CSS.getPropertyValue(e,i);p[i]="Down"===t?[o,0]:[0,o]}u.overflow=e.style.overflow,e.style.overflow="hidden"},l.complete=function(){for(var t in u)e.style[t]=u[t];h&&h.call(s,s),a&&a.resolver(s)},g(e,p,l)}}),c.each(["In","Out"],function(e,t){g.Redirects["fade"+t]=function(e,i,n,r,s,a){var l=c.extend({},i),d={opacity:"In"===t?1:0},h=l.complete;l.complete=n!==r-1?l.begin=null:function(){h&&h.call(s,s),a&&a.resolver(s)},l.display===o&&(l.display="In"===t?"auto":"none"),g(this,d,l)}}),g}function w(e){var t=c.data(e,"velocity");return null===t?o:t}function y(e,i,o,n){var r=4,s=.001,a=1e-7,l=10,c=11,d=1/(c-1),h="Float32Array"in t;if(4!==arguments.length)return!1;for(var p=0;p<4;++p)if("number"!=typeof arguments[p]||isNaN(arguments[p])||!isFinite(arguments[p]))return!1;e=Math.min(e,1),o=Math.min(o,1),e=Math.max(e,0),o=Math.max(o,0);var u=h?new Float32Array(c):new Array(c);function g(e,t){return 1-3*t+3*e}function f(e,t){return 3*t-6*e}function m(e){return 3*e}function _(e,t,i){return((g(t,i)*e+f(t,i))*e+m(t))*e}function v(e,t,i){return 3*g(t,i)*e*e+2*f(t,i)*e+m(t)}function w(t){for(var i=0,n=1,h=c-1;n!=h&&u[n]<=t;++n)i+=d;var p=i+(t-u[--n])/(u[n+1]-u[n])*d,g=v(p,e,o);return g>=s?function(t,i){for(var n=0;n<r;++n){var s=v(i,e,o);if(0===s)return i;i-=(_(i,e,o)-t)/s}return i}(t,p):0==g?p:function(t,i,n){var r,s,c=0;do{(r=_(s=i+(n-i)/2,e,o)-t)>0?n=s:i=s}while(Math.abs(r)>a&&++c<l);return s}(t,i,i+d)}var y=!1;function b(){y=!0,e==i&&o==n||function(){for(var t=0;t<c;++t)u[t]=_(t*d,e,o)}()}var x=function(t){return y||b(),e===i&&o===n?t:0===t?0:1===t?1:_(w(t),i,n)};x.getControlPoints=function(){return[{x:e,y:i},{x:o,y:n}]};var k="generateBezier("+[e,i,o,n]+")";return x.toString=function(){return k},x}function b(e,t){var i=e;return d.isString(e)?g.Easings[e]||(i=!1):i=d.isArray(e)&&1===e.length?function(e){return function(t){return Math.round(t*e)*(1/e)}}.apply(null,e):d.isArray(e)&&2===e.length?f.apply(null,e.concat([t])):!(!d.isArray(e)||4!==e.length)&&y.apply(null,e),!1===i&&(i=g.Easings[g.defaults.easing]?g.defaults.easing:u),i}function x(e){if(e){var t=(new Date).getTime(),i=g.State.calls.length;i>1e4&&(g.State.calls=function(e){for(var t=-1,i=e?e.length:0,o=[];++t<i;){var n=e[t];n&&o.push(n)}return o}(g.State.calls));for(var n=0;n<i;n++)if(g.State.calls[n]){var r=g.State.calls[n],s=r[0],a=r[2],l=r[3],h=!!l,p=null;l||(l=g.State.calls[n][3]=t-16);for(var u=Math.min((t-l)/a.duration,1),f=0,_=s.length;f<_;f++){var y=s[f],b=y.element;if(w(b)){var C=!1;if(a.display!==o&&null!==a.display&&"none"!==a.display){if("flex"===a.display){c.each(["-webkit-box","-moz-box","-ms-flexbox","-webkit-flex"],function(e,t){m.setPropertyValue(b,"display",t)})}m.setPropertyValue(b,"display",a.display)}for(var S in a.visibility!==o&&"hidden"!==a.visibility&&m.setPropertyValue(b,"visibility",a.visibility),y)if("element"!==S){var T,V=y[S],B=d.isString(V.easing)?g.Easings[V.easing]:V.easing;if(1===u)T=V.endValue;else{var E=V.endValue-V.startValue;if(T=V.startValue+E*B(u,a,E),!h&&T===V.currentValue)continue}if(V.currentValue=T,"tween"===S)p=T;else{if(m.Hooks.registered[S]){var M=m.Hooks.getRoot(S),P=w(b).rootPropertyValueCache[M];P&&(V.rootPropertyValue=P)}var A=m.setPropertyValue(b,S,V.currentValue+(0===parseFloat(T)?"":V.unitType),V.rootPropertyValue,V.scrollData);m.Hooks.registered[S]&&(m.Normalizations.registered[M]?w(b).rootPropertyValueCache[M]=m.Normalizations.registered[M]("extract",null,A[1]):w(b).rootPropertyValueCache[M]=A[1]),"transform"===A[0]&&(C=!0)}}a.mobileHA&&w(b).transformCache.translate3d===o&&(w(b).transformCache.translate3d="(0px, 0px, 0px)",C=!0),C&&m.flushTransformCache(b)}}a.display!==o&&"none"!==a.display&&(g.State.calls[n][2].display=!1),a.visibility!==o&&"hidden"!==a.visibility&&(g.State.calls[n][2].visibility=!1),a.progress&&a.progress.call(r[1],r[1],u,Math.max(0,l+a.duration-t),l,p),1===u&&k(n)}}g.State.isTicking&&v(x)}function k(e,t){if(!g.State.calls[e])return!1;for(var i=g.State.calls[e][0],n=g.State.calls[e][1],r=g.State.calls[e][2],s=g.State.calls[e][4],a=!1,l=0,d=i.length;l<d;l++){var h=i[l].element;if(t||r.loop||("none"===r.display&&m.setPropertyValue(h,"display",r.display),"hidden"===r.visibility&&m.setPropertyValue(h,"visibility",r.visibility)),!0!==r.loop&&(c.queue(h)[1]===o||!/\.velocityQueueEntryFlag/i.test(c.queue(h)[1]))&&w(h)){w(h).isAnimating=!1,w(h).rootPropertyValueCache={};var p=!1;c.each(m.Lists.transforms3D,function(e,t){var i=/^scale/.test(t)?1:0,n=w(h).transformCache[t];w(h).transformCache[t]!==o&&new RegExp("^\\("+i+"[^.]").test(n)&&(p=!0,delete w(h).transformCache[t])}),r.mobileHA&&(p=!0,delete w(h).transformCache.translate3d),p&&m.flushTransformCache(h),m.Values.removeClass(h,"velocity-animating")}if(!t&&r.complete&&!r.loop&&l===d-1)try{r.complete.call(n,n)}catch(e){setTimeout(function(){throw e},1)}s&&!0!==r.loop&&s(n),w(h)&&!0===r.loop&&!t&&(c.each(w(h).tweensContainer,function(e,t){/^rotate/.test(e)&&360===parseFloat(t.endValue)&&(t.endValue=0,t.startValue=360),/^backgroundPosition/.test(e)&&100===parseFloat(t.endValue)&&"%"===t.unitType&&(t.endValue=0,t.startValue=100)}),g(h,"reverse",{loop:!0,delay:r.delay})),!1!==r.queue&&c.dequeue(h,r.queue)}g.State.calls[e]=!1;for(var u=0,f=g.State.calls.length;u<f;u++)if(!1!==g.State.calls[u]){a=!0;break}!1===a&&(g.State.isTicking=!1,delete g.State.calls,g.State.calls=[])}s.fn.velocity=s.fn.animate}(window.jQuery||window.Zepto||window,window,document)},"object"==typeof e.exports?e.exports=r():void 0===(n="function"==typeof(o=r)?o.call(t,i,t,e):o)||(e.exports=n)},508:function(e,t){e.exports=function(){throw new Error("define cannot be used indirect")}},509:function(e,t){(function(t){e.exports=t}).call(this,{})},510:function(e,t,i){var o,n,r;!function(s){"use strict";n=[i(4)],void 0===(r="function"==typeof(o=function(e,t){var i={beforeShow:d,move:d,change:d,show:d,hide:d,color:!1,flat:!1,showInput:!1,allowEmpty:!1,showButtons:!0,clickoutFiresChange:!0,showInitial:!1,showPalette:!1,showPaletteOnly:!1,hideAfterPaletteSelect:!1,togglePaletteOnly:!1,showSelectionPalette:!0,localStorageKey:!1,appendTo:"body",maxSelectionSize:7,cancelText:"cancel",chooseText:"choose",togglePaletteMoreText:"more",togglePaletteLessText:"less",clearText:"Clear Color Selection",noColorSelectedText:"No Color Selected",preferredFormat:!1,className:"",containerClassName:"",replacerClassName:"",showAlpha:!1,theme:"sp-light",palette:[["#ffffff","#000000","#ff0000","#ff8000","#ffff00","#008000","#0000ff","#4b0082","#9400d3"]],selectionPalette:[],disabled:!1,offset:null},o=[],n=!!/msie/i.exec(window.navigator.userAgent),r=function(){function e(e,t){return!!~(""+e).indexOf(t)}var t=document.createElement("div"),i=t.style;return i.cssText="background-color:rgba(0,0,0,.5)",e(i.backgroundColor,"rgba")||e(i.backgroundColor,"hsla")}(),s=["<div class='sp-replacer'>","<div class='sp-preview'><div class='sp-preview-inner'></div></div>","<div class='sp-dd'>&#9660;</div>","</div>"].join(""),a=function(){var e="";if(n)for(var t=1;t<=6;t++)e+="<div class='sp-"+t+"'></div>";return["<div class='sp-container sp-hidden'>","<div class='sp-palette-container'>","<div class='sp-palette sp-thumb sp-cf'></div>","<div class='sp-palette-button-container sp-cf'>","<button type='button' class='sp-palette-toggle'></button>","</div>","</div>","<div class='sp-picker-container'>","<div class='sp-top sp-cf'>","<div class='sp-fill'></div>","<div class='sp-top-inner'>","<div class='sp-color'>","<div class='sp-sat'>","<div class='sp-val'>","<div class='sp-dragger'></div>","</div>","</div>","</div>","<div class='sp-clear sp-clear-display'>","</div>","<div class='sp-hue'>","<div class='sp-slider'></div>",e,"</div>","</div>","<div class='sp-alpha'><div class='sp-alpha-inner'><div class='sp-alpha-handle'></div></div></div>","</div>","<div class='sp-input-container sp-cf'>","<input class='sp-input' type='text' spellcheck='false'  />","</div>","<div class='sp-initial sp-thumb sp-cf'></div>","<div class='sp-button-container sp-cf'>","<a class='sp-cancel' href='#'></a>","<button type='button' class='sp-choose'></button>","</div>","</div>","</div>"].join("")}();function l(t,i,o,n){for(var s=[],a=0;a<t.length;a++){var l=t[a];if(l){var c=tinycolor(l),d=c.toHsl().l<.5?"sp-thumb-el sp-thumb-dark":"sp-thumb-el sp-thumb-light";d+=tinycolor.equals(i,l)?" sp-thumb-active":"";var h=c.toString(n.preferredFormat||"rgb"),p=r?"background-color:"+c.toRgbString():"filter:"+c.toFilter();s.push('<span title="'+h+'" data-color="'+c.toRgbString()+'" class="'+d+'"><span class="sp-thumb-inner" style="'+p+';" /></span>')}else{s.push(e("<div />").append(e('<span data-color="" style="background-color:transparent;" class="sp-clear-display"></span>').attr("title",n.noColorSelectedText)).html())}}return"<div class='sp-cf "+o+"'>"+s.join("")+"</div>"}function c(c,d){var f,m,_,v,w=function(t,o){var n=e.extend({},i,t);return n.callbacks={move:p(n.move,o),change:p(n.change,o),show:p(n.show,o),hide:p(n.hide,o),beforeShow:p(n.beforeShow,o)},n}(d,c),y=w.flat,b=w.showSelectionPalette,x=w.localStorageKey,k=w.theme,C=w.callbacks,S=(f=He,m=10,function(){var e=this,t=arguments;_&&clearTimeout(v),!_&&v||(v=setTimeout(function(){v=null,f.apply(e,t)},m))}),T=!1,V=!1,B=0,E=0,M=0,P=0,A=0,D=0,R=0,O=0,F=0,I=0,z=1,N=[],L=[],$={},W=w.selectionPalette.slice(0),H=w.maxSelectionSize,U="sp-dragging",j=null,q=c.ownerDocument,Y=(q.body,e(c)),X=!1,J=e(a,q).addClass(k),G=J.find(".sp-picker-container"),K=J.find(".sp-color"),Q=J.find(".sp-dragger"),Z=J.find(".sp-hue"),ee=J.find(".sp-slider"),te=J.find(".sp-alpha-inner"),ie=J.find(".sp-alpha"),oe=J.find(".sp-alpha-handle"),ne=J.find(".sp-input"),re=J.find(".sp-palette"),se=J.find(".sp-initial"),ae=J.find(".sp-cancel"),le=J.find(".sp-clear"),ce=J.find(".sp-choose"),de=J.find(".sp-palette-toggle"),he=Y.is("input"),pe=he&&"color"===Y.attr("type")&&g(),ue=he&&!y,ge=ue?e(s).addClass(k).addClass(w.className).addClass(w.replacerClassName):e([]),fe=ue?ge:Y,me=ge.find(".sp-preview-inner"),_e=w.color||he&&Y.val(),ve=!1,we=w.preferredFormat,ye=!w.showButtons||w.clickoutFiresChange,be=!_e,xe=w.allowEmpty&&!pe;function ke(){if(w.showPaletteOnly&&(w.showPalette=!0),de.text(w.showPaletteOnly?w.togglePaletteMoreText:w.togglePaletteLessText),w.palette){N=w.palette.slice(0),L=e.isArray(N[0])?N:[N],$={};for(var t=0;t<L.length;t++)for(var i=0;i<L[t].length;i++){var o=tinycolor(L[t][i]).toRgbString();$[o]=!0}}J.toggleClass("sp-flat",y),J.toggleClass("sp-input-disabled",!w.showInput),J.toggleClass("sp-alpha-enabled",w.showAlpha),J.toggleClass("sp-clear-enabled",xe),J.toggleClass("sp-buttons-disabled",!w.showButtons),J.toggleClass("sp-palette-buttons-disabled",!w.togglePaletteOnly),J.toggleClass("sp-palette-disabled",!w.showPalette),J.toggleClass("sp-palette-only",w.showPaletteOnly),J.toggleClass("sp-initial-disabled",!w.showInitial),J.addClass(w.className).addClass(w.containerClassName),He()}function Ce(){if(x&&window.localStorage){try{var t=window.localStorage[x].split(",#");t.length>1&&(delete window.localStorage[x],e.each(t,function(e,t){Se(t)}))}catch(e){}try{W=window.localStorage[x].split(";")}catch(e){}}}function Se(t){if(b){var i=tinycolor(t).toRgbString();if(!$[i]&&-1===e.inArray(i,W))for(W.push(i);W.length>H;)W.shift();if(x&&window.localStorage)try{window.localStorage[x]=W.join(";")}catch(e){}}}function Te(){var t=ze(),i=e.map(L,function(e,i){return l(e,t,"sp-palette-row sp-palette-row-"+i,w)});Ce(),W&&i.push(l(function(){var e=[];if(w.showPalette)for(var t=0;t<W.length;t++){var i=tinycolor(W[t]).toRgbString();$[i]||e.push(W[t])}return e.reverse().slice(0,w.maxSelectionSize)}(),t,"sp-palette-row sp-palette-row-selection",w)),re.html(i.join(""))}function Ve(){if(w.showInitial){var e=ve,t=ze();se.html(l([e,t],t,"sp-palette-row-initial",w))}}function Be(){(E<=0||B<=0||P<=0)&&He(),V=!0,J.addClass(U),j=null,Y.trigger("dragstart.spectrum",[ze()])}function Ee(){V=!1,J.removeClass(U),Y.trigger("dragstop.spectrum",[ze()])}function Me(){var e=ne.val();if(null!==e&&""!==e||!xe){var t=tinycolor(e);t.isValid()?(Ie(t),We(!0)):ne.addClass("sp-validation-error")}else Ie(null),We(!0)}function Pe(){T?Oe():Ae()}function Ae(){var t=e.Event("beforeShow.spectrum");T?He():(Y.trigger(t,[ze()]),!1===C.beforeShow(ze())||t.isDefaultPrevented()||(!function(){for(var e=0;e<o.length;e++)o[e]&&o[e].hide()}(),T=!0,e(q).bind("keydown.spectrum",De),e(q).bind("click.spectrum",Re),e(window).bind("resize.spectrum",S),ge.addClass("sp-active"),J.removeClass("sp-hidden"),He(),Le(),ve=ze(),Ve(),C.show(ve),Y.trigger("show.spectrum",[ve])))}function De(e){27===e.keyCode&&Oe()}function Re(e){2!=e.button&&(V||(ye?We(!0):Fe(),Oe()))}function Oe(){T&&!y&&(T=!1,e(q).unbind("keydown.spectrum",De),e(q).unbind("click.spectrum",Re),e(window).unbind("resize.spectrum",S),ge.removeClass("sp-active"),J.addClass("sp-hidden"),C.hide(ze()),Y.trigger("hide.spectrum",[ze()]))}function Fe(){Ie(ve,!0)}function Ie(e,t){var i,o;tinycolor.equals(e,ze())?Le():(!e&&xe?be=!0:(be=!1,i=tinycolor(e),o=i.toHsv(),O=o.h%360/360,F=o.s,I=o.v,z=o.a),Le(),i&&i.isValid()&&!t&&(we=w.preferredFormat||i.getFormat()))}function ze(e){return e=e||{},xe&&be?null:tinycolor.fromRatio({h:O,s:F,v:I,a:Math.round(100*z)/100},{format:e.format||we})}function Ne(){Le(),C.move(ze()),Y.trigger("move.spectrum",[ze()])}function Le(){ne.removeClass("sp-validation-error"),$e();var e=tinycolor.fromRatio({h:O,s:1,v:1});K.css("background-color",e.toHexString());var t=we;z<1&&(0!==z||"name"!==t)&&("hex"!==t&&"hex3"!==t&&"hex6"!==t&&"name"!==t||(t="rgb"));var i=ze({format:t}),o="";if(me.removeClass("sp-clear-display"),me.css("background-color","transparent"),!i&&xe)me.addClass("sp-clear-display");else{var s=i.toHexString(),a=i.toRgbString();if(r||1===i.alpha?me.css("background-color",a):(me.css("background-color","transparent"),me.css("filter",i.toFilter())),w.showAlpha){var l=i.toRgb();l.a=0;var c=tinycolor(l).toRgbString(),d="linear-gradient(left, "+c+", "+s+")";n?te.css("filter",tinycolor(c).toFilter({gradientType:1},s)):(te.css("background","-webkit-"+d),te.css("background","-moz-"+d),te.css("background","-ms-"+d),te.css("background","linear-gradient(to right, "+c+", "+s+")"))}o=i.toString(t)}w.showInput&&ne.val(o),w.showPalette&&Te(),Ve()}function $e(){var e=F,t=I;if(xe&&be)oe.hide(),ee.hide(),Q.hide();else{oe.show(),ee.show(),Q.show();var i=e*B,o=E-t*E;i=Math.max(-M,Math.min(B-M,i-M)),o=Math.max(-M,Math.min(E-M,o-M)),Q.css({top:o+"px",left:i+"px"});var n=z*A;oe.css({left:n-D/2+"px"});var r=O*P;ee.css({top:r-R+"px"})}}function We(e){var t=ze(),i="",o=!tinycolor.equals(t,ve);t&&(i=t.toString(we),Se(t)),he&&Y.val(i),e&&o&&(C.change(t),Y.trigger("change",[t]))}function He(){var t,i,o,n,r,s,a,l,c,d;T&&(B=K.width(),E=K.height(),M=Q.height(),Z.width(),P=Z.height(),R=ee.height(),A=ie.width(),D=oe.width(),y||(J.css("position","absolute"),w.offset?J.offset(w.offset):J.offset((i=fe,o=(t=J).outerWidth(),n=t.outerHeight(),r=i.outerHeight(),s=t[0].ownerDocument,a=s.documentElement,l=a.clientWidth+e(s).scrollLeft(),c=a.clientHeight+e(s).scrollTop(),(d=i.offset()).top+=r,d.left-=Math.min(d.left,d.left+o>l&&l>o?Math.abs(d.left+o-l):0),d.top-=Math.min(d.top,d.top+n>c&&c>n?Math.abs(n+r-0):0),d))),$e(),w.showPalette&&Te(),Y.trigger("reflow.spectrum"))}function Ue(){Oe(),X=!0,Y.attr("disabled",!0),fe.addClass("sp-disabled")}!function(){n&&J.find("*:not(input)").attr("unselectable","on");ke(),ue&&Y.after(ge).hide();xe||le.hide();if(y)Y.after(J).hide();else{var t="parent"===w.appendTo?Y.parent():e(w.appendTo);1!==t.length&&(t=e("body")),t.append(J)}Ce(),fe.bind("click.spectrum touchstart.spectrum",function(t){X||Pe(),t.stopPropagation(),e(t.target).is("input")||t.preventDefault()}),(Y.is(":disabled")||!0===w.disabled)&&Ue();J.click(h),ne.change(Me),ne.bind("paste",function(){setTimeout(Me,1)}),ne.keydown(function(e){13==e.keyCode&&Me()}),ae.text(w.cancelText),ae.bind("click.spectrum",function(e){e.stopPropagation(),e.preventDefault(),Fe(),Oe()}),le.attr("title",w.clearText),le.bind("click.spectrum",function(e){e.stopPropagation(),e.preventDefault(),be=!0,Ne(),y&&We(!0)}),ce.text(w.chooseText),ce.bind("click.spectrum",function(e){e.stopPropagation(),e.preventDefault(),n&&ne.is(":focus")&&ne.trigger("change"),ne.hasClass("sp-validation-error")||(We(!0),Oe())}),de.text(w.showPaletteOnly?w.togglePaletteMoreText:w.togglePaletteLessText),de.bind("click.spectrum",function(e){e.stopPropagation(),e.preventDefault(),w.showPaletteOnly=!w.showPaletteOnly,w.showPaletteOnly||y||J.css("left","-="+(G.outerWidth(!0)+5)),ke()}),u(ie,function(e,t,i){z=e/A,be=!1,i.shiftKey&&(z=Math.round(10*z)/10),Ne()},Be,Ee),u(Z,function(e,t){O=parseFloat(t/P),be=!1,w.showAlpha||(z=1),Ne()},Be,Ee),u(K,function(e,t,i){if(i.shiftKey){if(!j){var o=F*B,n=E-I*E,r=Math.abs(e-o)>Math.abs(t-n);j=r?"x":"y"}}else j=null;var s=!j||"y"===j;(!j||"x"===j)&&(F=parseFloat(e/B)),s&&(I=parseFloat((E-t)/E)),be=!1,w.showAlpha||(z=1),Ne()},Be,Ee),_e?(Ie(_e),Le(),we=w.preferredFormat||tinycolor(_e).format,Se(_e)):Le();y&&Ae();function i(t){return t.data&&t.data.ignore?(Ie(e(t.target).closest(".sp-thumb-el").data("color")),Ne()):(Ie(e(t.target).closest(".sp-thumb-el").data("color")),Ne(),We(!0),w.hideAfterPaletteSelect&&Oe()),!1}var o=n?"mousedown.spectrum":"click.spectrum touchstart.spectrum";re.delegate(".sp-thumb-el",o,i),se.delegate(".sp-thumb-el:nth-child(1)",o,{ignore:!0},i)}();var je={show:Ae,hide:Oe,toggle:Pe,reflow:He,option:function(i,o){if(i===t)return e.extend({},w);if(o===t)return w[i];w[i]=o,"preferredFormat"===i&&(we=w.preferredFormat);ke()},enable:function(){X=!1,Y.attr("disabled",!1),fe.removeClass("sp-disabled")},disable:Ue,offset:function(e){w.offset=e,He()},set:function(e){Ie(e),We()},get:ze,destroy:function(){Y.show(),fe.unbind("click.spectrum touchstart.spectrum"),J.remove(),ge.remove(),o[je.id]=null},container:J};return je.id=o.push(je)-1,je}function d(){}function h(e){e.stopPropagation()}function p(e,t){var i=Array.prototype.slice,o=i.call(arguments,2);return function(){return e.apply(t,o.concat(i.call(arguments)))}}function u(t,i,o,r){i=i||function(){},o=o||function(){},r=r||function(){};var s=document,a=!1,l={},c=0,d=0,h="ontouchstart"in window,p={};function u(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault(),e.returnValue=!1}function g(e){if(a){if(n&&s.documentMode<9&&!e.button)return f();var o=e.originalEvent&&e.originalEvent.touches&&e.originalEvent.touches[0],r=o&&o.pageX||e.pageX,p=o&&o.pageY||e.pageY,g=Math.max(0,Math.min(r-l.left,d)),m=Math.max(0,Math.min(p-l.top,c));h&&u(e),i.apply(t,[g,m,e])}}function f(){a&&(e(s).unbind(p),e(s.body).removeClass("sp-dragging"),setTimeout(function(){r.apply(t,arguments)},0)),a=!1}p.selectstart=u,p.dragstart=u,p["touchmove mousemove"]=g,p["touchend mouseup"]=f,e(t).bind("touchstart mousedown",function(i){(i.which?3==i.which:2==i.button)||a||!1!==o.apply(t,arguments)&&(a=!0,c=e(t).height(),d=e(t).width(),l=e(t).offset(),e(s).bind(p),e(s.body).addClass("sp-dragging"),g(i),u(i))})}function g(){return e.fn.spectrum.inputTypeColorSupport()}e.fn.spectrum=function(t,i){if("string"==typeof t){var n=this,r=Array.prototype.slice.call(arguments,1);return this.each(function(){var i=o[e(this).data("spectrum.id")];if(i){var s=i[t];if(!s)throw new Error("Spectrum: no such method: '"+t+"'");"get"==t?n=i.get():"container"==t?n=i.container:"option"==t?n=i.option.apply(i,r):"destroy"==t?(i.destroy(),e(this).removeData("spectrum.id")):s.apply(i,r)}}),n}return this.spectrum("destroy").each(function(){var i=e.extend({},t,e(this).data()),o=c(this,i);e(this).data("spectrum.id",o.id)})},e.fn.spectrum.load=!0,e.fn.spectrum.loadOpts={},e.fn.spectrum.draggable=u,e.fn.spectrum.defaults=i,e.fn.spectrum.inputTypeColorSupport=function t(){if(void 0===t._cachedResult){var i=e("<input type='color'/>")[0];t._cachedResult="color"===i.type&&""!==i.value}return t._cachedResult},e.spectrum={},e.spectrum.localization={},e.spectrum.palettes={},e.fn.spectrum.processNativeColorInputs=function(){var t=e("input[type=color]");t.length&&!g()&&t.spectrum({preferredFormat:"hex6"})},function(){var e=/^[\s,#]+/,t=/\s+$/,i=0,o=Math,n=o.round,r=o.min,s=o.max,a=o.random,l=function(a,c){if(c=c||{},(a=a||"")instanceof l)return a;if(!(this instanceof l))return new l(a,c);var d=function(i){var n={r:0,g:0,b:0},a=1,l=!1,c=!1;"string"==typeof i&&(i=function(i){i=i.replace(e,"").replace(t,"").toLowerCase();var o,n=!1;if(T[i])i=T[i],n=!0;else if("transparent"==i)return{r:0,g:0,b:0,a:0,format:"name"};if(o=I.rgb.exec(i))return{r:o[1],g:o[2],b:o[3]};if(o=I.rgba.exec(i))return{r:o[1],g:o[2],b:o[3],a:o[4]};if(o=I.hsl.exec(i))return{h:o[1],s:o[2],l:o[3]};if(o=I.hsla.exec(i))return{h:o[1],s:o[2],l:o[3],a:o[4]};if(o=I.hsv.exec(i))return{h:o[1],s:o[2],v:o[3]};if(o=I.hsva.exec(i))return{h:o[1],s:o[2],v:o[3],a:o[4]};if(o=I.hex8.exec(i))return{a:(r=o[1],P(r)/255),r:P(o[2]),g:P(o[3]),b:P(o[4]),format:n?"name":"hex8"};var r;if(o=I.hex6.exec(i))return{r:P(o[1]),g:P(o[2]),b:P(o[3]),format:n?"name":"hex"};if(o=I.hex3.exec(i))return{r:P(o[1]+""+o[1]),g:P(o[2]+""+o[2]),b:P(o[3]+""+o[3]),format:n?"name":"hex"};return!1}(i));"object"==typeof i&&(i.hasOwnProperty("r")&&i.hasOwnProperty("g")&&i.hasOwnProperty("b")?(d=i.r,h=i.g,p=i.b,n={r:255*E(d,255),g:255*E(h,255),b:255*E(p,255)},l=!0,c="%"===String(i.r).substr(-1)?"prgb":"rgb"):i.hasOwnProperty("h")&&i.hasOwnProperty("s")&&i.hasOwnProperty("v")?(i.s=D(i.s),i.v=D(i.v),n=function(e,t,i){e=6*E(e,360),t=E(t,100),i=E(i,100);var n=o.floor(e),r=e-n,s=i*(1-t),a=i*(1-r*t),l=i*(1-(1-r)*t),c=n%6;return{r:255*[i,a,s,s,l,i][c],g:255*[l,i,i,a,s,s][c],b:255*[s,s,l,i,i,a][c]}}(i.h,i.s,i.v),l=!0,c="hsv"):i.hasOwnProperty("h")&&i.hasOwnProperty("s")&&i.hasOwnProperty("l")&&(i.s=D(i.s),i.l=D(i.l),n=function(e,t,i){var o,n,r;function s(e,t,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?e+6*(t-e)*i:i<.5?t:i<2/3?e+(t-e)*(2/3-i)*6:e}if(e=E(e,360),t=E(t,100),i=E(i,100),0===t)o=n=r=i;else{var a=i<.5?i*(1+t):i+t-i*t,l=2*i-a;o=s(l,a,e+1/3),n=s(l,a,e),r=s(l,a,e-1/3)}return{r:255*o,g:255*n,b:255*r}}(i.h,i.s,i.l),l=!0,c="hsl"),i.hasOwnProperty("a")&&(a=i.a));var d,h,p;return a=B(a),{ok:l,format:i.format||c,r:r(255,s(n.r,0)),g:r(255,s(n.g,0)),b:r(255,s(n.b,0)),a:a}}(a);this._originalInput=a,this._r=d.r,this._g=d.g,this._b=d.b,this._a=d.a,this._roundA=n(100*this._a)/100,this._format=c.format||d.format,this._gradientType=c.gradientType,this._r<1&&(this._r=n(this._r)),this._g<1&&(this._g=n(this._g)),this._b<1&&(this._b=n(this._b)),this._ok=d.ok,this._tc_id=i++};function c(e,t,i){e=E(e,255),t=E(t,255),i=E(i,255);var o,n,a=s(e,t,i),l=r(e,t,i),c=(a+l)/2;if(a==l)o=n=0;else{var d=a-l;switch(n=c>.5?d/(2-a-l):d/(a+l),a){case e:o=(t-i)/d+(t<i?6:0);break;case t:o=(i-e)/d+2;break;case i:o=(e-t)/d+4}o/=6}return{h:o,s:n,l:c}}function d(e,t,i){e=E(e,255),t=E(t,255),i=E(i,255);var o,n,a=s(e,t,i),l=r(e,t,i),c=a,d=a-l;if(n=0===a?0:d/a,a==l)o=0;else{switch(a){case e:o=(t-i)/d+(t<i?6:0);break;case t:o=(i-e)/d+2;break;case i:o=(e-t)/d+4}o/=6}return{h:o,s:n,v:c}}function h(e,t,i,o){var r=[A(n(e).toString(16)),A(n(t).toString(16)),A(n(i).toString(16))];return o&&r[0].charAt(0)==r[0].charAt(1)&&r[1].charAt(0)==r[1].charAt(1)&&r[2].charAt(0)==r[2].charAt(1)?r[0].charAt(0)+r[1].charAt(0)+r[2].charAt(0):r.join("")}function p(e,t,i,o){var r,s=[A((r=o,Math.round(255*parseFloat(r)).toString(16))),A(n(e).toString(16)),A(n(t).toString(16)),A(n(i).toString(16))];return s.join("")}function u(e,t){t=0===t?0:t||10;var i=l(e).toHsl();return i.s-=t/100,i.s=M(i.s),l(i)}function g(e,t){t=0===t?0:t||10;var i=l(e).toHsl();return i.s+=t/100,i.s=M(i.s),l(i)}function f(e){return l(e).desaturate(100)}function m(e,t){t=0===t?0:t||10;var i=l(e).toHsl();return i.l+=t/100,i.l=M(i.l),l(i)}function _(e,t){t=0===t?0:t||10;var i=l(e).toRgb();return i.r=s(0,r(255,i.r-n(-t/100*255))),i.g=s(0,r(255,i.g-n(-t/100*255))),i.b=s(0,r(255,i.b-n(-t/100*255))),l(i)}function v(e,t){t=0===t?0:t||10;var i=l(e).toHsl();return i.l-=t/100,i.l=M(i.l),l(i)}function w(e,t){var i=l(e).toHsl(),o=(n(i.h)+t)%360;return i.h=o<0?360+o:o,l(i)}function y(e){var t=l(e).toHsl();return t.h=(t.h+180)%360,l(t)}function b(e){var t=l(e).toHsl(),i=t.h;return[l(e),l({h:(i+120)%360,s:t.s,l:t.l}),l({h:(i+240)%360,s:t.s,l:t.l})]}function x(e){var t=l(e).toHsl(),i=t.h;return[l(e),l({h:(i+90)%360,s:t.s,l:t.l}),l({h:(i+180)%360,s:t.s,l:t.l}),l({h:(i+270)%360,s:t.s,l:t.l})]}function k(e){var t=l(e).toHsl(),i=t.h;return[l(e),l({h:(i+72)%360,s:t.s,l:t.l}),l({h:(i+216)%360,s:t.s,l:t.l})]}function C(e,t,i){t=t||6,i=i||30;var o=l(e).toHsl(),n=360/i,r=[l(e)];for(o.h=(o.h-(n*t>>1)+720)%360;--t;)o.h=(o.h+n)%360,r.push(l(o));return r}function S(e,t){t=t||6;for(var i=l(e).toHsv(),o=i.h,n=i.s,r=i.v,s=[],a=1/t;t--;)s.push(l({h:o,s:n,v:r})),r=(r+a)%1;return s}l.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var e=this.toRgb();return(299*e.r+587*e.g+114*e.b)/1e3},setAlpha:function(e){return this._a=B(e),this._roundA=n(100*this._a)/100,this},toHsv:function(){var e=d(this._r,this._g,this._b);return{h:360*e.h,s:e.s,v:e.v,a:this._a}},toHsvString:function(){var e=d(this._r,this._g,this._b),t=n(360*e.h),i=n(100*e.s),o=n(100*e.v);return 1==this._a?"hsv("+t+", "+i+"%, "+o+"%)":"hsva("+t+", "+i+"%, "+o+"%, "+this._roundA+")"},toHsl:function(){var e=c(this._r,this._g,this._b);return{h:360*e.h,s:e.s,l:e.l,a:this._a}},toHslString:function(){var e=c(this._r,this._g,this._b),t=n(360*e.h),i=n(100*e.s),o=n(100*e.l);return 1==this._a?"hsl("+t+", "+i+"%, "+o+"%)":"hsla("+t+", "+i+"%, "+o+"%, "+this._roundA+")"},toHex:function(e){return h(this._r,this._g,this._b,e)},toHexString:function(e){return"#"+this.toHex(e)},toHex8:function(){return p(this._r,this._g,this._b,this._a)},toHex8String:function(){return"#"+this.toHex8()},toRgb:function(){return{r:n(this._r),g:n(this._g),b:n(this._b),a:this._a}},toRgbString:function(){return 1==this._a?"rgb("+n(this._r)+", "+n(this._g)+", "+n(this._b)+")":"rgba("+n(this._r)+", "+n(this._g)+", "+n(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:n(100*E(this._r,255))+"%",g:n(100*E(this._g,255))+"%",b:n(100*E(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return 1==this._a?"rgb("+n(100*E(this._r,255))+"%, "+n(100*E(this._g,255))+"%, "+n(100*E(this._b,255))+"%)":"rgba("+n(100*E(this._r,255))+"%, "+n(100*E(this._g,255))+"%, "+n(100*E(this._b,255))+"%, "+this._roundA+")"},toName:function(){return 0===this._a?"transparent":!(this._a<1)&&(V[h(this._r,this._g,this._b,!0)]||!1)},toFilter:function(e){var t="#"+p(this._r,this._g,this._b,this._a),i=t,o=this._gradientType?"GradientType = 1, ":"";if(e){var n=l(e);i=n.toHex8String()}return"progid:DXImageTransform.Microsoft.gradient("+o+"startColorstr="+t+",endColorstr="+i+")"},toString:function(e){var t=!!e;e=e||this._format;var i=!1,o=this._a<1&&this._a>=0,n=!t&&o&&("hex"===e||"hex6"===e||"hex3"===e||"name"===e);return n?"name"===e&&0===this._a?this.toName():this.toRgbString():("rgb"===e&&(i=this.toRgbString()),"prgb"===e&&(i=this.toPercentageRgbString()),"hex"!==e&&"hex6"!==e||(i=this.toHexString()),"hex3"===e&&(i=this.toHexString(!0)),"hex8"===e&&(i=this.toHex8String()),"name"===e&&(i=this.toName()),"hsl"===e&&(i=this.toHslString()),"hsv"===e&&(i=this.toHsvString()),i||this.toHexString())},_applyModification:function(e,t){var i=e.apply(null,[this].concat([].slice.call(t)));return this._r=i._r,this._g=i._g,this._b=i._b,this.setAlpha(i._a),this},lighten:function(){return this._applyModification(m,arguments)},brighten:function(){return this._applyModification(_,arguments)},darken:function(){return this._applyModification(v,arguments)},desaturate:function(){return this._applyModification(u,arguments)},saturate:function(){return this._applyModification(g,arguments)},greyscale:function(){return this._applyModification(f,arguments)},spin:function(){return this._applyModification(w,arguments)},_applyCombination:function(e,t){return e.apply(null,[this].concat([].slice.call(t)))},analogous:function(){return this._applyCombination(C,arguments)},complement:function(){return this._applyCombination(y,arguments)},monochromatic:function(){return this._applyCombination(S,arguments)},splitcomplement:function(){return this._applyCombination(k,arguments)},triad:function(){return this._applyCombination(b,arguments)},tetrad:function(){return this._applyCombination(x,arguments)}},l.fromRatio=function(e,t){if("object"==typeof e){var i={};for(var o in e)e.hasOwnProperty(o)&&(i[o]="a"===o?e[o]:D(e[o]));e=i}return l(e,t)},l.equals=function(e,t){return!(!e||!t)&&l(e).toRgbString()==l(t).toRgbString()},l.random=function(){return l.fromRatio({r:a(),g:a(),b:a()})},l.mix=function(e,t,i){i=0===i?0:i||50;var o,n=l(e).toRgb(),r=l(t).toRgb(),s=i/100,a=2*s-1,c=r.a-n.a,d=1-(o=((o=a*c==-1?a:(a+c)/(1+a*c))+1)/2),h={r:r.r*o+n.r*d,g:r.g*o+n.g*d,b:r.b*o+n.b*d,a:r.a*s+n.a*(1-s)};return l(h)},l.readability=function(e,t){var i=l(e),o=l(t),n=i.toRgb(),r=o.toRgb(),s=i.getBrightness(),a=o.getBrightness(),c=Math.max(n.r,r.r)-Math.min(n.r,r.r)+Math.max(n.g,r.g)-Math.min(n.g,r.g)+Math.max(n.b,r.b)-Math.min(n.b,r.b);return{brightness:Math.abs(s-a),color:c}},l.isReadable=function(e,t){var i=l.readability(e,t);return i.brightness>125&&i.color>500},l.mostReadable=function(e,t){for(var i=null,o=0,n=!1,r=0;r<t.length;r++){var s=l.readability(e,t[r]),a=s.brightness>125&&s.color>500,c=s.brightness/125*3+s.color/500;(a&&!n||a&&n&&c>o||!a&&!n&&c>o)&&(n=a,o=c,i=l(t[r]))}return i};var T=l.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},V=l.hexNames=function(e){var t={};for(var i in e)e.hasOwnProperty(i)&&(t[e[i]]=i);return t}(T);function B(e){return e=parseFloat(e),(isNaN(e)||e<0||e>1)&&(e=1),e}function E(e,t){(function(e){return"string"==typeof e&&-1!=e.indexOf(".")&&1===parseFloat(e)})(e)&&(e="100%");var i=function(e){return"string"==typeof e&&-1!=e.indexOf("%")}(e);return e=r(t,s(0,parseFloat(e))),i&&(e=parseInt(e*t,10)/100),o.abs(e-t)<1e-6?1:e%t/parseFloat(t)}function M(e){return r(1,s(0,e))}function P(e){return parseInt(e,16)}function A(e){return 1==e.length?"0"+e:""+e}function D(e){return e<=1&&(e=100*e+"%"),e}var R,O,F,I=(O="[\\s|\\(]+("+(R="(?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?)")+")[,|\\s]+("+R+")[,|\\s]+("+R+")\\s*\\)?",F="[\\s|\\(]+("+R+")[,|\\s]+("+R+")[,|\\s]+("+R+")[,|\\s]+("+R+")\\s*\\)?",{rgb:new RegExp("rgb"+O),rgba:new RegExp("rgba"+F),hsl:new RegExp("hsl"+O),hsla:new RegExp("hsla"+F),hsv:new RegExp("hsv"+O),hsva:new RegExp("hsva"+F),hex3:/^([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex8:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/});window.tinycolor=l}(),e(function(){e.fn.spectrum.load&&e.fn.spectrum.processNativeColorInputs()})})?o.apply(t,n):o)||(e.exports=r)}()},511:function(e,t,i){i(512),e.exports=i(19).parseFloat},512:function(e,t,i){var o=i(26),n=i(513);o(o.G+o.F*(parseFloat!=n),{parseFloat:n})},513:function(e,t,i){var o=i(25).parseFloat,n=i(257).trim;e.exports=1/o(i(96)+"-0")!=-1/0?function(e){var t=n(String(e),3),i=o(t);return 0===i&&"-"==t.charAt(0)?-0:i}:o},515:function(e,t,i){"use strict";i.r(t);i(506),i(507);var o=i(104),n=i.n(o),r=i(21),s=i.n(r),a=i(44),l=i.n(a),c=i(1),d=i(0),h=i.n(d),p=i(23),u=i.n(p),g=i(5),f=i.n(g),m=function(){window.config.dragDemoUrlSettings||f()(window.config.installedAt).isBefore(f()().subtract(7,"days"))||c.a.Modal.popup({title:c.a.I18n.t("tutorialVideoTitle"),template:'<div class="mailpoet_drag_and_drop_tutorial"><video style="height:640px;" src="'.concat(window.config.dragDemoUrl,'" controls autoplay></video></div>'),onCancel:function(){c.a.Ajax.post({api_version:window.mailpoet_api_version,endpoint:"user_flags",action:"set",data:{editor_tutorial_seen:1}})}})};s.a.addAction("mailpoet_newsletters_editor_initialize","mailpoet",function(e){var t;document.getElementById("mailpoet_editor")&&window.EditorApplication&&(c.a.Modal.loading(!0),c.a.Ajax.post({api_version:window.mailpoet_api_version,endpoint:"newsletters",action:"get",data:{id:(t="id",(document.location.search.split("".concat(t,"="))[1]||"").split("&")[0])}}).always(function(){return c.a.Modal.loading(!1)}).always(function(){return m()}).done(function(t){var i,o,r,a=t.data;n.a.resolve(s.a.applyFilters("mailpoet_newsletters_editor_extend_config",e,a)).then(function(e){window.EditorApplication.start({newsletter:a,config:e})}).catch(function(){window.EditorApplication.start({newsletter:a,config:e})}),i=a.type,o=document.getElementById("mailpoet_editor_breadcrumb"),r=s.a.applyFilters("mailpoet_newsletters_editor_breadcrumb",h.a.createElement(l.a,{step:"editor"}),i,"editor"),u.a.render(r,o),"sending"===a.status&&a.queue&&null===a.queue.status&&c.a.Ajax.post({api_version:window.mailpoet_api_version,endpoint:"sending_queue",action:"pause",data:{newsletter_id:a.id}}).done(function(){return c.a.Notice.success(c.a.I18n.t("newsletterIsPaused"))}).fail(function(e){e.errors.length>0&&c.a.Notice.error(e.errors.map(function(e){return e.message}),{scroll:!0,static:!0})})}).fail(function(e){e.errors.length>0&&c.a.Notice.error(e.errors.map(function(e){return e.message}),{scroll:!0,static:!0})}))});var _=i(13),v=i.n(_),w=i(93),y=i.n(w),b=i(4),x=i.n(b),k=y.a,C=v.a.View.extend({el:"#mailpoet_editor",regions:{stylesRegion:"#mailpoet_editor_styles",contentRegion:"#mailpoet_editor_content",sidebarRegion:"#mailpoet_editor_sidebar",bottomRegion:"#mailpoet_editor_bottom",headingRegion:"#mailpoet_editor_heading",historyRegion:"#mailpoet_editor_history",topRegion:"#mailpoet_editor_top"},events:{click:"onClickOutsideContentHideSettings"},onClickOutsideContentHideSettings:function(e){x()(e.target).parents("#mailpoet_editor_content").length||window.EditorApplication.getChannel().trigger("hideSettings")}}),S=new(v.a.Application.extend({region:"#mailpoet_editor",onStart:function(){this._appView=new C,this.showView(this._appView),this.listenTo(this.getChannel(),"settingsDisplayed",this.setDisplayedSettingsId)},getChannel:function(e){return void 0===e?k.channel("global"):k.channel(e)},getDisplayedSettingsId:function(){return this.displayedSettingsId},setDisplayedSettingsId:function(e){this.displayedSettingsId=e}}));window.EditorApplication=S;var T=S,V=i(32),B=i.n(V),E=i(3),M=i.n(E),P={};P.ConfigModel=B.a.extend({defaults:{availableStyles:{},socialIcons:{},blockDefaults:{},sidepanelWidth:"331px",validation:{},urls:{}}}),P._config={},P.getConfig=function(){return P._config},P.setConfig=function(e){return P._config=new P.ConfigModel(e,{parse:!0}),P._config},T.on("before:start",function(e,t){var i=e,o=M.a.clone(t.config);i.getConfig=P.getConfig,i.setConfig=P.setConfig,o.blockDefaults=M.a.extend(o.blockDefaults,t.newsletter.body.blockDefaults||{}),i.setConfig(o)});var A={};A.StylesModel=B.a.extend({defaults:{text:{fontColor:"#000000",fontFamily:"Arial",fontSize:"16px",lineHeight:"1.6"},h1:{fontColor:"#111111",fontFamily:"Arial",fontSize:"40px",lineHeight:"1.6"},h2:{fontColor:"#222222",fontFamily:"Tahoma",fontSize:"32px",lineHeight:"1.6"},h3:{fontColor:"#333333",fontFamily:"Verdana",fontSize:"24px",lineHeight:"1.6"},link:{fontColor:"#21759B",textDecoration:"underline"},wrapper:{backgroundColor:"#ffffff"},body:{backgroundColor:"#cccccc"}},initialize:function(e){this.set(x.a.extend(!0,{},this.defaults,e)),this.on("change",function(){T.getChannel().trigger("autoSave")}),T.getChannel().on("historyUpdate",this.onHistoryUpdate,this)},onHistoryUpdate:function(e){this.set(e.globalStyles)}}),A.StylesView=v.a.View.extend({getTemplate:function(){return window.templates.styles},modelEvents:{change:"render"},serializeData:function(){return this.model.toJSON()}}),A._globalStyles=new B.a,A.getGlobalStyles=function(){return A._globalStyles},A.setGlobalStyles=function(e){return A._globalStyles=new A.StylesModel(e),A._globalStyles},A.getAvailableStyles=function(){return T.getConfig().get("availableStyles")},T.on("before:start",function(e,t){var i,o,n=e;n.getGlobalStyles=A.getGlobalStyles,n.setGlobalStyles=A.setGlobalStyles,n.getAvailableStyles=A.getAvailableStyles,i=t.newsletter.body,o=M.a.has(i,"globalStyles")?i.globalStyles:{},this.setGlobalStyles(o)}),T.on("start",function(e){var t=new A.StylesView({model:e.getGlobalStyles()});e._appView.showChildView("stylesRegion",t)});var D=i(20),R=i.n(D),O=(i(258),{_query:function(e){return c.a.Ajax.post({api_version:window.mailpoet_api_version,endpoint:"automatedLatestContent",action:e.action,data:e.options||{}})}});O._cachedQuery=M.a.memoize(O._query,R.a),O.getNewsletter=function(e){return O._query({action:"get",options:e})},O.getPostTypes=function(){return O._cachedQuery({action:"getPostTypes",options:{}}).then(function(e){return M.a.values(e.data)})},O.getTaxonomies=function(e){return O._cachedQuery({action:"getTaxonomies",options:{postType:e}}).then(function(e){return e.data})},O.getTerms=function(e){return O._cachedQuery({action:"getTerms",options:e}).then(function(e){return e.data})},O.getPosts=function(e){return O._cachedQuery({action:"getPosts",options:e}).then(function(e){return e.data})},O.getTransformedPosts=function(e){return O._cachedQuery({action:"getTransformedPosts",options:e}).then(function(e){return e.data})},O.getBulkTransformedPosts=function(e){return O._query({action:"getBulkTransformedPosts",options:e}).then(function(e){return e.data})},O.saveNewsletter=function(e){return c.a.Ajax.post({api_version:window.mailpoet_api_version,endpoint:"newsletters",action:"save",data:e||{}})},O.previewNewsletter=function(e){return c.a.Ajax.post({api_version:window.mailpoet_api_version,endpoint:"newsletters",action:"sendPreview",data:e||{}})},T.on("start",function(){O.getPostTypes()});var F,I=O,z=i(34),N=i.n(z),L={};L._contentWidgets=new(N.a.Collection.extend({model:B.a.extend({defaults:{name:"",priority:100,widgetView:void 0}}),comparator:"priority"})),L.registerWidget=function(e){return L._contentWidgets.add(e)},L.getWidgets=function(){return L._contentWidgets},L._layoutWidgets=new(N.a.Collection.extend({model:B.a.extend({defaults:{name:"",priority:100,widgetView:void 0}}),comparator:"priority"})),L.registerLayoutWidget=function(e){return L._layoutWidgets.add(e)},L.getLayoutWidgets=function(){return L._layoutWidgets},F=v.a.View.extend({getTemplate:function(){return window.templates.sidebar},regions:{contentRegion:".mailpoet_content_region",layoutRegion:".mailpoet_layout_region",stylesRegion:".mailpoet_styles_region",previewRegion:".mailpoet_preview_region"},events:{"click .mailpoet_sidebar_region h3, .mailpoet_sidebar_region .handlediv":function(e){var t=this.$el.find(".mailpoet_sidebar_region:not(.closed)"),i=this.$el.find(e.target).closest(".mailpoet_sidebar_region");t.find(".mailpoet_region_content").velocity("slideUp",{duration:250,easing:"easeOut",complete:function(){t.addClass("closed")}}),t.get(0)!==i.get(0)&&i.find(".mailpoet_region_content").velocity("slideDown",{duration:250,easing:"easeIn",complete:function(){i.removeClass("closed")}})}},initialize:function(){x()(window).on("resize",this.updateHorizontalScroll.bind(this)).on("scroll",this.updateHorizontalScroll.bind(this))},onRender:function(){this.showChildView("contentRegion",new L.SidebarWidgetsView(T.getWidgets())),this.showChildView("layoutRegion",new L.SidebarLayoutWidgetsView(T.getLayoutWidgets())),this.showChildView("stylesRegion",new L.SidebarStylesView({model:T.getGlobalStyles(),availableStyles:T.getAvailableStyles()})),this.showChildView("previewRegion",new L.SidebarPreviewView)},updateHorizontalScroll:function(){this.$el.parent().each(function(){var e,t=x()(this);"fixed"===t.css("position")?(e=t.parent().offset().left-x()(window).scrollLeft(),t.css("left",e+"px")):t.css("left","")})},onDomRefresh:function(){this.$el.parent().stick_in_parent({offset_top:32}),this.$el.parent().on("sticky_kit:stick",this.updateHorizontalScroll.bind(this)),this.$el.parent().on("sticky_kit:unstick",this.updateHorizontalScroll.bind(this)),this.$el.parent().on("sticky_kit:bottom",this.updateHorizontalScroll.bind(this)),this.$el.parent().on("sticky_kit:unbottom",this.updateHorizontalScroll.bind(this))}}),L.SidebarWidgetsCollectionView=v.a.CollectionView.extend({childView:function(e){return e.get("widgetView")}}),L.SidebarWidgetsView=v.a.View.extend({getTemplate:function(){return window.templates.sidebarContent},regions:{widgets:".mailpoet_region_content"},initialize:function(e){this.widgets=e},onRender:function(){this.showChildView("widgets",new L.SidebarWidgetsCollectionView({collection:this.widgets}))}}),L.SidebarLayoutWidgetsView=L.SidebarWidgetsView.extend({getTemplate:function(){return window.templates.sidebarLayout}}),L.SidebarStylesView=v.a.View.extend({getTemplate:function(){return window.templates.sidebarStyles},behaviors:{ColorPickerBehavior:{}},modelEvents:{change:"render"},events:function(){return{"change #mailpoet_text_font_color":M.a.partial(this.changeColorField,"text.fontColor"),"change #mailpoet_text_font_family":function(e){this.model.set("text.fontFamily",e.target.value)},"change #mailpoet_text_font_size":function(e){this.model.set("text.fontSize",e.target.value)},"change #mailpoet_h1_font_color":M.a.partial(this.changeColorField,"h1.fontColor"),"change #mailpoet_h1_font_family":function(e){this.model.set("h1.fontFamily",e.target.value)},"change #mailpoet_h1_font_size":function(e){this.model.set("h1.fontSize",e.target.value)},"change #mailpoet_h2_font_color":M.a.partial(this.changeColorField,"h2.fontColor"),"change #mailpoet_h2_font_family":function(e){this.model.set("h2.fontFamily",e.target.value)},"change #mailpoet_h2_font_size":function(e){this.model.set("h2.fontSize",e.target.value)},"change #mailpoet_h3_font_color":M.a.partial(this.changeColorField,"h3.fontColor"),"change #mailpoet_h3_font_family":function(e){this.model.set("h3.fontFamily",e.target.value)},"change #mailpoet_h3_font_size":function(e){this.model.set("h3.fontSize",e.target.value)},"change #mailpoet_a_font_color":M.a.partial(this.changeColorField,"link.fontColor"),"change #mailpoet_a_font_underline":function(e){this.model.set("link.textDecoration",e.target.checked?e.target.value:"none")},"change #mailpoet_text_line_height":function(e){this.model.set("text.lineHeight",e.target.value)},"change #mailpoet_heading_line_height":function(e){this.model.set("h1.lineHeight",e.target.value),this.model.set("h2.lineHeight",e.target.value),this.model.set("h3.lineHeight",e.target.value)},"change #mailpoet_newsletter_background_color":M.a.partial(this.changeColorField,"wrapper.backgroundColor"),"change #mailpoet_background_color":M.a.partial(this.changeColorField,"body.backgroundColor")}},templateContext:function(){return{model:this.model.toJSON(),availableStyles:this.availableStyles.toJSON()}},initialize:function(e){this.availableStyles=e.availableStyles},changeField:function(e,t){this.model.set(e,x()(t.target).val())},changeColorField:function(e,t){var i=x()(t.target).val();""===i&&(i="transparent"),this.model.set(e,i)}}),L.SidebarPreviewView=v.a.View.extend({getTemplate:function(){return window.templates.sidebarPreview},events:{"click .mailpoet_show_preview":"showPreview","click #mailpoet_send_preview":"sendPreview"},onBeforeDestroy:function(){this.previewView&&(this.previewView.destroy(),this.previewView=null)},showPreview:function(){var e=T.toJSON();M.a.isUndefined(e.body)||(e.body=R()(e.body)),c.a.Modal.loading(!0),c.a.Ajax.post({api_version:window.mailpoet_api_version,endpoint:"newsletters",action:"showPreview",data:e}).always(function(){c.a.Modal.loading(!1)}).done(function(e){this.previewView=new L.NewsletterPreviewView({previewType:window.localStorage.getItem(T.getConfig().get("newsletterPreview.previewTypeLocalStorageKey")),previewUrl:e.meta.preview_url}),this.previewView.render(),c.a.Modal.popup({template:"",element:this.previewView.$el,minWidth:"95%",height:"100%",title:c.a.I18n.t("newsletterPreview"),onCancel:function(){this.previewView.destroy(),this.previewView=null}.bind(this)}),c.a.trackEvent("Editor > Browser Preview",{"MailPoet Free version":window.mailpoet_version})}.bind(this)).fail(function(e){e.errors.length>0&&c.a.Notice.error(e.errors.map(function(e){return e.message}),{scroll:!0})})},sendPreview:function(){var e=this.$("#mailpoet_preview_to_email"),t={subscriber:e.val(),id:T.getNewsletter().get("id")};if(t.subscriber.length<=0)return c.a.Notice.error(c.a.I18n.t("newsletterPreviewEmailMissing"),{positionAfter:e,scroll:!0}),!1;c.a.Modal.loading(!0),T.getChannel().request("save").always(function(){I.previewNewsletter(t).always(function(){c.a.Modal.loading(!1)}).done(function(){c.a.Notice.success(c.a.I18n.t("newsletterPreviewSent"),{scroll:!0}),c.a.trackEvent("Editor > Preview sent",{"MailPoet Free version":window.mailpoet_version,"Domain name":t.subscriber.substring(t.subscriber.indexOf("@")+1)}),c.a.Poll.successDelivery.canShow("preview")&&(c.a.Poll.successDelivery.showModal("preview","IHedf1"),c.a.Poll.successDelivery.setPollShown("preview"))}).fail(function(e){e.errors.length>0&&c.a.Notice.error(e.errors.map(function(e){var t="\n                <p>\n                  ".concat(c.a.I18n.t("newsletterPreviewErrorNotice").replace("%$1s",window.config.mtaMethod),":\n                  <i>").concat(e.message,"</i>\n                </p>\n              ");if("PHPMail"===window.config.mtaMethod)t+="\n                  <p>".concat(c.a.I18n.t("newsletterPreviewErrorCheckConfiguration"),"</p>\n                  <br />\n                  <p>").concat(c.a.I18n.t("newsletterPreviewErrorUseSendingService"),'</p>\n                  <p>\n                    <a\n                      href="https://www.mailpoet.com/free-plan/?utm_source=plugin&utm_campaign=sending-error"\n                      target="_blank"\n                      rel="noopener noreferrer"\n                    >\n                      ').concat(c.a.I18n.t("newsletterPreviewErrorSignUpForSendingService"),"\n                    </a>\n                  </p>\n                ");else{var i=c.a.I18n.t("newsletterPreviewErrorCheckSettingsNotice").replace(/\[link\](.*?)\[\/link\]/g,'<a href="?page=mailpoet-settings#mta" key="check-sending">$1</a>');t+="<p>".concat(i,"</p>")}return t}),{scroll:!0,static:!0})})})}}),L.NewsletterPreviewView=v.a.View.extend({className:"mailpoet_browser_preview_wrapper",getTemplate:function(){return window.templates.newsletterPreview},events:function(){return{"change .mailpoet_browser_preview_type":"changeBrowserPreviewType"}},initialize:function(e){this.previewType=e.previewType,this.previewUrl=e.previewUrl,this.width="100%",this.height="100%"},templateContext:function(){return{previewType:this.previewType,previewUrl:this.previewUrl,width:this.width,height:this.height}},changeBrowserPreviewType:function(e){var t=x()(e.target).val();"mobile"===t?(this.$(".mailpoet_browser_preview_container").removeClass("mailpoet_browser_preview_container_desktop"),this.$(".mailpoet_browser_preview_container").addClass("mailpoet_browser_preview_container_mobile")):(this.$(".mailpoet_browser_preview_container").addClass("mailpoet_browser_preview_container_desktop"),this.$(".mailpoet_browser_preview_container").removeClass("mailpoet_browser_preview_container_mobile")),window.localStorage.setItem(T.getConfig().get("newsletterPreview.previewTypeLocalStorageKey"),t),this.previewType=t}}),T.on("before:start",function(e){var t=e;t.registerWidget=L.registerWidget,t.getWidgets=L.getWidgets,t.registerLayoutWidget=L.registerLayoutWidget,t.getLayoutWidgets=L.getLayoutWidgets}),T.on("start",function(e){var t=new F;e._appView.showChildView("sidebarRegion",t),c.a.helpTooltip.show(document.getElementById("tooltip-send-preview"),{tooltipId:"tooltip-editor-send-preview",tooltip:c.a.I18n.t("helpTooltipSendPreview")})});var $={};$.NewsletterModel=B.a.extend({whitelisted:["id","subject","preheader","type"],initialize:function(){this.on("change",function(){T.getChannel().trigger("autoSave")})},toJSON:function(){return M.a.pick(B.a.prototype.toJSON.call(this),this.whitelisted)}}),$._blockTypes={},$.registerBlockType=function(e,t){$._blockTypes[e]=t},$.getBlockTypeModel=function(e){if(e in $._blockTypes)return $._blockTypes[e].blockModel;throw new Error("Block type not supported: "+e)},$.getBlockTypeView=function(e){if(e in $._blockTypes)return $._blockTypes[e].blockView;throw new Error("Block type not supported: "+e)},$.getBody=function(){return{content:T._contentContainer.toJSON(),globalStyles:T.getGlobalStyles().toJSON(),blockDefaults:M.a.omit(T.getConfig().toJSON().blockDefaults,"text","image")}},$.toJSON=function(){return M.a.extend({body:$.getBody()},T.getNewsletter().toJSON())},$.getNewsletter=function(){return $.newsletter},$.findModels=function(e){var t=T._contentContainer.getChildren();return M.a.filter(t,e)},$.renderContent=function(e){T._contentContainer&&T._contentContainer.destroy(),T._contentContainerView&&T._contentContainerView.destroy(),T._contentContainer=new(T.getBlockTypeModel("container"))(e,{parse:!0}),T._contentContainerView=new(T.getBlockTypeView("container"))({model:T._contentContainer,renderOptions:{depth:0}}),T._appView.showChildView("contentRegion",T._contentContainerView)},T.on("before:start",function(e,t){var i=e;i.registerBlockType=$.registerBlockType,i.getBlockTypeModel=$.getBlockTypeModel,i.getBlockTypeView=$.getBlockTypeView,i.toJSON=$.toJSON,i.getBody=$.getBody,i.getNewsletter=$.getNewsletter,i.findModels=$.findModels,$.newsletter=new $.NewsletterModel(M.a.omit(M.a.clone(t.newsletter),["body"]))}),T.on("start",function(e,t){var i=e,o=t.newsletter.body,n=M.a.has(o,"content")?o.content:{};M.a.has(t.newsletter,"body")&&M.a.isObject(t.newsletter.body)||c.a.Notice.error(c.a.I18n.t("newsletterBodyIsCorrupted"),{static:!0}),$.renderContent(n),i.getChannel().on("historyUpdate",function(e){$.renderContent(e.content)},this)});var W={};W.HeadingView=v.a.View.extend({getTemplate:function(){return window.templates.heading},templateContext:function(){return{model:this.model.toJSON()}},events:function(){return{"keyup .mailpoet_input_title":M.a.partial(this.changeField,"subject"),"keyup .mailpoet_input_preheader":M.a.partial(this.changeField,"preheader")}},changeField:function(e,t){this.model.set(e,x()(t.target).val())}}),T.on("start",function(e){e._appView.showChildView("headingRegion",new W.HeadingView({model:e.getNewsletter()})),c.a.helpTooltip.show(document.getElementById("tooltip-designer-subject-line"),{tooltipId:"tooltip-designer-subject-line-ti",tooltip:c.a.I18n.t("helpTooltipDesignerSubjectLine"),place:"right"}),c.a.helpTooltip.show(document.getElementById("tooltip-designer-preheader"),{tooltipId:"tooltip-designer-preheader-ti",tooltip:c.a.I18n.t("helpTooltipDesignerPreheader")})});var H=i(382),U=i.n(H),j={};j.HistoryView=v.a.View.extend({MAX_HISTORY_STATES:25,elements:{redo:null,undo:null},events:{"click #mailpoet-history-arrow-undo":"undo","click #mailpoet-history-arrow-redo":"redo"},model:{statesStack:[],currentStateIndex:0},getTemplate:function(){return window.templates.history},initialize:function(){var e=this;T.getChannel().on("afterEditorSave",this.addState,this),U.a.bind(["ctrl+z","command+z"],function(){e.undo()}),U.a.bind(["shift+ctrl+z","shift+command+z"],function(){e.redo()})},onAttach:function(){this.elements.redo=document.getElementById("mailpoet-history-arrow-redo"),this.elements.undo=document.getElementById("mailpoet-history-arrow-undo"),this.addState(T.toJSON())},addState:function(e){var t;e&&e.body&&(t=R()(e.body),this.model.statesStack[this.model.currentStateIndex]!==t&&(this.model.currentStateIndex>0&&this.model.statesStack.splice(0,this.model.currentStateIndex),this.model.statesStack.unshift(t),this.model.currentStateIndex=0,this.model.statesStack.length=Math.min(this.model.statesStack.length,this.MAX_HISTORY_STATES),this.updateArrowsUI()))},canUndo:function(){return this.model.currentStateIndex<this.model.statesStack.length-1},canRedo:function(){return this.model.currentStateIndex>0},undo:function(){this.canUndo()&&(this.model.currentStateIndex=Math.min(this.model.statesStack.length-1,this.model.currentStateIndex+1),this.updateArrowsUI(),this.applyState(this.model.currentStateIndex))},redo:function(){this.canRedo()&&(this.model.currentStateIndex=Math.max(0,this.model.currentStateIndex-1),this.updateArrowsUI(),this.applyState(this.model.currentStateIndex))},updateArrowsUI:function(){this.elements.undo.classList.toggle("mailpoet_history_arrow_inactive",!this.canUndo()),this.elements.redo.classList.toggle("mailpoet_history_arrow_inactive",!this.canRedo()),this.elements.undo.setAttribute("title",c.a.I18n.t(this.canUndo()?"canUndo":"canNotUndo")),this.elements.redo.setAttribute("title",c.a.I18n.t(this.canRedo()?"canRedo":"canNotRedo"))},applyState:function(e){var t=JSON.parse(this.model.statesStack[e]);T.getChannel().trigger("historyUpdate",t)}}),T.on("start",function(e){e._appView.showChildView("historyRegion",new j.HistoryView)});var q,Y,X=i(401),J=i.n(X),G=i(402),K=i.n(G),Q=i(253),Z={};Z.save=function(){var e=T.toJSON(),t=x()("#mailpoet_editor_top");return M.a.isUndefined(e.body)||(e.body=R()(e.body)),T.getChannel().trigger("beforeEditorSave",e),I.saveNewsletter(e).done(function(i){void 0!==i.success&&!0===i.success||void 0!==i.error&&(0===i.error.length?c.a.Notice.error(c.a.I18n.t("templateSaveFailed"),{positionAfter:t,scroll:!0}):x()(i.error).each(function(e,i){c.a.Notice.error(i,{positionAfter:t,scroll:!0})})),M.a.isUndefined(e.body)||(e.body=JSON.parse(e.body)),T.getChannel().trigger("afterEditorSave",e,i)}).fail(function(e){T.getChannel().trigger("afterEditorSave",{},e)})},Z.saveTemplate=function(e){return Q.a(T.toJSON()).then(function(t){var i=M.a.extend(e||{},{thumbnail:t,body:R()(T.getBody()),categories:R()(["saved",T.getNewsletter().get("type")])});return c.a.Ajax.post({api_version:window.mailpoet_api_version,endpoint:"newsletterTemplates",action:"save",data:i})})},Z.exportTemplate=function(e){return Q.a(T.toJSON()).then(function(t){var i=M.a.extend(e||{},{thumbnail:t,body:T.getBody(),categories:R()(["saved",T.getNewsletter().get("type")])}),o=new J.a([R()(i)],{type:"application/json;charset=utf-8"});K.a.saveAs(o,"template.json"),c.a.trackEvent("Editor > Template exported",{"MailPoet Free version":window.mailpoet_version})})},Z.SaveView=v.a.View.extend({getTemplate:function(){return window.templates.save},templateContext:function(){return{wrapperClass:this.wrapperClass}},events:{"click .mailpoet_save_button":"save","click .mailpoet_save_show_options":"toggleSaveOptions","click .mailpoet_save_next":"next","click .mailpoet_save_template":"showSaveAsTemplate","click .mailpoet_save_as_template":"saveAsTemplate","click .mailpoet_save_export":"showExportTemplate","click .mailpoet_export_template":"exportTemplate"},initialize:function(){this.setDropdownDirectionDown(),T.getChannel().on("beforeEditorSave",this.beforeSave,this),T.getChannel().on("afterEditorSave",this.afterSave,this)},setDropdownDirectionDown:function(){this.wrapperClass="mailpoet_save_dropdown_down"},setDropdownDirectionUp:function(){this.wrapperClass="mailpoet_save_dropdown_up"},onRender:function(){this.validateNewsletter(T.toJSON())},save:function(){this.hideSaveOptions(),T.getChannel().request("save")},beforeSave:function(){this.$(".mailpoet_autosaved_at").text(c.a.I18n.t("saving"))},afterSave:function(e){this.validateNewsletter(e),this.$(".mailpoet_editor_last_saved").removeClass("mailpoet_hidden"),this.$(".mailpoet_autosaved_at").text("")},showSaveOptions:function(){this.$(".mailpoet_save_show_options").addClass("mailpoet_save_show_options_active"),this.$(".mailpoet_save_options").removeClass("mailpoet_hidden"),this.hideSaveAsTemplate(),this.hideExportTemplate()},hideSaveOptions:function(){this.$(".mailpoet_save_show_options").removeClass("mailpoet_save_show_options_active"),this.$(".mailpoet_save_options").addClass("mailpoet_hidden"),this.hideSaveAsTemplate(),this.hideExportTemplate()},toggleSaveOptions:function(){this.$(".mailpoet_save_show_options").hasClass("mailpoet_save_show_options_active")?this.hideSaveOptions():this.showSaveOptions()},showSaveAsTemplate:function(){this.$(".mailpoet_save_as_template_container").removeClass("mailpoet_hidden")},hideSaveAsTemplate:function(){this.$(".mailpoet_save_as_template_container").addClass("mailpoet_hidden")},saveAsTemplate:function(){var e=this.$(".mailpoet_save_as_template_name").val(),t=x()("#mailpoet_editor_top");""===e?c.a.Notice.error(c.a.I18n.t("templateNameMissing"),{positionAfter:t,scroll:!0}):(Z.saveTemplate({name:e}).then(function(){c.a.Notice.success(c.a.I18n.t("templateSaved"),{positionAfter:t,scroll:!0}),c.a.trackEvent("Editor > Template saved",{"MailPoet Free version":window.mailpoet_version})}).catch(function(){c.a.Notice.error(c.a.I18n.t("templateSaveFailed"),{positionAfter:t,scroll:!0})}),this.hideSaveOptions())},showExportTemplate:function(){this.$(".mailpoet_export_template_container").removeClass("mailpoet_hidden")},hideExportTemplate:function(){this.$(".mailpoet_export_template_container").addClass("mailpoet_hidden")},exportTemplate:function(){var e=this.$(".mailpoet_export_template_name").val(),t=x()("#mailpoet_editor_top");""===e?c.a.Notice.error(c.a.I18n.t("templateNameMissing"),{positionAfter:t,scroll:!0}):(Z.exportTemplate({name:e}),this.hideExportTemplate())},next:function(){this.hideSaveOptions(),this.$(".mailpoet_save_next").hasClass("button-disabled")||(Z._cancelAutosave(),Z.save().done(function(){window.location.href=T.getConfig().get("urls.send")}))},validateNewsletter:function(e){var t="";T._contentContainer.isValid()?(e&&e.body&&e.body.content&&(t=R()(e.body.content)),T.getConfig().get("validation.validateUnsubscribeLinkPresent")&&t.indexOf("[link:subscription_unsubscribe_url]")<0&&t.indexOf("[link:subscription_unsubscribe]")<0?this.showValidationError(c.a.I18n.t("unsubscribeLinkMissing")):"notification"===T.getNewsletter().get("type")&&t.indexOf('"type":"automatedLatestContent"')<0&&t.indexOf('"type":"automatedLatestContentLayout"')<0?this.showValidationError(c.a.I18n.t("automatedLatestContentMissing")):this.hideValidationError()):this.showValidationError(T._contentContainer.validationError)},showValidationError:function(e){var t=this.$(".mailpoet_save_error");t.text(e),t.removeClass("mailpoet_hidden"),this.$(".mailpoet_save_next").addClass("button-disabled")},hideValidationError:function(){this.$(".mailpoet_save_error").addClass("mailpoet_hidden"),this.$(".mailpoet_save_next").removeClass("button-disabled")}}),Z.autoSave=function(){Z._cancelAutosave(),q=setTimeout(function(){if(Y)return Y=!1,void Z._cancelAutosave();T.getChannel().request("save").always(function(){Z._cancelAutosave()})},1e3)},Z._cancelAutosave=function(){q&&(clearTimeout(q),q=void 0)},Z.onHistoryUpdate=function(){Y=!0},Z.beforeExitWithUnsavedChanges=function(e){var t,i;if(q)return t=c.a.I18n.t("unsavedChangesWillBeLost"),(i=e||window.event)&&(i.returnValue=t),t},T.on("before:start",function(e){var t=e;t.save=Z.save,t.getChannel().on("autoSave",Z.autoSave),t.getChannel().on("historyUpdate",Z.onHistoryUpdate),window.onbeforeunload=Z.beforeExitWithUnsavedChanges,t.getChannel().reply("save",t.save)}),T.on("start",function(e){var t=new Z.SaveView,i=new Z.SaveView;i.setDropdownDirectionUp(),e._appView.showChildView("topRegion",t),e._appView.showChildView("bottomRegion",i)});var ee=v.a,te={};ee.Behaviors.behaviorsLookup=function(){return te},window.BehaviorsLookup=te;var ie=te;i(510);ie.ColorPickerBehavior=v.a.Behavior.extend({onRender:function(){var e=this;this.view.$(".mailpoet_color").each(function(){var t=e.view.$(this),i=function(e){e&&e.getAlpha()>0?t.val(e.toString("hex6")):t.val(""),t.trigger("change")};t.spectrum({clickoutFiresChange:!0,showInput:!0,showInitial:!0,showPalette:!0,showSelectionPalette:!0,palette:[],localStorageKey:"newsletter_editor.spectrum.palette",preferredFormat:"hex6",allowEmpty:!0,chooseText:c.a.I18n.t("selectColor"),cancelText:c.a.I18n.t("cancelColorSelection"),change:i,move:i,hide:i})})}});var oe=i(47),ne=i.n(oe),re=i(105),se=i.n(re);ie.ContainerDropZoneBehavior=v.a.Behavior.extend({defaults:{columnLimit:3},onRender:function(){M.a.isObject(this.view.options.renderOptions)&&!0===this.view.options.renderOptions.disableDragAndDrop||this.addDropZone()},addDropZone:function(){var e,t=this,i=this.view,o=t.$el.get(0);if(0===this.view.renderOptions.depth)e=".mailpoet_droppable_block.mailpoet_droppable_layout_block";else{if(2!==this.view.renderOptions.depth)return;e=".mailpoet_droppable_block:not(.mailpoet_droppable_layout_block)"}se()(o).dropzone({accept:e,overlap:"pointer",ondragenter:function(){i.$el.addClass("mailpoet_drop_active")},ondragleave:function(){t.cleanup()},ondropmove:function(e){var o,n,r,s,a,l,c,d=t.getDropPosition(e.dragmove.pageX,e.dragmove.pageY,i.$el,i.model.get("orientation"),i.model.get("blocks").length),h=i.$el,p="",u="",g=h.offset(),f=t.getCollection();void 0!==d&&(h.find(".mailpoet_drop_marker").remove(),f.isEmpty()||(0===f.length?(s=(r=h.find(i.childViewContainer)).offset().top-h.offset().top,a=r.offset().left-h.offset().left,p=r.width(),u=r.height()):(n=t.getCollection().length===d.index?f.at(d.index-1):f.at(d.index),s=(r=t.getChildren().findByModel(n).$el).offset().top-g.top,a=r.offset().left-g.left,"normal"===d.insertionType?("after"===d.position&&("vertical"===i.model.get("orientation")?s+=r.outerHeight(!0):a+=r.outerWidth()),"vertical"===i.model.get("orientation")?p=r.outerWidth():u=r.outerHeight()):("after"===d.position&&("vertical"===i.model.get("orientation")?a+=r.outerWidth():s+=r.outerHeight()),"vertical"===i.model.get("orientation")?u=r.outerHeight(!0):p=r.outerWidth(!0))),o=x()('<div class="mailpoet_drop_marker"></div>'),0===d.index&&o.addClass("mailpoet_drop_marker_first"),f.length-1===d.index&&o.addClass("mailpoet_drop_marker_last"),d.index>0&&f.length-1>d.index&&o.addClass("mailpoet_drop_marker_middle"),o.addClass("mailpoet_drop_marker_"+d.position),c=(l="before"===d.position?t.getChildren().findByModel(f.at(d.index-1)).$el:t.getChildren().findByModel(f.at(d.index)).$el).outerHeight(!0)-l.outerHeight(),o.css("top",s-c/2),o.css("left",a),o.css("width",p),o.css("height",u),h.append(o)))},ondrop:function(e){var o,n,r,s,a,l=t.getDropPosition(e.dragEvent.pageX,e.dragEvent.pageY,i.$el,i.model.get("orientation"),i.model.get("blocks").length),c=e.draggable.getDropModel(),d=t.getCollection();void 0!==l&&("normal"===l.insertionType?(n="after"===l.position?l.index+1:l.index,"horizontal"===i.model.get("orientation")&&"container"!==c.get("type")?((r=new(window.EditorApplication.getBlockTypeModel("container"))({orientation:"vertical"})).get("blocks").add(c),d.add(r,{at:n})):d.add(c,{at:n}),o=t.getChildren().findByModel(c)):(a=d.at(l.index),r=new(window.EditorApplication.getBlockTypeModel("container"))({orientation:"vertical"===i.model.get("orientation")?"horizontal":"vertical"}),d.remove(a),"horizontal"===r.get("orientation")?("before"===l.position&&((s=new(window.EditorApplication.getBlockTypeModel("container"))({orientation:"vertical"})).get("blocks").add(c),r.get("blocks").add(s)),(s=new(window.EditorApplication.getBlockTypeModel("container"))({orientation:"vertical"})).get("blocks").add(a),r.get("blocks").add(s),"after"===l.position&&((s=new(window.EditorApplication.getBlockTypeModel("container"))({orientation:"vertical"})).get("blocks").add(c),r.get("blocks").add(s))):("before"===l.position&&r.get("blocks").add(c),r.get("blocks").add(a),"after"===l.position&&r.get("blocks").add(c)),d.add(r,{at:l.index}),o=t.getChildren().findByModel(r).children.findByModel(c)),e.draggable.onDrop({dropBehavior:t,droppedModel:c,droppedView:o}),t.cleanup())}})},cleanup:function(){this.view.$el.removeClass("mailpoet_drop_active"),this.view.$(".mailpoet_drop_marker").remove()},getDropPosition:function(e,t,i){var o,n,r,s,a,l,c=0,d=this.view.$el,h=this.view.model.get("orientation"),p=d.offset(),u=p.left,g=p.top,f=d.outerWidth(!0),m=d.outerHeight(!0),_=e-u,v=t-g,w=this._canAcceptNormalInsertion(),y=this._canAcceptSpecialInsertion(),b=!!i;return 0===this.getCollection().length?{insertionType:"normal",index:0,position:"inside"}:("vertical"===h?(o=_,n=f):(o=v,n=m),y&&!w&&(c=.5),o<=n*c&&(b||y)?(r="special",a="before",s=this._computeSpecialIndex(e,t)):o>n*(1-c)&&(b||y)?(r="special",a="after",s=this._computeSpecialIndex(e,t)):(r="normal",a=(l=this._computeNormalIndex(e,t)).position,s=l.index),b||"vertical"!==h||"special"!==r||"horizontal"!==this.getCollection().at(s).get("orientation")||(r="normal",a=(l=this._computeNormalIndex(e,t)).position,s=l.index),"horizontal"!==h||"special"!==r?{insertionType:r,index:s,position:a}:void 0)},_computeNormalIndex:function(e,t){var i,o,n,r=this._computeCellIndex(e,t),s=this.getChildren().findByModel(this.getCollection().at(r)),a=this.view.model.get("orientation"),l=s.$el;return"vertical"===a?(i=t,o=l.offset().top,n=l.outerHeight(!0)):(i=e,o=l.offset().left,n=l.outerWidth(!0)),i<=o+n/2?{index:r,position:"before"}:{index:r,position:"after"}},_computeSpecialIndex:function(e,t){return this._computeCellIndex(e,t)},_computeCellIndex:function(e,t){var i=this.view.model.get("orientation"),o="vertical"===i?t:e,n=this.getChildren().find(function(e){var t,n,r=e.$el;return"vertical"===i?(t=r.offset().top,n=r.outerHeight(!0)):(t=r.offset().left,n=r.outerWidth(!0)),n+=t,t<=o&&o<=n});return"object"===ne()(n)?n._index:0},_canAcceptNormalInsertion:function(){var e=this.view.model.get("orientation"),t=this.view.renderOptions.depth,i=this.getChildren().length;return"vertical"===e||"horizontal"===e&&1===t&&i<this.options.columnLimit},_canAcceptSpecialInsertion:function(){var e=this.view.model.get("orientation"),t=this.view.renderOptions.depth,i=this.getChildren().length;return 0===t||1===t&&"horizontal"===e&&i<=this.options.columnLimit},getCollectionView:function(){return this.view.getChildView("blocks")},getChildren:function(){return this.getCollectionView().children},getCollection:function(){return this.getCollectionView().collection}});var ae=i(255),le=i.n(ae);ie.DraggableBehavior=v.a.Behavior.extend({defaults:{cloneOriginal:!1,hideOriginal:!1,ignoreSelector:".mailpoet_ignore_drag, .mailpoet_ignore_drag *",onDragSubstituteBy:void 0,getDropModel:function(){throw new Error("Missing 'drop' function for DraggableBehavior")},onDrop:function(){},testAttachToInstance:function(){return!0}},onRender:function(){var e,t=this;this.options.testAttachToInstance(this.view.model,this.view)&&(e=se()(this.$el.get(0),{ignoreFrom:this.options.ignoreSelector}).draggable({max:1/0,autoScroll:!0,onstart:function(e){var i,o,n,r,s,a=e;!0===t.options.cloneOriginal&&(M.a.isFunction(t.options.onDragSubstituteBy)&&(n=t.options.onDragSubstituteBy(t)),r=n||a.target.cloneNode(!0),x()(a.target),(s=x()(r)).addClass("mailpoet_droppable_active"),s.css("position","absolute"),s.css("top",0),s.css("left",0),document.body.appendChild(r),i=s.width()/2,o=s.height()/2,s.css("top",a.pageY-o),s.css("left",a.pageX-i),a.interaction.element=r,!0===t.options.hideOriginal&&t.view.$el.addClass("mailpoet_hidden"),T.getChannel().trigger("dragStart"),document.activeElement.blur())},onmove:function(e){var t=e.target,i=(le()(t.getAttribute("data-x"))||0)+e.dx,o=(le()(t.getAttribute("data-y"))||0)+e.dy;t.style.transform="translate("+i+"px, "+o+"px)",t.style.webkitTransform=t.style.transform,t.setAttribute("data-x",i),t.setAttribute("data-y",o)},onend:function(e){var i=e.target;i.style.transform="",i.style.webkitTransform=i.style.transform,i.removeAttribute("data-x"),i.removeAttribute("data-y"),x()(e.interaction.element).addClass("mailpoet_droppable_active"),!0===t.options.cloneOriginal&&(x()(i).remove(),!0===t.options.hideOriginal&&t.view.$el.removeClass("mailpoet_hidden"))}}).preventDefault("auto").styleCursor(!1).actionChecker(function(e,t,i){return 0!==t.button?null:i}),void 0!==this.options.drop?e.getDropModel=this.options.drop:e.getDropModel=this.view.getDropFunc(),e.onDrop=function(e){var i=e;M.a.isObject(i)&&(i.dragBehavior=t),t.options.onDrop.apply(t,[i])})}});var ce=function(e,t){var i=t.offset(),o=t.height(),n=t.width();return!(e.pageX<i.left||e.pageX>i.left+n||e.pageY<i.top||e.pageY>i.top+o)};ie.HighlightEditingBehavior=v.a.Behavior.extend({modelEvents:{startEditing:"onStartEditing",stopEditing:"onStopEditing",startResizing:"onStartResizing",stopResizing:"onStopResizing"},events:{mouseenter:"onMouseEnter",mouseleave:"onMouseLeave"},onMouseEnter:function(e){this.isFocusedByPointer=!0,e&&e.buttons>0||T.getDisplayedSettingsId()||this.view.addHighlight()},onMouseLeave:function(){this.isFocusedByPointer=!1,this.isBeingEdited||this.view.removeHighlight()},onStartEditing:function(){this.isBeingEdited=!0,this.view.addHighlight()},onStopEditing:function(){this.isBeingEdited=!1,this.isFocusedByPointer||this.view.removeHighlight()},onStartResizing:function(){this.onStartEditing(),this.view.triggerMethod("resizeStart")},onStopResizing:function(e){this.isFocusedByPointer=ce(e,this.view.$el),T.getDisplayedSettingsId()||this.onStopEditing(),this.view.triggerMethod("resizeStop",e)},onDomRefresh:function(){this.isBeingEdited&&this.view.addHighlight()},onChildviewResizeStart:function(){this.onStartEditing(),this.view.triggerMethod("resizeStart")},onChildviewResizeStop:function(e){this.isFocusedByPointer=ce(e,this.view.$el),this.onStopEditing(),this.view.triggerMethod("resizeStop",e)}}),ie.MediaManagerBehavior=v.a.Behavior.extend({ui:{"select-image":".mailpoet_field_image_select_image","address-input":".mailpoet_field_image_address"},events:{"click @ui.select-image":"showMediaManager","input @ui.address-input":"changeAddress"},initialize:function(){this.view.options.showImageManager&&this.showMediaManager()},changeAddress:function(e){var t=x()(e.target).val(),i=new Image;t||!this.options.onSelect?(i.onload=function(){this.options.onSelect&&this.view[this.options.onSelect]({src:t,width:i.naturalWidth+"px",height:i.naturalHeight+"px"})}.bind(this),i.src=t):this.view[this.options.onSelect]({src:null,width:null,height:null})},showMediaManager:function(){var e,t,i=this;if(this._mediaManager)return this._mediaManager.resetSelections(),void this._mediaManager.open();e=window.wp.media.view.MediaFrame.Select.extend({initialize:function(){window.wp.media.view.MediaFrame.prototype.initialize.apply(this,arguments),M.a.defaults(this.options,{multiple:!0,editing:!1,state:"insert"}),this.createSelection(),this.createStates(),this.bindHandlers(),this.createIframeStates(),this.$el.addClass("hide-title")},resetSelections:function(){this.state().get("selection").reset()},createQuery:function(e){return window.wp.media.query(e)},createStates:function(){var e=this.options;this.states.add([new window.wp.media.controller.Library({id:"insert",title:"Add images",priority:20,toolbar:"main-insert",filterable:"image",library:this.createQuery(e.library),multiple:!!e.multiple&&"reset",editable:!1,allowLocalEdits:!1,displaySettings:!1,displayUserSettings:!1})]),window.wp.media.view.settings.post.featuredImageId&&this.states.add(new window.wp.media.controller.FeaturedImage)},bindHandlers:function(){var e;this.on("router:create:browse",this.createRouter,this),this.on("router:render:browse",this.browseRouter,this),this.on("content:create:browse",this.browseContent,this),this.on("content:render:upload",this.uploadContent,this),this.on("toolbar:create:select",this.createSelectToolbar,this),this.on("menu:create:gallery",this.createMenu,this),this.on("toolbar:create:main-insert",this.createToolbar,this),this.on("toolbar:create:main-gallery",this.createToolbar,this),this.on("toolbar:create:main-embed",this.mainEmbedToolbar,this),this.on("updateExcluded",this.browseContent,this),e={content:{embed:"embedContent","edit-selection":"editSelectionContent"},toolbar:{"main-insert":"mainInsertToolbar"}},M.a.each(e,function(e,t){M.a.each(e,function(e,i){this.on(t+":render:"+i,this[e],this)},this)},this)},uploadContent:function(){window.wp.media.view.MediaFrame.Select.prototype.uploadContent.apply(this,arguments),this.$el.addClass("hide-toolbar")},embedContent:function(){var e=new window.wp.media.view.Embed({controller:this,model:this.state()}).render();this.content.set(e),e.url.focus()},editSelectionContent:function(){var e,t=this.state(),i=t.get("selection");(e=new window.wp.media.view.AttachmentsBrowser({controller:this,collection:i,selection:i,model:t,sortable:!0,search:!1,dragInfo:!0,AttachmentView:window.wp.media.view.Attachment.EditSelection}).render()).toolbar.set("backToLibrary",{text:"Return to library",priority:-100,click:function(){this.controller.content.mode("browse")}}),this.content.set(e)},selectionStatusToolbar:function(e){var t=this.state().get("editable");e.set("selection",new window.wp.media.view.Selection({controller:this,collection:this.state().get("selection"),priority:-40,editable:t&&function(){this.controller.content.mode("edit-selection")}}).render())},mainInsertToolbar:function(e){var t=this;this.selectionStatusToolbar(e),e.set("insert",{style:"primary",priority:80,text:"Select Image",requires:{selection:!0},click:function(){var e=t.state(),i=e.get("selection");t.close(),e.trigger("insert",i).reset()}})},mainEmbedToolbar:function(e){e.view=new window.wp.media.view.Toolbar.Embed({controller:this,text:"Add images"})}}),t=new e({id:"mailpoet-media-manager",frame:"select",title:"Select image",editing:!1,multiple:!1,library:{type:"image"},displaySettings:!1,button:{text:"Select"}}),this._mediaManager=t,this._mediaManager.on("insert",function(){t.state().get("selection").each(function(e){var t=e.get("sizes"),o=M.a.sortBy(M.a.keys(t),function(e){return Math.abs(1320-t[e].width)}),n=t[M.a.first(o)].width,r=M.a.filter(M.a.values(t),function(e){return e.width===n}),s=M.a.max(r,function(e){return e.height});i.options.onSelect&&i.view[i.options.onSelect]({height:s.height+"px",width:s.width+"px",src:s.url,alt:""!==e.get("alt")&&void 0!==e.get("alt")?e.get("alt"):e.get("title")})})}),this._mediaManager.open()},onBeforeDestroy:function(){"object"===ne()(this._mediaManager)&&this._mediaManager.remove()}}),ie.ResizableBehavior=v.a.Behavior.extend({defaults:{elementSelector:null,resizeHandleSelector:!0,transformationFunction:function(e){return e},minLength:0,maxLength:1/0,modelField:"styles.block.height",onResize:function(e){var t=le()(this.view.model.get(this.options.modelField))+this.options.transformationFunction(e.dy);t=Math.min(this.options.maxLength,Math.max(this.options.minLength,t)),this.view.model.set(this.options.modelField,t+"px")}},onRender:function(){this.attachResize(),this.view.$el.addClass("mailpoet_resizable_block")},attachResize:function(){var e,t=this;e=null===this.options.elementSelector?this.view.$el.get(0):this.view.$(this.options.elementSelector).get(0),se()(e).resizable({edges:{top:!1,left:!1,right:!1,bottom:"string"==typeof this.options.resizeHandleSelector?this.view.$(this.options.resizeHandleSelector).get(0):this.options.resizeHandleSelector}}).on("resizestart",function(){t.view.model.trigger("startResizing"),document.activeElement.blur()}).on("resizemove",function(e){return t.options.onResize.bind(t)(e)}).on("resizeend",function(e){t.view.model.trigger("stopResizing",e),t.$el.removeClass("mailpoet_resize_active")})}}),ie.SortableBehavior=v.a.Behavior.extend({onRender:function(){var e=this.view.collection;M.a.isFunction(this.$el.sortable)&&this.$el.sortable({cursor:"move",start:function(e,t){t.item.data("previousIndex",t.item.index())},end:function(e,t){t.item.removeData("previousIndex")},update:function(t,i){var o=i.item.data("previousIndex"),n=i.item.index(),r=e.at(o);e.remove(r),e.add(r,{at:n})},items:this.options.items})}}),ie.ShowSettingsBehavior=v.a.Behavior.extend({defaults:{ignoreFrom:""},events:{"click .mailpoet_content":"showSettings"},showSettings:function(e){this.isIgnoredElement(e.target)||this.view.triggerMethod("showSettings")},isIgnoredElement:function(e){return this.options.ignoreFrom&&this.options.ignoreFrom.length>0&&x()(e).is(this.options.ignoreFrom)}}),ie.TextEditorBehavior=v.a.Behavior.extend({defaults:{selector:".mailpoet_content",toolbar1:"bold italic link unlink forecolor mailpoet_shortcodes",toolbar2:"",validElements:"p[class|style],span[class|style],a[href|class|title|target|style],strong[class|style],em[class|style],strike,br,del",invalidElements:"script",blockFormats:"Paragraph=p",plugins:"link textcolor colorpicker mailpoet_shortcodes",configurationFilter:function(e){return e}},initialize:function(){this.listenTo(T.getChannel(),"dragStart",this.hideEditor)},hideEditor:function(){this.tinymceEditor&&this.tinymceEditor.fire("blur")},onDomRefresh:function(){var e=this;!0!==this.view.disableTextEditor&&this.$(this.options.selector).tinymce(this.options.configurationFilter({inline:!0,menubar:!1,toolbar1:this.options.toolbar1,toolbar2:this.options.toolbar2,browser_spellcheck:!0,valid_elements:this.options.validElements,invalid_elements:this.options.invalidElements,block_formats:this.options.blockFormats,relative_urls:!1,remove_script_host:!1,convert_urls:!0,urlconverter_callback:function(e){return e.match(/\[.+\]/g)?e:this.documentBaseURI.toAbsolute(e,this.settings.remove_script_host)},plugins:this.options.plugins,setup:function(t){e.tinymceEditor=t,t.on("change",function(){e.view.triggerMethod("text:editor:change",t.getContent())}),t.on("click",function(e){T.getDisplayedSettingsId()&&T.getChannel().trigger("hideSettings"),document.activeElement!==t.targetElm&&t.selection.placeCaretAt(e.clientX,e.clientY)}),t.on("focus",function(){e.view.triggerMethod("text:editor:focus")}),t.on("blur",function(){e.view.triggerMethod("text:editor:blur")})}}))}});i(260);var de={},he=v.a.View.extend({});de.BlockModel=B.a.extend({stale:[],initialize:function(){this.on("change",function(){this._updateDefaults(),T.getChannel().trigger("autoSave")})},_getDefaults:function(e,t){var i;return i=M.a.isObject(t)&&M.a.isFunction(t.toJSON)?t.toJSON():t,JSON.parse(R()(x.a.extend(e,i||{})))},_updateDefaults:function(){var e=this.get("context")||this.get("type");T.getConfig().set("blockDefaults."+e,this.toJSON())},toJSON:function(){return M.a.omit(B.a.prototype.toJSON.call(this),this.stale)},getChildren:function(){return[]}}),de.BlockView=he.extend({regions:{toolsRegion:"> .mailpoet_tools"},modelEvents:{change:"render",delete:"deleteBlock",duplicate:"duplicateBlock"},behaviors:{DraggableBehavior:{cloneOriginal:!0,hideOriginal:!0,onDrop:function(e){T.getChannel().trigger("hideSettings"),e.dragBehavior.view.model.destroy()},onDragSubstituteBy:function(e){var t,i;if(M.a.isFunction(e.view.onDragSubstituteBy))return(t=new(e.view.onDragSubstituteBy())).render(),i=t.$el.get(0).cloneNode(!0),t.destroy(),i}},HighlightEditingBehavior:{}},templateContext:function(){return{model:this.model.toJSON(),viewCid:this.cid}},constructor:function(){he.apply(this,arguments),this.$el.addClass("mailpoet_editor_view_"+this.cid)},initialize:function(){this.on("showSettings",this.showSettings,this)},addHighlight:function(){this.$el.addClass("mailpoet_highlight"),this.showingToolsDisabled||(this.$("> .mailpoet_tools").addClass("mailpoet_display_tools"),this.toolsView.triggerMethod("showTools"))},removeHighlight:function(){this.$el.removeClass("mailpoet_highlight"),this.hideTools()},hideTools:function(){this.$("> .mailpoet_tools").removeClass("mailpoet_display_tools"),this.toolsView.triggerMethod("hideTools")},enableShowingTools:function(){this.showingToolsDisabled=!1},disableShowingTools:function(){this.showingToolsDisabled=!0,this.hideTools()},showSettings:function(e){this.toolsView.triggerMethod("showSettings",e)},getDropFunc:function(){return function(){return this.model.clone()}.bind(this)},disableDragging:function(){this.$el.addClass("mailpoet_ignore_drag")},enableDragging:function(){this.$el.removeClass("mailpoet_ignore_drag")},deleteBlock:function(){this.transitionOut().then(function(){this.model.destroy()}.bind(this))},duplicateBlock:function(){this.model.collection.add(this.model.toJSON(),{at:this.model.collection.findIndex(this.model)})},transitionOut:function(){return this._transition("slideUp","fadeOut","easeIn")},_transition:function(e,t,i){var o=x.a.Deferred();return this.$el.velocity(e,{duration:250,easing:i,complete:function(){o.resolve()}}).velocity(t,{duration:250,easing:i,queue:!1}),o}}),de.BlockToolsView=he.extend({getTemplate:function(){return window.templates.genericBlockTools},events:{"click .mailpoet_edit_block":"toggleSettings","click .mailpoet_delete_block_activate":"showDeletionConfirmation","click .mailpoet_delete_block_cancel":"hideDeletionConfirmation","click .mailpoet_delete_block_confirm":"deleteBlock","click .mailpoet_duplicate_block":"duplicateBlock"},tools:{settings:!0,delete:!0,duplicate:!0,move:!0},getSettingsView:function(){return de.BlockSettingsView},initialize:function(e){var t=e||{};M.a.isUndefined(t.tools)||(this.tools=x.a.extend({},this.tools,t.tools||{})),this.on("hideTools",this.hideDeletionConfirmation,this),this.on("showSettings",this.changeSettings)},templateContext:function(){return{model:this.model.toJSON(),viewCid:this.cid,tools:this.tools}},toggleSettings:function(){T.getDisplayedSettingsId()!==this.model.cid?this.changeSettings():T.getChannel().trigger("hideSettings")},changeSettings:function(e){var t=this.getSettingsView(),i=T.getDisplayedSettingsId();if(i){if(i===this.model.cid)return;T.getChannel().trigger("hideSettings")}else document.activeElement.blur(),T.getChannel().trigger("settingsDisplayed",this.model.cid),new t(M.a.extend({model:this.model},e||{})).render()},showDeletionConfirmation:function(){this.$(".mailpoet_delete_block").closest(".mailpoet_block").find("> .mailpoet_block_highlight").css({background:"#E64047",opacity:.5}),this.$(".mailpoet_delete_block").addClass("mailpoet_delete_block_activated")},hideDeletionConfirmation:function(){this.$(".mailpoet_delete_block").closest(".mailpoet_block").find("> .mailpoet_block_highlight").css({background:"transparent",opacity:1}),this.$(".mailpoet_delete_block").removeClass("mailpoet_delete_block_activated")},deleteBlock:function(e){return e.preventDefault(),this.model.trigger("delete"),T.getChannel().trigger("hideSettings"),!1},duplicateBlock:function(e){return e.preventDefault(),this.model.trigger("duplicate"),T.getChannel().trigger("hideSettings"),!1}}),de.BlockSettingsView=v.a.View.extend({className:"mailpoet_editor_settings",behaviors:{ColorPickerBehavior:{}},initialize:function(e){var t;this.model.trigger("startEditing"),t={element:this.$el,template:"",position:"right",overlayRender:!1,width:T.getConfig().get("sidepanelWidth"),onCancel:function(){this.destroy()}.bind(this)},this.renderOptions=e.renderOptions||{},"subpanel"===this.renderOptions.displayFormat?c.a.Modal.subpanel(t):c.a.Modal.panel(t),this.listenTo(T.getChannel(),"hideSettings",this.close)},templateContext:function(){return{model:this.model.toJSON()}},close:function(){this.destroy()},changeField:function(e,t){this.model.set(e,x()(t.target).val())},changePixelField:function(e,t){this.changeFieldWithSuffix(e,t,"px")},changeFieldWithSuffix:function(e,t,i){this.model.set(e,x()(t.target).val()+i)},changeBoolField:function(e,t){this.model.set(e,"true"===x()(t.target).val())},changeBoolCheckboxField:function(e,t){this.model.set(e,!!x()(t.target).prop("checked"))},changeColorField:function(e,t){var i=x()(t.target).val();""===i&&(i="transparent"),this.model.set(e,i)},onBeforeDestroy:function(){c.a.Modal.close(),this.model.trigger("stopEditing"),T.getChannel().trigger("settingsDisplayed",null)}}),de.WidgetView=v.a.View.extend({className:"mailpoet_widget mailpoet_droppable_block mailpoet_droppable_widget",behaviors:{DraggableBehavior:{drop:function(){throw new Error("Unsupported operation")}}}});var pe,ue=de,ge={},fe=ue;pe=N.a.Collection.extend({model:fe.BlockModel,initialize:function(){this.on("add change remove",function(){T.getChannel().trigger("autoSave")})},parse:function(e){return M.a.map(e,function(e){return new(T.getBlockTypeModel(e.type))(e,{parse:!0})})}}),ge.ContainerBlockModel=fe.BlockModel.extend({relations:{blocks:pe},defaults:function(){return this._getDefaults({type:"container",columnLayout:!1,orientation:"vertical",image:{src:null,display:"scale"},styles:{block:{backgroundColor:"transparent"}},blocks:new pe},T.getConfig().get("blockDefaults.container"))},_updateDefaults:function(){},validate:function(){var e=this.get("blocks").find(function(e){return!e.isValid()});if(e)return e.validationError},parse:function(e){return"container"===e.type&&M.a.has(e,"blocks")&&e.blocks.constructor===Array&&(e.blocks=new pe(e.blocks,{parse:!0})),e},getChildren:function(){var e=this.get("blocks").map(function(e){return[e,e.getChildren()]});return M.a.flatten(e)}}),ge.ContainerBlocksView=v.a.CollectionView.extend({className:"mailpoet_container",events:{click:"removeFocusFromAnyActiveElement"},childView:function(e){return T.getBlockTypeView(e.get("type"))},childViewOptions:function(){var e=M.a.clone(this.renderOptions);return void 0!==e.depth&&(e.depth+=1),{renderOptions:e}},emptyView:function(){return ge.ContainerBlockEmptyView},emptyViewOptions:function(){return{renderOptions:this.renderOptions}},initialize:function(e){this.renderOptions=e.renderOptions},onChildviewResizeStart:function(){this.triggerMethod("resizeStart")},onChildviewResizeStop:function(e){this.triggerMethod("resizeStop",e)},removeFocusFromAnyActiveElement:function(e){var t;e&&e.target&&(t=e.target.getAttribute("class"))&&-1!==t.indexOf("mailpoet_container_horizontal")&&document.activeElement.blur()}}),ge.ContainerBlockView=fe.BlockView.extend({regions:M.a.extend({},fe.BlockView.prototype.regions,{blocks:{el:"> .mailpoet_container",replaceElement:!0}}),className:"mailpoet_block mailpoet_container_block mailpoet_droppable_block mailpoet_droppable_layout_block",getTemplate:function(){return window.templates.containerBlock},events:M.a.extend({},fe.BlockView.prototype.events,{"click .mailpoet_newsletter_layer_selector":"toggleEditingLayer"}),ui:{tools:"> .mailpoet_tools"},behaviors:M.a.extend({},fe.BlockView.prototype.behaviors,{ContainerDropZoneBehavior:{},DraggableBehavior:{cloneOriginal:!0,hideOriginal:!0,onDrop:function(e){e.dragBehavior.view.model.destroy()},onDragSubstituteBy:function(e){var t,i;if(M.a.isFunction(e.view.onDragSubstituteBy))return(t=new(e.view.onDragSubstituteBy())).render(),i=t.$el.get(0).cloneNode(!0),t.destroy(),i},testAttachToInstance:function(e,t){return 1===t.renderOptions.depth}},HighlightEditingBehavior:{}}),onDragSubstituteBy:function(){if(1===this.renderOptions.depth){if(3===this.model.get("blocks").length)return ge.ThreeColumnContainerWidgetView;if(2===this.model.get("blocks").length)return ge.TwoColumnContainerWidgetView}return ge.OneColumnContainerWidgetView},initialize:function(e){fe.BlockView.prototype.initialize.apply(this,arguments),this.renderOptions=M.a.defaults(e.renderOptions||{},{})},onRender:function(){var e,t="";this.toolsView=new ge.ContainerBlockToolsView({model:this.model,tools:{settings:1===this.renderOptions.depth,delete:1===this.renderOptions.depth,duplicate:!0,move:1===this.renderOptions.depth,layerSelector:!1}}),this.showChildView("toolsRegion",this.toolsView),this.showChildView("blocks",new ge.ContainerBlocksView({collection:this.model.get("blocks"),renderOptions:this.renderOptions})),"string"==typeof(e=this.model.get("columnLayout"))&&(t="mailpoet_irregular_width_contents_container column_layout_"+e),this.$("> .mailpoet_container").attr("class","mailpoet_container mailpoet_container_"+this.model.get("orientation")+" "+t)},addHighlight:function(){1!==this.renderOptions.depth||this.$el.hasClass("mailpoet_container_layer_active")||(this.$(this.ui.tools).addClass("mailpoet_display_tools"),this.$el.addClass("mailpoet_highlight"),this.toolsView.triggerMethod("showTools"))},removeHighlight:function(){1!==this.renderOptions.depth||this.$el.hasClass("mailpoet_container_layer_active")||(this.$(this.ui.tools).removeClass("mailpoet_display_tools"),this.$el.removeClass("mailpoet_highlight"),this.toolsView.triggerMethod("hideTools"))},toggleEditingLayer:function(e){var t=this,i=this.$("> .mailpoet_tools .mailpoet_newsletter_layer_selector"),o=x()(".mailpoet_layer_overlay"),n=this.$("> .mailpoet_container"),r=function(){t.$el.removeClass("mailpoet_container_layer_active"),i.removeClass("mailpoet_container_layer_active"),n.removeClass("mailpoet_layer_highlight"),o.hide(),o.off("click")};i.hasClass("mailpoet_container_layer_active")?r():(t.$el.addClass("mailpoet_container_layer_active"),i.addClass("mailpoet_container_layer_active"),n.addClass("mailpoet_layer_highlight"),o.click(r),o.show()),e.stopPropagation()}}),ge.ContainerBlockEmptyView=v.a.View.extend({getTemplate:function(){return window.templates.containerEmpty},initialize:function(e){this.renderOptions=M.a.defaults(e.renderOptions||{},{})},templateContext:function(){return{isRoot:0===this.renderOptions.depth,emptyContainerMessage:this.renderOptions.emptyContainerMessage||""}}}),ge.ContainerBlockToolsView=fe.BlockToolsView.extend({getSettingsView:function(){return ge.ContainerBlockSettingsView}}),ge.ContainerBlockSettingsView=fe.BlockSettingsView.extend({behaviors:M.a.extend({},fe.BlockSettingsView.prototype.behaviors,{MediaManagerBehavior:{onSelect:"onImageSelect"}}),getTemplate:function(){return window.templates.containerBlockSettings},events:function(){return{"change .mailpoet_field_container_background_color":M.a.partial(this.changeColorField,"styles.block.backgroundColor"),"click .mailpoet_done_editing":"close","change .mailpoet_field_display_type":"changeDisplayType"}},initialize:function(){fe.BlockSettingsView.prototype.initialize.apply(this,arguments),this.model.trigger("startEditing"),this._columnsSettingsView=new ge.ContainerBlockColumnsSettingsView({collection:this.model.get("blocks")})},changeDisplayType:function(e){this.model.get("image").set("display",e.target.value),this.model.trigger("change")},onImageSelect:function(e){this.model.set("image.src",e.src),this.model.trigger("change"),this.render()}}),ge.ContainerBlockColumnsSettingsView=v.a.CollectionView.extend({childView:function(){return ge.ContainerBlockColumnSettingsView},childViewOptions:function(e,t){return{columnIndex:t}}}),ge.ContainerBlockColumnSettingsView=v.a.View.extend({getTemplate:function(){return window.templates.containerBlockColumnSettings},initialize:function(e){this.columnNumber=(e.columnIndex||0)+1},templateContext:function(){return{model:this.model.toJSON(),columnNumber:this.columnNumber}}}),ge.OneColumnContainerWidgetView=fe.WidgetView.extend({className:fe.WidgetView.prototype.className+" mailpoet_droppable_layout_block",getTemplate:function(){return window.templates.oneColumnLayoutInsertion},behaviors:{DraggableBehavior:{cloneOriginal:!0,drop:function(){return new ge.ContainerBlockModel({orientation:"horizontal",blocks:[new ge.ContainerBlockModel]})}}}}),ge.TwoColumnContainerWidgetView=fe.WidgetView.extend({className:fe.WidgetView.prototype.className+" mailpoet_droppable_layout_block",getTemplate:function(){return window.templates.twoColumnLayoutInsertion},behaviors:{DraggableBehavior:{cloneOriginal:!0,drop:function(){return new ge.ContainerBlockModel({orientation:"horizontal",blocks:[new ge.ContainerBlockModel,new ge.ContainerBlockModel]})}}}}),ge.ThreeColumnContainerWidgetView=fe.WidgetView.extend({className:fe.WidgetView.prototype.className+" mailpoet_droppable_layout_block",getTemplate:function(){return window.templates.threeColumnLayoutInsertion},behaviors:{DraggableBehavior:{cloneOriginal:!0,drop:function(){return new ge.ContainerBlockModel({orientation:"horizontal",blocks:[new ge.ContainerBlockModel,new ge.ContainerBlockModel,new ge.ContainerBlockModel]})}}}}),ge.TwoColumn12ContainerWidgetView=fe.WidgetView.extend({className:fe.WidgetView.prototype.className+" mailpoet_droppable_layout_block",getTemplate:function(){return window.templates.twoColumn12LayoutInsertion},behaviors:{DraggableBehavior:{cloneOriginal:!0,drop:function(){var e=new ge.ContainerBlockModel({orientation:"horizontal",blocks:[new ge.ContainerBlockModel,new ge.ContainerBlockModel]});return e.set("columnLayout","1_2"),e}}}}),ge.TwoColumn21ContainerWidgetView=fe.WidgetView.extend({className:fe.WidgetView.prototype.className+" mailpoet_droppable_layout_block",getTemplate:function(){return window.templates.twoColumn21LayoutInsertion},behaviors:{DraggableBehavior:{cloneOriginal:!0,drop:function(){var e=new ge.ContainerBlockModel({orientation:"horizontal",blocks:[new ge.ContainerBlockModel,new ge.ContainerBlockModel]});return e.set("columnLayout","2_1"),e}}}}),T.on("before:start",function(e){e.registerBlockType("container",{blockModel:ge.ContainerBlockModel,blockView:ge.ContainerBlockView}),e.registerLayoutWidget({name:"oneColumnLayout",priority:100,widgetView:ge.OneColumnContainerWidgetView}),e.registerLayoutWidget({name:"twoColumnLayout",priority:100,widgetView:ge.TwoColumnContainerWidgetView}),e.registerLayoutWidget({name:"threeColumnLayout",priority:100,widgetView:ge.ThreeColumnContainerWidgetView}),e.registerLayoutWidget({name:"twoColumn12Layout",priority:100,widgetView:ge.TwoColumn12ContainerWidgetView}),e.registerLayoutWidget({name:"twoColumn21Layout",priority:100,widgetView:ge.TwoColumn21ContainerWidgetView})});var me={},_e=ue;me.ButtonBlockModel=_e.BlockModel.extend({defaults:function(){return this._getDefaults({type:"button",text:"Button",url:"",styles:{block:{backgroundColor:"#ff0000",borderColor:"#cccccc",borderWidth:"1px",borderRadius:"4px",borderStyle:"solid",width:"200px",lineHeight:"40px",fontColor:"#000000",fontFamily:"Arial",fontSize:"16px",fontWeight:"normal",textAlign:"center"}}},T.getConfig().get("blockDefaults.button"))}}),me.ButtonBlockView=_e.BlockView.extend({className:"mailpoet_block mailpoet_button_block mailpoet_droppable_block",getTemplate:function(){return window.templates.buttonBlock},onDragSubstituteBy:function(){return me.ButtonWidgetView},behaviors:M.a.extend({},_e.BlockView.prototype.behaviors,{ShowSettingsBehavior:{}}),initialize:function(){_e.BlockView.prototype.initialize.apply(this,arguments),this._replaceButtonStylesHandler=function(e){this.model.set(e)}.bind(this),T.getChannel().on("replaceAllButtonStyles",this._replaceButtonStylesHandler)},onRender:function(){this.toolsView=new me.ButtonBlockToolsView({model:this.model}),this.showChildView("toolsRegion",this.toolsView)}}),me.ButtonBlockToolsView=_e.BlockToolsView.extend({getSettingsView:function(){return me.ButtonBlockSettingsView}}),me.ButtonBlockSettingsView=_e.BlockSettingsView.extend({getTemplate:function(){return window.templates.buttonBlockSettings},events:function(){return{"input .mailpoet_field_button_text":M.a.partial(this.changeField,"text"),"input .mailpoet_field_button_url":M.a.partial(this.changeField,"url"),"change .mailpoet_field_button_alignment":M.a.partial(this.changeField,"styles.block.textAlign"),"change .mailpoet_field_button_font_color":M.a.partial(this.changeColorField,"styles.block.fontColor"),"change .mailpoet_field_button_font_family":M.a.partial(this.changeField,"styles.block.fontFamily"),"change .mailpoet_field_button_font_size":M.a.partial(this.changeField,"styles.block.fontSize"),"change .mailpoet_field_button_background_color":M.a.partial(this.changeColorField,"styles.block.backgroundColor"),"change .mailpoet_field_button_border_color":M.a.partial(this.changeColorField,"styles.block.borderColor"),"change .mailpoet_field_button_font_weight":"changeFontWeight","input .mailpoet_field_button_border_width":M.a.partial(this.updateValueAndCall,".mailpoet_field_button_border_width_input",M.a.partial(this.changePixelField,"styles.block.borderWidth").bind(this)),"change .mailpoet_field_button_border_width":M.a.partial(this.updateValueAndCall,".mailpoet_field_button_border_width_input",M.a.partial(this.changePixelField,"styles.block.borderWidth").bind(this)),"input .mailpoet_field_button_border_width_input":M.a.partial(this.updateValueAndCall,".mailpoet_field_button_border_width",M.a.partial(this.changePixelField,"styles.block.borderWidth").bind(this)),"input .mailpoet_field_button_border_radius":M.a.partial(this.updateValueAndCall,".mailpoet_field_button_border_radius_input",M.a.partial(this.changePixelField,"styles.block.borderRadius").bind(this)),"change .mailpoet_field_button_border_radius":M.a.partial(this.updateValueAndCall,".mailpoet_field_button_border_radius_input",M.a.partial(this.changePixelField,"styles.block.borderRadius").bind(this)),"input .mailpoet_field_button_border_radius_input":M.a.partial(this.updateValueAndCall,".mailpoet_field_button_border_radius",M.a.partial(this.changePixelField,"styles.block.borderRadius").bind(this)),"input .mailpoet_field_button_width":M.a.partial(this.updateValueAndCall,".mailpoet_field_button_width_input",M.a.partial(this.changePixelField,"styles.block.width").bind(this)),"change .mailpoet_field_button_width":M.a.partial(this.updateValueAndCall,".mailpoet_field_button_width_input",M.a.partial(this.changePixelField,"styles.block.width").bind(this)),"input .mailpoet_field_button_width_input":M.a.partial(this.updateValueAndCall,".mailpoet_field_button_width",M.a.partial(this.changePixelField,"styles.block.width").bind(this)),"input .mailpoet_field_button_line_height":M.a.partial(this.updateValueAndCall,".mailpoet_field_button_line_height_input",M.a.partial(this.changePixelField,"styles.block.lineHeight").bind(this)),"change .mailpoet_field_button_line_height":M.a.partial(this.updateValueAndCall,".mailpoet_field_button_line_height_input",M.a.partial(this.changePixelField,"styles.block.lineHeight").bind(this)),"input .mailpoet_field_button_line_height_input":M.a.partial(this.updateValueAndCall,".mailpoet_field_button_line_height",M.a.partial(this.changePixelField,"styles.block.lineHeight").bind(this)),"click .mailpoet_field_button_replace_all_styles":"applyToAll","click .mailpoet_done_editing":"close"}},templateContext:function(){return M.a.extend({},_e.BlockView.prototype.templateContext.apply(this,arguments),{availableStyles:T.getAvailableStyles().toJSON(),renderOptions:this.renderOptions})},applyToAll:function(){T.getChannel().trigger("replaceAllButtonStyles",M.a.pick(this.model.toJSON(),"styles","type"))},updateValueAndCall:function(e,t,i){this.$(e).val(x()(i.target).val()),t(i)},changeFontWeight:function(e){var t=!!x()(e.target).prop("checked");this.model.set("styles.block.fontWeight",t?x()(e.target).val():"normal")}}),me.ButtonWidgetView=_e.WidgetView.extend({id:"automation_editor_block_button",getTemplate:function(){return window.templates.buttonInsertion},behaviors:{DraggableBehavior:{cloneOriginal:!0,drop:function(){return new me.ButtonBlockModel}}}}),T.on("before:start",function(e){e.registerBlockType("button",{blockModel:me.ButtonBlockModel,blockView:me.ButtonBlockView}),e.registerWidget({name:"button",widgetView:me.ButtonWidgetView,priority:92})});var ve,we=me,ye=i(15),be=i.n(ye),xe={},ke=ue;xe.ImageBlockModel=ke.BlockModel.extend({defaults:function(){return this._getDefaults({type:"image",link:"",src:"",alt:"An image of...",fullWidth:!0,width:"64px",height:"64px",styles:{block:{textAlign:"center"}}},T.getConfig().get("blockDefaults.image"))},_updateDefaults:function(){}}),xe.ImageBlockView=ke.BlockView.extend({className:"mailpoet_block mailpoet_image_block mailpoet_droppable_block",getTemplate:function(){return window.templates.imageBlock},onDragSubstituteBy:function(){return xe.ImageWidgetView},templateContext:function(){return M.a.extend({imageMissingSrc:T.getConfig().get("urls.imageMissing")},ke.BlockView.prototype.templateContext.apply(this))},behaviors:M.a.extend({},ke.BlockView.prototype.behaviors,{ResizableBehavior:{elementSelector:".mailpoet_image",resizeHandleSelector:".mailpoet_image_resize_handle",onResize:function(e){var t=this.$(".mailpoet_image").offset(),i=e.pageX-t.left;this.view.model.set("width",i+"px")}},ShowSettingsBehavior:{ignoreFrom:".mailpoet_image_resize_handle"}}),onRender:function(){var e=this;this.toolsView=new xe.ImageBlockToolsView({model:this.model}),this.showChildView("toolsRegion",this.toolsView),this.model.get("fullWidth")?this.$el.addClass("mailpoet_full_image"):this.$el.removeClass("mailpoet_full_image"),this.model.get("width")&&"auto"!==this.model.get("width")||this.$el.find("img").on("load",function(){e.model.set("width",this.width),e.model.set("height",this.height)}),this.$(".mailpoet_content").css("width",this.model.get("width"))}}),xe.ImageBlockToolsView=ke.BlockToolsView.extend({getSettingsView:function(){return xe.ImageBlockSettingsView}}),xe.ImageBlockSettingsView=ke.BlockSettingsView.extend({behaviors:M.a.extend({},ke.BlockSettingsView.prototype.behaviors,{MediaManagerBehavior:{onSelect:"onImageSelect"}}),onRender:function(){c.a.helpTooltip.show(document.getElementById("tooltip-designer-full-width"),{tooltipId:"tooltip-editor-full-width",tooltip:c.a.I18n.t("helpTooltipDesignerFullWidth")}),c.a.helpTooltip.show(document.getElementById("tooltip-designer-ideal-width"),{tooltipId:"tooltip-editor-ideal-width",tooltip:c.a.I18n.t("helpTooltipDesignerIdealWidth")})},getTemplate:function(){return window.templates.imageBlockSettings},events:function(){return{"input .mailpoet_field_image_link":M.a.partial(this.changeField,"link"),"input .mailpoet_field_image_alt_text":M.a.partial(this.changeField,"alt"),"change .mailpoet_field_image_full_width":M.a.partial(this.changeBoolCheckboxField,"fullWidth"),"change .mailpoet_field_image_alignment":M.a.partial(this.changeField,"styles.block.textAlign"),"click .mailpoet_done_editing":"close","input .mailpoet_field_image_width":M.a.partial(this.updateValueAndCall,".mailpoet_field_image_width_input",M.a.partial(this.changePixelField,"width").bind(this)),"change .mailpoet_field_image_width":M.a.partial(this.updateValueAndCall,".mailpoet_field_image_width_input",M.a.partial(this.changePixelField,"width").bind(this)),"input .mailpoet_field_image_width_input":M.a.partial(this.updateValueAndCall,".mailpoet_field_image_width",M.a.partial(this.changePixelField,"width").bind(this))}},modelEvents:function(){return{"change:maxWidth":"updateMaxWidth","change:width":"updateWidth"}},updateValueAndCall:function(e,t,i){this.$(e).val(x()(i.target).val()),t(i)},updateMaxWidth:function(){var e=be()(this.model.get("maxWidth"),10);this.$(".mailpoet_field_image_width").attr("max",e),this.$(".mailpoet_field_image_width_input").attr("max",e)},updateWidth:function(){var e=be()(this.model.get("width"),10);this.$(".mailpoet_field_image_width").val(e),this.$(".mailpoet_field_image_width_input").val(e)},onImageSelect:function(e){null===e.src?this.model.set({src:""}):this.model.set(e),this.render()}}),ve=ke.WidgetView.extend({id:"automation_editor_block_image",getTemplate:function(){return window.templates.imageInsertion},behaviors:{DraggableBehavior:{cloneOriginal:!0,drop:function(){return new xe.ImageBlockModel},onDrop:function(e){e.droppedView.triggerMethod("showSettings",{showImageManager:!0})}}}}),xe.ImageWidgetView=ve,T.on("before:start",function(e){e.registerBlockType("image",{blockModel:xe.ImageBlockModel,blockView:xe.ImageBlockView}),e.registerWidget({name:"image",widgetView:xe.ImageWidgetView,priority:91})});var Ce={},Se=ue;Ce.DividerBlockModel=Se.BlockModel.extend({defaults:function(){return this._getDefaults({type:"divider",styles:{block:{backgroundColor:"transparent",padding:"12px",borderStyle:"solid",borderWidth:"1px",borderColor:"#000000"}}},T.getConfig().get("blockDefaults.divider"))}}),Ce.DividerBlockView=Se.BlockView.extend({className:"mailpoet_block mailpoet_divider_block mailpoet_droppable_block",getTemplate:function(){return window.templates.dividerBlock},modelEvents:M.a.omit(Se.BlockView.prototype.modelEvents,"change"),behaviors:M.a.defaults({ResizableBehavior:{elementSelector:".mailpoet_content",resizeHandleSelector:".mailpoet_resize_handle",transformationFunction:function(e){return e/2},minLength:0,modelField:"styles.block.padding"},ShowSettingsBehavior:{ignoreFrom:".mailpoet_resize_handle"}},Se.BlockView.prototype.behaviors),onDragSubstituteBy:function(){return Ce.DividerWidgetView},initialize:function(){var e=this;Se.BlockView.prototype.initialize.apply(this,arguments),this._replaceDividerHandler=function(t){e.model.set(t),e.model.trigger("applyToAll")},T.getChannel().on("replaceAllDividers",this._replaceDividerHandler),this.listenTo(this.model,"change:src change:styles.block.backgroundColor change:styles.block.borderStyle change:styles.block.borderWidth change:styles.block.borderColor applyToAll",this.render),this.listenTo(this.model,"change:styles.block.padding",this.changePadding)},templateContext:function(){return M.a.extend({totalHeight:2*be()(this.model.get("styles.block.padding"),10)+be()(this.model.get("styles.block.borderWidth"),10)+"px"},Se.BlockView.prototype.templateContext.apply(this))},onRender:function(){this.toolsView=new Ce.DividerBlockToolsView({model:this.model}),this.showChildView("toolsRegion",this.toolsView)},onBeforeDestroy:function(){T.getChannel().off("replaceAllDividers",this._replaceDividerHandler),this.stopListening(this.model)},changePadding:function(){this.$(".mailpoet_content").css("padding-top",this.model.get("styles.block.padding")),this.$(".mailpoet_content").css("padding-bottom",this.model.get("styles.block.padding")),this.$(".mailpoet_resize_handle_text").text(2*be()(this.model.get("styles.block.padding"),10)+be()(this.model.get("styles.block.borderWidth"),10)+"px")}}),Ce.DividerBlockToolsView=Se.BlockToolsView.extend({getSettingsView:function(){return Ce.DividerBlockSettingsView}}),Ce.DividerBlockSettingsView=Se.BlockSettingsView.extend({getTemplate:function(){return window.templates.dividerBlockSettings},events:function(){return{"click .mailpoet_field_divider_style":"changeStyle","input .mailpoet_field_divider_border_width":M.a.partial(this.updateValueAndCall,".mailpoet_field_divider_border_width_input",M.a.partial(this.changePixelField,"styles.block.borderWidth").bind(this)),"change .mailpoet_field_divider_border_width":M.a.partial(this.updateValueAndCall,".mailpoet_field_divider_border_width_input",M.a.partial(this.changePixelField,"styles.block.borderWidth").bind(this)),"input .mailpoet_field_divider_border_width_input":M.a.partial(this.updateValueAndCall,".mailpoet_field_divider_border_width",M.a.partial(this.changePixelField,"styles.block.borderWidth").bind(this)),"change .mailpoet_field_divider_border_color":M.a.partial(this.changeColorField,"styles.block.borderColor"),"change .mailpoet_field_divider_background_color":M.a.partial(this.changeColorField,"styles.block.backgroundColor"),"click .mailpoet_button_divider_apply_to_all":"applyToAll","click .mailpoet_done_editing":"close"}},modelEvents:function(){return{"change:styles.block.borderColor":"repaintDividerStyleOptions"}},templateContext:function(){return M.a.extend({},Se.BlockView.prototype.templateContext.apply(this,arguments),{availableStyles:T.getAvailableStyles().toJSON(),renderOptions:this.renderOptions})},changeStyle:function(e){var t=x()(e.currentTarget).data("style");this.model.set("styles.block.borderStyle",t),this.$(".mailpoet_field_divider_style").removeClass("mailpoet_active_divider_style"),this.$('.mailpoet_field_divider_style[data-style="'+t+'"]').addClass("mailpoet_active_divider_style")},repaintDividerStyleOptions:function(){this.$(".mailpoet_field_divider_style > div").css("border-top-color",this.model.get("styles.block.borderColor"))},applyToAll:function(){T.getChannel().trigger("replaceAllDividers",this.model.toJSON())},updateValueAndCall:function(e,t,i){this.$(e).val(x()(i.target).val()),t(i)}}),Ce.DividerWidgetView=Se.WidgetView.extend({id:"automation_editor_block_divider",getTemplate:function(){return window.templates.dividerInsertion},behaviors:{DraggableBehavior:{cloneOriginal:!0,drop:function(){return new Ce.DividerBlockModel}}}}),T.on("before:start",function(e){e.registerBlockType("divider",{blockModel:Ce.DividerBlockModel,blockView:Ce.DividerBlockView}),e.registerWidget({name:"divider",widgetView:Ce.DividerWidgetView,priority:93})});var Te=Ce,Ve={},Be=ue;Ve.TextBlockModel=Be.BlockModel.extend({defaults:function(){return this._getDefaults({type:"text",text:"Edit this to insert text"},T.getConfig().get("blockDefaults.text"))},_updateDefaults:function(){}}),Ve.TextBlockView=Be.BlockView.extend({className:"mailpoet_block mailpoet_text_block mailpoet_droppable_block",getTemplate:function(){return window.templates.textBlock},modelEvents:M.a.omit(Be.BlockView.prototype.modelEvents,"change"),behaviors:M.a.extend({},Be.BlockView.prototype.behaviors,{TextEditorBehavior:{toolbar1:"formatselect bold italic forecolor | link unlink",toolbar2:"alignleft aligncenter alignright alignjustify | bullist numlist blockquote | code mailpoet_shortcodes",validElements:"p[class|style],span[class|style],a[href|class|title|target|style],h1[class|style],h2[class|style],h3[class|style],ol[class|style],ul[class|style],li[class|style],strong[class|style],em[class|style],strike,br,blockquote[class|style],table[class|style],tr[class|style],th[class|style],td[class|style],del",invalidElements:"script",blockFormats:"Heading 1=h1;Heading 2=h2;Heading 3=h3;Paragraph=p",plugins:"link lists code textcolor colorpicker mailpoet_shortcodes paste",configurationFilter:function(e){return M.a.extend({},e,{mailpoet_shortcodes:T.getConfig().get("shortcodes").toJSON(),mailpoet_shortcodes_window_title:c.a.I18n.t("shortcodesWindowTitle")})}}}),initialize:function(e){Be.BlockView.prototype.initialize.apply(this,arguments),this.renderOptions=M.a.defaults(e.renderOptions||{},{disableTextEditor:!1}),this.disableTextEditor=this.renderOptions.disableTextEditor},onDragSubstituteBy:function(){return Ve.TextWidgetView},onRender:function(){this.toolsView=new Ve.TextBlockToolsView({model:this.model,tools:{settings:!1}}),this.showChildView("toolsRegion",this.toolsView)},onTextEditorChange:function(e){this.model.set("text",e)},onTextEditorFocus:function(){this.disableDragging(),this.disableShowingTools()},onTextEditorBlur:function(){this.enableDragging(),this.enableShowingTools()}}),Ve.TextBlockToolsView=Be.BlockToolsView.extend({getSettingsView:function(){return Ve.TextBlockSettingsView}}),Ve.TextBlockSettingsView=Be.BlockSettingsView.extend({getTemplate:function(){return window.templates.textBlockSettings}}),Ve.TextWidgetView=Be.WidgetView.extend({id:"automation_editor_block_text",getTemplate:function(){return window.templates.textInsertion},behaviors:{DraggableBehavior:{cloneOriginal:!0,drop:function(){return new Ve.TextBlockModel}}}}),T.on("before:start",function(e){e.registerBlockType("text",{blockModel:Ve.TextBlockModel,blockView:Ve.TextBlockView}),e.registerWidget({name:"text",widgetView:Ve.TextWidgetView,priority:90})});var Ee={},Me=ue;Ee.SpacerBlockModel=Me.BlockModel.extend({defaults:function(){return this._getDefaults({type:"spacer",styles:{block:{backgroundColor:"transparent",height:"40px"}}},T.getConfig().get("blockDefaults.spacer"))}}),Ee.SpacerBlockView=Me.BlockView.extend({className:"mailpoet_block mailpoet_spacer_block mailpoet_droppable_block",getTemplate:function(){return window.templates.spacerBlock},behaviors:M.a.defaults({ResizableBehavior:{elementSelector:".mailpoet_spacer",resizeHandleSelector:".mailpoet_resize_handle",minLength:20,modelField:"styles.block.height"},ShowSettingsBehavior:{ignoreFrom:".mailpoet_resize_handle"}},Me.BlockView.prototype.behaviors),modelEvents:M.a.omit(Me.BlockView.prototype.modelEvents,"change"),onDragSubstituteBy:function(){return Ee.SpacerWidgetView},initialize:function(){Me.BlockView.prototype.initialize.apply(this,arguments),this.listenTo(this.model,"change:styles.block.backgroundColor",this.render),this.listenTo(this.model,"change:styles.block.height",this.changeHeight)},onRender:function(){this.toolsView=new Ee.SpacerBlockToolsView({model:this.model}),this.showChildView("toolsRegion",this.toolsView)},changeHeight:function(){this.$(".mailpoet_spacer").css("height",this.model.get("styles.block.height")),this.$(".mailpoet_resize_handle_text").text(this.model.get("styles.block.height"))},onBeforeDestroy:function(){this.stopListening(this.model)}}),Ee.SpacerBlockToolsView=Me.BlockToolsView.extend({getSettingsView:function(){return Ee.SpacerBlockSettingsView}}),Ee.SpacerBlockSettingsView=Me.BlockSettingsView.extend({getTemplate:function(){return window.templates.spacerBlockSettings},events:function(){return{"change .mailpoet_field_spacer_background_color":M.a.partial(this.changeColorField,"styles.block.backgroundColor"),"click .mailpoet_done_editing":"close"}}}),Ee.SpacerWidgetView=Me.WidgetView.extend({id:"automation_editor_block_spacer",getTemplate:function(){return window.templates.spacerInsertion},behaviors:{DraggableBehavior:{cloneOriginal:!0,drop:function(){return new Ee.SpacerBlockModel}}}}),T.on("before:start",function(e){e.registerBlockType("spacer",{blockModel:Ee.SpacerBlockModel,blockView:Ee.SpacerBlockView}),e.registerWidget({name:"spacer",widgetView:Ee.SpacerWidgetView,priority:94})});var Pe={},Ae=ue;Pe.FooterBlockModel=Ae.BlockModel.extend({defaults:function(){return this._getDefaults({type:"footer",text:'<a href="[link:subscription_unsubscribe_url]">Unsubscribe</a> | <a href="[link:subscription_manage_url]">Manage subscription</a><br /><b>Add your postal address here!</b>',styles:{block:{backgroundColor:"transparent"},text:{fontColor:"#000000",fontFamily:"Arial",fontSize:"12px",textAlign:"center"},link:{fontColor:"#0000ff",textDecoration:"none"}}},T.getConfig().get("blockDefaults.footer"))},_updateDefaults:function(){T.getConfig().set("blockDefaults.footer",M.a.omit(this.toJSON(),"text"))}}),Pe.FooterBlockView=Ae.BlockView.extend({className:"mailpoet_block mailpoet_footer_block mailpoet_droppable_block",getTemplate:function(){return window.templates.footerBlock},modelEvents:M.a.extend({"change:styles.block.backgroundColor change:styles.text.fontColor change:styles.text.fontFamily change:styles.text.fontSize change:styles.text.textAlign change:styles.link.fontColor change:styles.link.textDecoration":"render"},M.a.omit(Ae.BlockView.prototype.modelEvents,"change")),behaviors:M.a.extend({},Ae.BlockView.prototype.behaviors,{TextEditorBehavior:{configurationFilter:function(e){return M.a.extend({},e,{mailpoet_shortcodes:T.getConfig().get("shortcodes").toJSON(),mailpoet_shortcodes_window_title:c.a.I18n.t("shortcodesWindowTitle")})}}}),onDragSubstituteBy:function(){return Pe.FooterWidgetView},onRender:function(){this.toolsView=new Pe.FooterBlockToolsView({model:this.model}),this.showChildView("toolsRegion",this.toolsView)},onTextEditorChange:function(e){this.model.set("text",e)},onTextEditorFocus:function(){this.disableDragging(),this.disableShowingTools()},onTextEditorBlur:function(){this.enableDragging(),this.enableShowingTools()}}),Pe.FooterBlockToolsView=Ae.BlockToolsView.extend({getSettingsView:function(){return Pe.FooterBlockSettingsView}}),Pe.FooterBlockSettingsView=Ae.BlockSettingsView.extend({getTemplate:function(){return window.templates.footerBlockSettings},events:function(){return{"change .mailpoet_field_footer_text_color":M.a.partial(this.changeColorField,"styles.text.fontColor"),"change .mailpoet_field_footer_text_font_family":M.a.partial(this.changeField,"styles.text.fontFamily"),"change .mailpoet_field_footer_text_size":M.a.partial(this.changeField,"styles.text.fontSize"),"change #mailpoet_field_footer_link_color":M.a.partial(this.changeColorField,"styles.link.fontColor"),"change #mailpoet_field_footer_link_underline":function(e){this.model.set("styles.link.textDecoration",e.target.checked?e.target.value:"none")},"change .mailpoet_field_footer_background_color":M.a.partial(this.changeColorField,"styles.block.backgroundColor"),"change .mailpoet_field_footer_alignment":M.a.partial(this.changeField,"styles.text.textAlign"),"click .mailpoet_done_editing":"close"}},templateContext:function(){return M.a.extend({},Ae.BlockView.prototype.templateContext.apply(this,arguments),{availableStyles:T.getAvailableStyles().toJSON()})}}),Pe.FooterWidgetView=Ae.WidgetView.extend({id:"automation_editor_block_footer",getTemplate:function(){return window.templates.footerInsertion},behaviors:{DraggableBehavior:{cloneOriginal:!0,drop:function(){return new Pe.FooterBlockModel}}}}),T.on("before:start",function(e){e.registerBlockType("footer",{blockModel:Pe.FooterBlockModel,blockView:Pe.FooterBlockView}),e.registerWidget({name:"footer",widgetView:Pe.FooterWidgetView,priority:100})});var De={},Re=ue;De.HeaderBlockModel=Re.BlockModel.extend({defaults:function(){return this._getDefaults({type:"header",text:'Display problems? <a href="[link:newsletter_view_in_browser_url]">View it in your browser</a>',styles:{block:{backgroundColor:"transparent"},text:{fontColor:"#000000",fontFamily:"Arial",fontSize:"12px",textAlign:"center"},link:{fontColor:"#0000ff",textDecoration:"underline"}}},T.getConfig().get("blockDefaults.header"))},_updateDefaults:function(){T.getConfig().set("blockDefaults.header",M.a.omit(this.toJSON(),"text"))}}),De.HeaderBlockView=Re.BlockView.extend({className:"mailpoet_block mailpoet_header_block mailpoet_droppable_block",getTemplate:function(){return window.templates.headerBlock},modelEvents:M.a.extend({"change:styles.block.backgroundColor change:styles.text.fontColor change:styles.text.fontFamily change:styles.text.fontSize change:styles.text.textAlign change:styles.link.fontColor change:styles.link.textDecoration":"render"},M.a.omit(Re.BlockView.prototype.modelEvents,"change")),behaviors:M.a.extend({},Re.BlockView.prototype.behaviors,{TextEditorBehavior:{configurationFilter:function(e){return M.a.extend({},e,{mailpoet_shortcodes:T.getConfig().get("shortcodes").toJSON(),mailpoet_shortcodes_window_title:c.a.I18n.t("shortcodesWindowTitle")})}}}),onDragSubstituteBy:function(){return De.HeaderWidgetView},onRender:function(){this.toolsView=new De.HeaderBlockToolsView({model:this.model}),this.showChildView("toolsRegion",this.toolsView)},onTextEditorChange:function(e){this.model.set("text",e)},onTextEditorFocus:function(){this.disableDragging(),this.disableShowingTools()},onTextEditorBlur:function(){this.enableDragging(),this.enableShowingTools()}}),De.HeaderBlockToolsView=Re.BlockToolsView.extend({getSettingsView:function(){return De.HeaderBlockSettingsView}}),De.HeaderBlockSettingsView=Re.BlockSettingsView.extend({getTemplate:function(){return window.templates.headerBlockSettings},events:function(){return{"change .mailpoet_field_header_text_color":M.a.partial(this.changeColorField,"styles.text.fontColor"),"change .mailpoet_field_header_text_font_family":M.a.partial(this.changeField,"styles.text.fontFamily"),"change .mailpoet_field_header_text_size":M.a.partial(this.changeField,"styles.text.fontSize"),"change #mailpoet_field_header_link_color":M.a.partial(this.changeColorField,"styles.link.fontColor"),"change #mailpoet_field_header_link_underline":function(e){this.model.set("styles.link.textDecoration",e.target.checked?e.target.value:"none")},"change .mailpoet_field_header_background_color":M.a.partial(this.changeColorField,"styles.block.backgroundColor"),"change .mailpoet_field_header_alignment":M.a.partial(this.changeField,"styles.text.textAlign"),"click .mailpoet_done_editing":"close"}},templateContext:function(){return M.a.extend({},Re.BlockView.prototype.templateContext.apply(this,arguments),{availableStyles:T.getAvailableStyles().toJSON()})}}),De.HeaderWidgetView=Re.WidgetView.extend({id:"automation_editor_block_header",getTemplate:function(){return window.templates.headerInsertion},behaviors:{DraggableBehavior:{cloneOriginal:!0,drop:function(){return new De.HeaderBlockModel}}}}),T.on("before:start",function(e){e.registerBlockType("header",{blockModel:De.HeaderBlockModel,blockView:De.HeaderBlockView}),e.registerWidget({name:"header",widgetView:De.HeaderWidgetView,priority:99})});var Oe={},Fe=ue;Oe.ALCSupervisor=B.a.extend({initialize:function(){this.listenTo(T.getChannel(),"automatedLatestContentRefresh",M.a.debounce(this.refresh,500))},refresh:function(){var e,t=T.findModels(function(e){return"automatedLatestContent"===e.get("type")})||[];0!==t.length&&(e=M.a.map(t,function(e){return e.toJSON()}),I.getBulkTransformedPosts({blocks:e}).then(M.a.partial(this.refreshBlocks,t)))},refreshBlocks:function(e,t){M.a.each(M.a.zip(e,t),function(e){var t=e[0],i=e[1];t.trigger("refreshPosts",i)})}}),Oe.AutomatedLatestContentBlockModel=Fe.BlockModel.extend({stale:["_container"],defaults:function(){return this._getDefaults({type:"automatedLatestContent",withLayout:!1,amount:"5",contentType:"post",terms:[],inclusionType:"include",displayType:"excerpt",titleFormat:"h1",titleAlignment:"left",titleIsLink:!1,imageFullWidth:!1,featuredImagePosition:"belowTitle",showAuthor:"no",authorPrecededBy:"Author:",showCategories:"no",categoriesPrecededBy:"Categories:",readMoreType:"button",readMoreText:"Read more",readMoreButton:{text:"Read more",url:"[postLink]"},sortBy:"newest",showDivider:!0,divider:{},_container:new(T.getBlockTypeModel("container"))},T.getConfig().get("blockDefaults.automatedLatestContent"))},relations:function(){return{readMoreButton:T.getBlockTypeModel("button"),divider:T.getBlockTypeModel("divider"),_container:T.getBlockTypeModel("container")}},initialize:function(){Fe.BlockView.prototype.initialize.apply(this,arguments),this.on("change:amount change:contentType change:terms change:inclusionType change:displayType change:titleFormat change:featuredImagePosition change:titleAlignment change:titleIsLink change:imageFullWidth change:showAuthor change:authorPrecededBy change:showCategories change:categoriesPrecededBy change:readMoreType change:readMoreText change:sortBy change:showDivider",this._handleChanges,this),this.listenTo(this.get("readMoreButton"),"change",this._handleChanges),this.listenTo(this.get("divider"),"change",this._handleChanges),this.on("add remove update reset",this._handleChanges),this.on("refreshPosts",this.updatePosts,this)},updatePosts:function(e){this.get("_container.blocks").reset(e,{parse:!0})},_handleChanges:function(){this._updateDefaults(),T.getChannel().trigger("automatedLatestContentRefresh")}}),Oe.AutomatedLatestContentBlockView=Fe.BlockView.extend({className:"mailpoet_block mailpoet_automated_latest_content_block mailpoet_droppable_block",initialize:function(){T.getChannel().on("replaceAllButtonStyles",function(e){this.model.set({readMoreButton:e})}.bind(this))},getTemplate:function(){return window.templates.automatedLatestContentBlock},regions:{toolsRegion:".mailpoet_tools",postsRegion:".mailpoet_automated_latest_content_block_posts"},modelEvents:M.a.extend(M.a.omit(Fe.BlockView.prototype.modelEvents,"change"),{postsChanged:"render"}),events:{"click .mailpoet_automated_latest_content_block_overlay":"showSettings"},onDragSubstituteBy:function(){return Oe.AutomatedLatestContentWidgetView},onRender:function(){var e=T.getBlockTypeView("container"),t={disableTextEditor:!0,disableDragAndDrop:!0,emptyContainerMessage:c.a.I18n.t("noPostsToDisplay")};this.toolsView=new Oe.AutomatedLatestContentBlockToolsView({model:this.model}),this.showChildView("toolsRegion",this.toolsView),this.showChildView("postsRegion",new e({model:this.model.get("_container"),renderOptions:t}))}}),Oe.AutomatedLatestContentBlockToolsView=Fe.BlockToolsView.extend({getSettingsView:function(){return Oe.AutomatedLatestContentBlockSettingsView}}),Oe.AutomatedLatestContentBlockSettingsView=Fe.BlockSettingsView.extend({getTemplate:function(){return window.templates.automatedLatestContentBlockSettings},events:function(){return{"click .mailpoet_automated_latest_content_hide_display_options":"toggleDisplayOptions","click .mailpoet_automated_latest_content_show_display_options":"toggleDisplayOptions","click .mailpoet_automated_latest_content_select_button":"showButtonSettings","click .mailpoet_automated_latest_content_select_divider":"showDividerSettings","change .mailpoet_automated_latest_content_read_more_type":"changeReadMoreType","change .mailpoet_automated_latest_content_display_type":"changeDisplayType","change .mailpoet_automated_latest_content_title_format":"changeTitleFormat","change .mailpoet_automated_latest_content_title_as_links":M.a.partial(this.changeBoolField,"titleIsLink"),"change .mailpoet_automated_latest_content_show_divider":M.a.partial(this.changeBoolField,"showDivider"),"input .mailpoet_automated_latest_content_show_amount":M.a.partial(this.changeField,"amount"),"change .mailpoet_automated_latest_content_content_type":M.a.partial(this.changeField,"contentType"),"change .mailpoet_automated_latest_content_include_or_exclude":M.a.partial(this.changeField,"inclusionType"),"change .mailpoet_automated_latest_content_title_alignment":M.a.partial(this.changeField,"titleAlignment"),"change .mailpoet_automated_latest_content_image_full_width":M.a.partial(this.changeBoolField,"imageFullWidth"),"change .mailpoet_automated_latest_content_featured_image_position":M.a.partial(this.changeField,"featuredImagePosition"),"change .mailpoet_automated_latest_content_show_author":M.a.partial(this.changeField,"showAuthor"),"input .mailpoet_automated_latest_content_author_preceded_by":M.a.partial(this.changeField,"authorPrecededBy"),"change .mailpoet_automated_latest_content_show_categories":M.a.partial(this.changeField,"showCategories"),"input .mailpoet_automated_latest_content_categories":M.a.partial(this.changeField,"categoriesPrecededBy"),"input .mailpoet_automated_latest_content_read_more_text":M.a.partial(this.changeField,"readMoreText"),"change .mailpoet_automated_latest_content_sort_by":M.a.partial(this.changeField,"sortBy"),"click .mailpoet_done_editing":"close"}},onRender:function(){var e=this;I.getPostTypes().done(M.a.bind(this._updateContentTypes,this)),this.$(".mailpoet_automated_latest_content_categories_and_tags").select2({multiple:!0,allowClear:!0,placeholder:c.a.I18n.t("categoriesAndTags"),ajax:{data:function(e){return{term:e.term,page:e.page||1}},transport:function(t,i,o){var n,r=I.getTaxonomies(e.model.get("contentType")).then(function(e){return n=e,I.getTerms({search:t.data.term,page:t.data.page,taxonomies:M.a.keys(n)}).then(function(e){return{taxonomies:n,terms:e}})});return r.then(i),r.fail(o),r},processResults:function(e){return{results:M.a.map(e.terms,function(t){return M.a.defaults({text:e.taxonomies[t.taxonomy].labels.singular_name+": "+t.name,id:t.term_id},t)}),pagination:{more:100===e.terms.length}}}}}).on({"select2:select":function(t){var i=e.model.get("terms");i.add(t.params.data),e.model.set("terms",i.toJSON())},"select2:unselect":function(t){var i=e.model.get("terms");i.remove(t.params.data),e.model.set("terms",i.toJSON())}}).trigger("change")},toggleDisplayOptions:function(){var e=this.$(".mailpoet_automated_latest_content_display_options"),t=this.$(".mailpoet_automated_latest_content_show_display_options");e.hasClass("mailpoet_closed")?(e.removeClass("mailpoet_closed"),t.addClass("mailpoet_hidden")):(e.addClass("mailpoet_closed"),t.removeClass("mailpoet_hidden"))},showButtonSettings:function(){new we.ButtonBlockSettingsView({model:this.model.get("readMoreButton"),renderOptions:{displayFormat:"subpanel",hideLink:!0,hideApplyToAll:!0}}).render()},showDividerSettings:function(){new Te.DividerBlockSettingsView({model:this.model.get("divider"),renderOptions:{displayFormat:"subpanel",hideApplyToAll:!0}}).render()},changeReadMoreType:function(e){var t=x()(e.target).val();"link"===t?(this.$(".mailpoet_automated_latest_content_read_more_text").removeClass("mailpoet_hidden"),this.$(".mailpoet_automated_latest_content_select_button").addClass("mailpoet_hidden")):"button"===t&&(this.$(".mailpoet_automated_latest_content_read_more_text").addClass("mailpoet_hidden"),this.$(".mailpoet_automated_latest_content_select_button").removeClass("mailpoet_hidden")),this.changeField("readMoreType",e)},changeDisplayType:function(e){var t=x()(e.target).val();"titleOnly"===t?(this.$(".mailpoet_automated_latest_content_title_as_list").removeClass("mailpoet_hidden"),this.$(".mailpoet_automated_latest_content_image_full_width_option").addClass("mailpoet_hidden"),this.$(".mailpoet_automated_latest_content_image_separator").addClass("mailpoet_hidden")):(this.$(".mailpoet_automated_latest_content_title_as_list").addClass("mailpoet_hidden"),this.$(".mailpoet_automated_latest_content_image_full_width_option").removeClass("mailpoet_hidden"),this.$(".mailpoet_automated_latest_content_image_separator").removeClass("mailpoet_hidden"),"ul"===this.model.get("titleFormat")&&(this.model.set("titleFormat","h1"),this.$(".mailpoet_automated_latest_content_title_format").val(["h1"]),this.$(".mailpoet_automated_latest_content_title_as_link").removeClass("mailpoet_hidden"))),"excerpt"===t?this.$(".mailpoet_automated_latest_content_featured_image_position_container").removeClass("mailpoet_hidden"):this.$(".mailpoet_automated_latest_content_featured_image_position_container").addClass("mailpoet_hidden"),this.changeField("displayType",e)},changeTitleFormat:function(e){"ul"===x()(e.target).val()?(this.$(".mailpoet_automated_latest_content_non_title_list_options").addClass("mailpoet_hidden"),this.model.set("titleIsLink",!0),this.$(".mailpoet_automated_latest_content_title_as_link").addClass("mailpoet_hidden"),this.$(".mailpoet_automated_latest_content_title_as_links").val(["true"])):(this.$(".mailpoet_automated_latest_content_non_title_list_options").removeClass("mailpoet_hidden"),this.$(".mailpoet_automated_latest_content_title_as_link").removeClass("mailpoet_hidden")),this.changeField("titleFormat",e)},_updateContentTypes:function(e){var t=this.$(".mailpoet_automated_latest_content_content_type"),i=this.model.get("contentType");t.find("option").remove(),M.a.each(e,function(e){t.append(x()("<option>",{value:e.name,text:e.label}))}),t.val(i)}}),Oe.AutomatedLatestContentWidgetView=Fe.WidgetView.extend({getTemplate:function(){return window.templates.automatedLatestContentInsertion},behaviors:{DraggableBehavior:{cloneOriginal:!0,drop:function(){return new Oe.AutomatedLatestContentBlockModel({},{parse:!0})},onDrop:function(e){e.droppedView.triggerMethod("showSettings")}}}}),T.on("before:start",function(e){e.registerBlockType("automatedLatestContent",{blockModel:Oe.AutomatedLatestContentBlockModel,blockView:Oe.AutomatedLatestContentBlockView})}),T.on("start",function(e){var t=e;t._ALCSupervisor=new Oe.ALCSupervisor,t._ALCSupervisor.refresh()});var Ie={},ze=ue;Ie.ALCLayoutSupervisor=B.a.extend({initialize:function(){this.listenTo(T.getChannel(),"automatedLatestContentLayoutRefresh",M.a.debounce(this.refresh,500))},refresh:function(){var e,t=T.findModels(function(e){return"automatedLatestContentLayout"===e.get("type")})||[];0!==t.length&&(e=M.a.map(t,function(e){return e.toJSON()}),I.getBulkTransformedPosts({blocks:e}).then(M.a.partial(this.refreshBlocks,t)))},refreshBlocks:function(e,t){M.a.each(M.a.zip(e,t),function(e){var t=e[0],i=e[1];t.trigger("refreshPosts",i)})}}),Ie.AutomatedLatestContentLayoutBlockModel=ze.BlockModel.extend({stale:["_container"],defaults:function(){return this._getDefaults({type:"automatedLatestContentLayout",withLayout:!0,amount:"5",contentType:"post",terms:[],inclusionType:"include",displayType:"excerpt",titleFormat:"h1",titleAlignment:"left",titleIsLink:!1,imageFullWidth:!1,titlePosition:"abovePost",featuredImagePosition:"centered",showAuthor:"no",authorPrecededBy:"Author:",showCategories:"no",categoriesPrecededBy:"Categories:",readMoreType:"button",readMoreText:"Read more",readMoreButton:{text:"Read more",url:"[postLink]"},sortBy:"newest",showDivider:!0,divider:{},_container:new(T.getBlockTypeModel("container"))},T.getConfig().get("blockDefaults.automatedLatestContentLayout"))},relations:function(){return{readMoreButton:T.getBlockTypeModel("button"),divider:T.getBlockTypeModel("divider"),_container:T.getBlockTypeModel("container")}},initialize:function(){ze.BlockView.prototype.initialize.apply(this,arguments),this.on("change:amount change:contentType change:terms change:inclusionType change:displayType change:titleFormat change:featuredImagePosition change:titleAlignment change:titleIsLink change:imageFullWidth change:showAuthor change:authorPrecededBy change:showCategories change:categoriesPrecededBy change:readMoreType change:readMoreText change:sortBy change:showDivider change:titlePosition",this._handleChanges,this),this.listenTo(this.get("readMoreButton"),"change",this._handleChanges),this.listenTo(this.get("divider"),"change",this._handleChanges),this.on("add remove update reset",this._handleChanges),this.on("refreshPosts",this.updatePosts,this)},updatePosts:function(e){this.get("_container.blocks").reset(e,{parse:!0})},_handleChanges:function(){this._updateDefaults(),T.getChannel().trigger("automatedLatestContentLayoutRefresh")}}),Ie.AutomatedLatestContentLayoutBlockView=ze.BlockView.extend({className:"mailpoet_block mailpoet_automated_latest_content_block mailpoet_droppable_block",initialize:function(){T.getChannel().on("replaceAllButtonStyles",function(e){this.model.set({readMoreButton:e})}.bind(this))},getTemplate:function(){return window.templates.automatedLatestContentLayoutBlock},regions:{toolsRegion:".mailpoet_tools",postsRegion:".mailpoet_automated_latest_content_block_posts"},modelEvents:M.a.extend(M.a.omit(ze.BlockView.prototype.modelEvents,"change"),{postsChanged:"render"}),events:{"click .mailpoet_automated_latest_content_block_overlay":"showSettings"},onDragSubstituteBy:function(){return Ie.AutomatedLatestContentLayoutWidgetView},onRender:function(){var e=T.getBlockTypeView("container"),t={disableTextEditor:!0,disableDragAndDrop:!0,emptyContainerMessage:c.a.I18n.t("noPostsToDisplay")};this.toolsView=new Ie.AutomatedLatestContentLayoutBlockToolsView({model:this.model}),this.showChildView("toolsRegion",this.toolsView),this.showChildView("postsRegion",new e({model:this.model.get("_container"),renderOptions:t}))},duplicateBlock:function(){var e=this.model.toJSON(),t=new Ie.AutomatedLatestContentLayoutBlockModel(e);this.model.collection.add(t,{at:this.model.collection.findIndex(this.model)})}}),Ie.AutomatedLatestContentLayoutBlockToolsView=ze.BlockToolsView.extend({getSettingsView:function(){return Ie.AutomatedLatestContentLayoutBlockSettingsView}}),Ie.AutomatedLatestContentLayoutBlockSettingsView=ze.BlockSettingsView.extend({getTemplate:function(){return window.templates.automatedLatestContentLayoutBlockSettings},events:function(){return{"click .mailpoet_automated_latest_content_hide_display_options":"toggleDisplayOptions","click .mailpoet_automated_latest_content_show_display_options":"toggleDisplayOptions","click .mailpoet_automated_latest_content_select_button":"showButtonSettings","click .mailpoet_automated_latest_content_select_divider":"showDividerSettings","change .mailpoet_automated_latest_content_read_more_type":"changeReadMoreType","change .mailpoet_automated_latest_content_display_type":"changeDisplayType","change .mailpoet_automated_latest_content_title_format":"changeTitleFormat","change .mailpoet_automated_latest_content_title_as_links":M.a.partial(this.changeBoolField,"titleIsLink"),"change .mailpoet_automated_latest_content_show_divider":M.a.partial(this.changeBoolField,"showDivider"),"input .mailpoet_automated_latest_content_show_amount":M.a.partial(this.changeField,"amount"),"change .mailpoet_automated_latest_content_content_type":M.a.partial(this.changeField,"contentType"),"change .mailpoet_automated_latest_content_include_or_exclude":M.a.partial(this.changeField,"inclusionType"),"change .mailpoet_automated_latest_content_title_alignment":M.a.partial(this.changeField,"titleAlignment"),"change .mailpoet_automated_latest_content_image_full_width":M.a.partial(this.changeBoolField,"imageFullWidth"),"change .mailpoet_automated_latest_content_featured_image_position":M.a.partial(this.changeField,"featuredImagePosition"),"change .mailpoet_automated_latest_content_show_author":M.a.partial(this.changeField,"showAuthor"),"input .mailpoet_automated_latest_content_author_preceded_by":M.a.partial(this.changeField,"authorPrecededBy"),"change .mailpoet_automated_latest_content_show_categories":M.a.partial(this.changeField,"showCategories"),"input .mailpoet_automated_latest_content_categories":M.a.partial(this.changeField,"categoriesPrecededBy"),"input .mailpoet_automated_latest_content_read_more_text":M.a.partial(this.changeField,"readMoreText"),"change .mailpoet_automated_latest_content_sort_by":M.a.partial(this.changeField,"sortBy"),"change .mailpoet_automated_latest_content_title_position":M.a.partial(this.changeField,"titlePosition"),"click .mailpoet_done_editing":"close"}},onRender:function(){var e=this;I.getPostTypes().done(M.a.bind(this._updateContentTypes,this)),this.$(".mailpoet_automated_latest_content_categories_and_tags").select2({multiple:!0,allowClear:!0,placeholder:c.a.I18n.t("categoriesAndTags"),ajax:{data:function(e){return{term:e.term,page:e.page||1}},transport:function(t,i,o){var n,r=I.getTaxonomies(e.model.get("contentType")).then(function(e){return n=e,I.getTerms({search:t.data.term,page:t.data.page,taxonomies:M.a.keys(n)}).then(function(e){return{taxonomies:n,terms:e}})});return r.then(i),r.fail(o),r},processResults:function(e){return{results:M.a.map(e.terms,function(t){return M.a.defaults({text:e.taxonomies[t.taxonomy].labels.singular_name+": "+t.name,id:t.term_id},t)}),pagination:{more:100===e.terms.length}}}}}).on({"select2:select":function(t){var i=e.model.get("terms");i.add(t.params.data),e.model.set("terms",i.toJSON())},"select2:unselect":function(t){var i=e.model.get("terms");i.remove(t.params.data),e.model.set("terms",i.toJSON())}}).trigger("change")},toggleDisplayOptions:function(){var e=this.$(".mailpoet_automated_latest_content_display_options"),t=this.$(".mailpoet_automated_latest_content_show_display_options");e.hasClass("mailpoet_closed")?(e.removeClass("mailpoet_closed"),t.addClass("mailpoet_hidden")):(e.addClass("mailpoet_closed"),t.removeClass("mailpoet_hidden"))},showButtonSettings:function(){new we.ButtonBlockSettingsView({model:this.model.get("readMoreButton"),renderOptions:{displayFormat:"subpanel",hideLink:!0,hideApplyToAll:!0}}).render()},showDividerSettings:function(){new Te.DividerBlockSettingsView({model:this.model.get("divider"),renderOptions:{displayFormat:"subpanel",hideApplyToAll:!0}}).render()},changeReadMoreType:function(e){var t=x()(e.target).val();"link"===t?(this.$(".mailpoet_automated_latest_content_read_more_text").removeClass("mailpoet_hidden"),this.$(".mailpoet_automated_latest_content_select_button").addClass("mailpoet_hidden")):"button"===t&&(this.$(".mailpoet_automated_latest_content_read_more_text").addClass("mailpoet_hidden"),this.$(".mailpoet_automated_latest_content_select_button").removeClass("mailpoet_hidden")),this.changeField("readMoreType",e)},changeDisplayType:function(e){var t=x()(e.target).val();"titleOnly"===t?(this.$(".mailpoet_automated_latest_content_title_as_list").removeClass("mailpoet_hidden"),this.$(".mailpoet_automated_latest_content_image_full_width_option").addClass("mailpoet_hidden"),this.$(".mailpoet_automated_latest_content_image_separator").addClass("mailpoet_hidden")):(this.$(".mailpoet_automated_latest_content_title_as_list").addClass("mailpoet_hidden"),this.$(".mailpoet_automated_latest_content_image_full_width_option").removeClass("mailpoet_hidden"),this.$(".mailpoet_automated_latest_content_image_separator").removeClass("mailpoet_hidden"),"ul"===this.model.get("titleFormat")&&(this.model.set("titleFormat","h1"),this.$(".mailpoet_automated_latest_content_title_format").val(["h1"]),this.$(".mailpoet_automated_latest_content_title_as_link").removeClass("mailpoet_hidden"))),"excerpt"===t?(this.$(".mailpoet_automated_latest_content_featured_image_position_container").removeClass("mailpoet_hidden"),this.$(".mailpoet_automated_latest_content_title_position_separator").removeClass("mailpoet_hidden"),this.$(".mailpoet_automated_latest_content_title_position").removeClass("mailpoet_hidden")):(this.$(".mailpoet_automated_latest_content_featured_image_position_container").addClass("mailpoet_hidden"),this.$(".mailpoet_automated_latest_content_title_position_separator").addClass("mailpoet_hidden"),this.$(".mailpoet_automated_latest_content_title_position").addClass("mailpoet_hidden")),this.changeField("displayType",e)},changeTitleFormat:function(e){"ul"===x()(e.target).val()?(this.$(".mailpoet_automated_latest_content_non_title_list_options").addClass("mailpoet_hidden"),this.model.set("titleIsLink",!0),this.$(".mailpoet_automated_latest_content_title_as_link").addClass("mailpoet_hidden"),this.$(".mailpoet_automated_latest_content_title_as_links").val(["true"])):(this.$(".mailpoet_automated_latest_content_non_title_list_options").removeClass("mailpoet_hidden"),this.$(".mailpoet_automated_latest_content_title_as_link").removeClass("mailpoet_hidden")),this.changeField("titleFormat",e)},_updateContentTypes:function(e){var t=this.$(".mailpoet_automated_latest_content_content_type"),i=this.model.get("contentType");t.find("option").remove(),M.a.each(e,function(e){t.append(x()("<option>",{value:e.name,text:e.label}))}),t.val(i)}}),Ie.AutomatedLatestContentLayoutWidgetView=ze.WidgetView.extend({className:ze.WidgetView.prototype.className+" mailpoet_droppable_layout_block",getTemplate:function(){return window.templates.automatedLatestContentLayoutInsertion},behaviors:{DraggableBehavior:{cloneOriginal:!0,drop:function(){return new Ie.AutomatedLatestContentLayoutBlockModel({},{parse:!0})},onDrop:function(e){e.droppedView.triggerMethod("showSettings")}}}}),T.on("before:start",function(e){e.registerBlockType("automatedLatestContentLayout",{blockModel:Ie.AutomatedLatestContentLayoutBlockModel,blockView:Ie.AutomatedLatestContentLayoutBlockView}),e.registerWidget({name:"automatedLatestContentLayout",widgetView:Ie.AutomatedLatestContentLayoutWidgetView,priority:97})}),T.on("start",function(e){var t=e;t._ALCLayoutSupervisor=new Ie.ALCLayoutSupervisor,t._ALCLayoutSupervisor.refresh()});i(370);var Ne,Le,$e,We,He,Ue={},je=ue;Ue.PostsBlockModel=je.BlockModel.extend({stale:["_selectedPosts","_availablePosts","_transformedPosts"],defaults:function(){return this._getDefaults({type:"posts",withLayout:!0,amount:"10",offset:0,contentType:"post",postStatus:"publish",terms:[],search:"",inclusionType:"include",displayType:"excerpt",titleFormat:"h1",titleAlignment:"left",titleIsLink:!1,imageFullWidth:!1,titlePosition:"abovePost",featuredImagePosition:"centered",showAuthor:"no",authorPrecededBy:"Author:",showCategories:"no",categoriesPrecededBy:"Categories:",readMoreType:"link",readMoreText:"Read more",readMoreButton:{text:"Read more",url:"[postLink]"},sortBy:"newest",showDivider:!0,divider:{},_selectedPosts:[],_availablePosts:[],_transformedPosts:new(T.getBlockTypeModel("container"))},T.getConfig().get("blockDefaults.posts"))},relations:function(){return{readMoreButton:T.getBlockTypeModel("button"),divider:T.getBlockTypeModel("divider"),_selectedPosts:N.a.Collection,_availablePosts:N.a.Collection,_transformedPosts:T.getBlockTypeModel("container")}},initialize:function(){var e=M.a.debounce(this.fetchAvailablePosts.bind(this),500),t=M.a.debounce(this._refreshTransformedPosts.bind(this),500);M.a.extend(this,y.a.Requests),this.fetchAvailablePosts(),this.on("change",this._updateDefaults,this),this.on("change:contentType change:terms change:postStatus change:search",e),this.on("loadMorePosts",this._loadMorePosts,this),this.listenTo(this.get("_selectedPosts"),"add remove reset",t),this.on("change:displayType change:titleFormat change:featuredImagePosition change:titleAlignment change:titleIsLink change:imageFullWidth change:showAuthor change:authorPrecededBy change:showCategories change:categoriesPrecededBy change:readMoreType change:readMoreText change:showDivider change:titlePosition",t),this.listenTo(this.get("readMoreButton"),"change",t),this.listenTo(this.get("divider"),"change",t),this.listenTo(T.getChannel(),"hideSettings",this.destroy),this.on("insertSelectedPosts",this._insertSelectedPosts,this)},fetchAvailablePosts:function(){var e=this;this.set("offset",0),I.getPosts(this.toJSON()).done(function(t){e.get("_availablePosts").reset(t),e.get("_selectedPosts").reset(),e.trigger("change:_availablePosts")}).fail(function(){c.a.Notice.error(c.a.I18n.t("failedToFetchAvailablePosts"))})},_loadMorePosts:function(){var e=this,t=this.get("_availablePosts").length,i=this.get("offset")+Number(this.get("amount"));return!(0===t||t<i)&&(this.set("offset",i),this.trigger("loadingMorePosts"),I.getPosts(this.toJSON()).done(function(t){e.get("_availablePosts").add(t),e.trigger("change:_availablePosts")}).fail(function(){c.a.Notice.error(c.a.I18n.t("failedToFetchAvailablePosts"))}).always(function(){e.trigger("morePostsLoaded")}),!0)},_refreshTransformedPosts:function(){var e=this,t=this.toJSON();t.posts=this.get("_selectedPosts").pluck("ID"),0!==t.posts.length?I.getTransformedPosts(t).done(function(t){e.get("_transformedPosts").get("blocks").reset(t,{parse:!0})}).fail(function(){c.a.Notice.error(c.a.I18n.t("failedToFetchRenderedPosts"))}):this.get("_transformedPosts").get("blocks").reset()},_insertSelectedPosts:function(){var e=this.toJSON(),t=this.collection.indexOf(this),i=this.collection;e.posts=this.get("_selectedPosts").pluck("ID"),0!==e.posts.length&&I.getTransformedPosts(e).done(function(e){i.add(JSON.parse(R()(e)),{at:t})}).fail(function(){c.a.Notice.error(c.a.I18n.t("failedToFetchRenderedPosts"))})}}),Ue.PostsBlockView=je.BlockView.extend({className:"mailpoet_block mailpoet_posts_block mailpoet_droppable_block",getTemplate:function(){return window.templates.postsBlock},modelEvents:{},regions:M.a.extend({postsRegion:".mailpoet_posts_container"},je.BlockView.prototype.regions),onDragSubstituteBy:function(){return Ue.PostsWidgetView},initialize:function(){je.BlockView.prototype.initialize.apply(this,arguments),this.toolsView=new Ue.PostsBlockToolsView({model:this.model}),this.model.reply("blockView",this.notifyAboutSelf,this)},onRender:function(){var e,t;this.getRegion("toolsRegion").hasView()||this.showChildView("toolsRegion",this.toolsView),this.trigger("showSettings"),e=T.getBlockTypeView("container"),t={disableTextEditor:!0,disableDragAndDrop:!0,emptyContainerMessage:c.a.I18n.t("noPostsToDisplay")},this.showChildView("postsRegion",new e({model:this.model.get("_transformedPosts"),renderOptions:t}))},notifyAboutSelf:function(){return this},onBeforeDestroy:function(){this.model.stopReplying("blockView",this.notifyAboutSelf,this)}}),Ue.PostsBlockToolsView=je.BlockToolsView.extend({getSettingsView:function(){return Ue.PostsBlockSettingsView}}),Ue.PostsBlockSettingsView=je.BlockSettingsView.extend({getTemplate:function(){return window.templates.postsBlockSettings},regions:{selectionRegion:".mailpoet_settings_posts_selection",displayOptionsRegion:".mailpoet_settings_posts_display_options"},events:{"click .mailpoet_settings_posts_show_display_options":"switchToDisplayOptions","click .mailpoet_settings_posts_show_post_selection":"switchToPostSelection","click .mailpoet_settings_posts_insert_selected":"insertPosts"},templateContext:function(){return{model:this.model.toJSON()}},initialize:function(){this.model.trigger("startEditing"),this.selectionView=new We({model:this.model}),this.displayOptionsView=new Ne({model:this.model})},onRender:function(){var e=this;this.model.request("blockView"),this.showChildView("selectionRegion",this.selectionView),this.showChildView("displayOptionsRegion",this.displayOptionsView),c.a.Modal.panel({element:this.$el,template:"",position:"right",overlayRender:!1,width:T.getConfig().get("sidepanelWidth"),onCancel:function(){e.model.destroy()}}),this.selectionView.triggerMethod("attach"),this.displayOptionsView.triggerMethod("attach")},switchToDisplayOptions:function(){this.$(".mailpoet_settings_posts_selection").addClass("mailpoet_closed"),this.$(".mailpoet_settings_posts_display_options").removeClass("mailpoet_closed"),this.$(".mailpoet_settings_posts_show_display_options").addClass("mailpoet_hidden"),this.$(".mailpoet_settings_posts_show_post_selection").removeClass("mailpoet_hidden")},switchToPostSelection:function(){this.$(".mailpoet_settings_posts_display_options").addClass("mailpoet_closed"),this.$(".mailpoet_settings_posts_selection").removeClass("mailpoet_closed"),this.$(".mailpoet_settings_posts_show_post_selection").addClass("mailpoet_hidden"),this.$(".mailpoet_settings_posts_show_display_options").removeClass("mailpoet_hidden")},insertPosts:function(){this.model.trigger("insertSelectedPosts"),this.model.destroy(),this.close()}}),He=v.a.CollectionView.extend({className:"mailpoet_post_scroll_container",childView:function(){return Le},emptyView:function(){return $e},childViewOptions:function(){return{blockModel:this.blockModel}},initialize:function(e){this.blockModel=e.blockModel},events:{scroll:"onPostsScroll"},onPostsScroll:function(e){var t=x()(e.target);t.scrollTop()+t.innerHeight()>=t[0].scrollHeight&&this.blockModel.trigger("loadMorePosts")}}),We=v.a.View.extend({getTemplate:function(){return window.templates.postSelectionPostsBlockSettings},regions:{posts:".mailpoet_post_selection_container"},events:function(){return{"change .mailpoet_settings_posts_content_type":M.a.partial(this.changeField,"contentType"),"change .mailpoet_posts_post_status":M.a.partial(this.changeField,"postStatus"),"input .mailpoet_posts_search_term":M.a.partial(this.changeField,"search")}},modelEvents:{"change:offset":function(e,t){0===t&&this.$(".mailpoet_post_scroll_container").scrollTop(0)},loadingMorePosts:function(){this.$(".mailpoet_post_selection_loading").css("visibility","visible")},morePostsLoaded:function(){this.$(".mailpoet_post_selection_loading").css("visibility","hidden")}},templateContext:function(){return{model:this.model.toJSON()}},onRender:function(){var e;I.getPostTypes().done(M.a.bind(this._updateContentTypes,this)),e=new He({collection:this.model.get("_availablePosts"),blockModel:this.model}),this.showChildView("posts",e)},onAttach:function(){var e=this;this.$(".mailpoet_posts_categories_and_tags").select2({multiple:!0,allowClear:!0,placeholder:c.a.I18n.t("categoriesAndTags"),ajax:{data:function(e){return{term:e.term,page:e.page||1}},transport:function(t,i,o){var n,r=I.getTaxonomies(e.model.get("contentType")).then(function(e){return n=e,I.getTerms({search:t.data.term,page:t.data.page,taxonomies:M.a.keys(n)}).then(function(e){return{taxonomies:n,terms:e}})});return r.then(i),r.fail(o),r},processResults:function(e){return{results:M.a.map(e.terms,function(t){return M.a.defaults({text:e.taxonomies[t.taxonomy].labels.singular_name+": "+t.name,id:t.term_id},t)}),pagination:{more:100===e.terms.length}}}}}).on({"select2:select":function(t){var i=e.model.get("terms");i.add(t.params.data),e.model.set("terms",i.toJSON())},"select2:unselect":function(t){var i=e.model.get("terms");i.remove(t.params.data),e.model.set("terms",i.toJSON())}}).trigger("change")},changeField:function(e,t){this.model.set(e,x()(t.target).val())},_updateContentTypes:function(e){var t=this.$(".mailpoet_settings_posts_content_type"),i=this.model.get("contentType");t.find("option").remove(),M.a.each(e,function(e){t.append(x()("<option>",{value:e.name,text:e.label}))}),t.val(i)}}),$e=v.a.View.extend({getTemplate:function(){return window.templates.emptyPostPostsBlockSettings}}),Le=v.a.View.extend({getTemplate:function(){return window.templates.singlePostPostsBlockSettings},events:function(){return{"change .mailpoet_select_post_checkbox":"postSelectionChange"}},templateContext:function(){return{model:this.model.toJSON(),index:this._index}},initialize:function(e){this.blockModel=e.blockModel},postSelectionChange:function(e){var t=x()(e.target),i=this.blockModel.get("_selectedPosts");t.prop("checked")?i.add(this.model):i.remove(this.model)}}),Ne=je.BlockSettingsView.extend({getTemplate:function(){return window.templates.displayOptionsPostsBlockSettings},events:function(){return{"click .mailpoet_posts_select_button":"showButtonSettings","click .mailpoet_posts_select_divider":"showDividerSettings","change .mailpoet_posts_read_more_type":"changeReadMoreType","change .mailpoet_posts_display_type":"changeDisplayType","change .mailpoet_posts_title_format":"changeTitleFormat","change .mailpoet_posts_title_as_links":M.a.partial(this.changeBoolField,"titleIsLink"),"change .mailpoet_posts_show_divider":M.a.partial(this.changeBoolField,"showDivider"),"change .mailpoet_posts_content_type":M.a.partial(this.changeField,"contentType"),"change .mailpoet_posts_title_alignment":M.a.partial(this.changeField,"titleAlignment"),"change .mailpoet_posts_image_full_width":M.a.partial(this.changeBoolField,"imageFullWidth"),"change .mailpoet_posts_featured_image_position":M.a.partial(this.changeField,"featuredImagePosition"),"change .mailpoet_posts_show_author":M.a.partial(this.changeField,"showAuthor"),"input .mailpoet_posts_author_preceded_by":M.a.partial(this.changeField,"authorPrecededBy"),"change .mailpoet_posts_show_categories":M.a.partial(this.changeField,"showCategories"),"input .mailpoet_posts_categories":M.a.partial(this.changeField,"categoriesPrecededBy"),"input .mailpoet_posts_read_more_text":M.a.partial(this.changeField,"readMoreText"),"change .mailpoet_automated_latest_content_title_position":M.a.partial(this.changeField,"titlePosition")}},templateContext:function(){return{model:this.model.toJSON()}},showButtonSettings:function(){new we.ButtonBlockSettingsView({model:this.model.get("readMoreButton"),renderOptions:{displayFormat:"subpanel",hideLink:!0,hideApplyToAll:!0}}).render()},showDividerSettings:function(){new Te.DividerBlockSettingsView({model:this.model.get("divider"),renderOptions:{displayFormat:"subpanel",hideApplyToAll:!0}}).render()},changeReadMoreType:function(e){var t=x()(e.target).val();"link"===t?(this.$(".mailpoet_posts_read_more_text").removeClass("mailpoet_hidden"),this.$(".mailpoet_posts_select_button").addClass("mailpoet_hidden")):"button"===t&&(this.$(".mailpoet_posts_read_more_text").addClass("mailpoet_hidden"),this.$(".mailpoet_posts_select_button").removeClass("mailpoet_hidden")),this.changeField("readMoreType",e)},changeDisplayType:function(e){var t=x()(e.target).val();"titleOnly"===t?(this.$(".mailpoet_posts_title_as_list").removeClass("mailpoet_hidden"),this.$(".mailpoet_posts_image_full_width_option").addClass("mailpoet_hidden"),this.$(".mailpoet_posts_image_separator").addClass("mailpoet_hidden")):(this.$(".mailpoet_posts_title_as_list").addClass("mailpoet_hidden"),this.$(".mailpoet_posts_image_full_width_option").removeClass("mailpoet_hidden"),this.$(".mailpoet_posts_image_separator").removeClass("mailpoet_hidden"),"ul"===this.model.get("titleFormat")&&(this.model.set("titleFormat","h1"),this.$(".mailpoet_posts_title_format").val(["h1"]),this.$(".mailpoet_posts_title_as_link").removeClass("mailpoet_hidden"))),"excerpt"===t?this.$(".mailpoet_posts_featured_image_position_container").removeClass("mailpoet_hidden"):this.$(".mailpoet_posts_featured_image_position_container").addClass("mailpoet_hidden"),this.changeField("displayType",e)},changeTitleFormat:function(e){"ul"===x()(e.target).val()?(this.$(".mailpoet_posts_non_title_list_options").addClass("mailpoet_hidden"),this.model.set("titleIsLink",!0),this.$(".mailpoet_posts_title_as_link").addClass("mailpoet_hidden"),this.$(".mailpoet_posts_title_as_links").val(["true"])):(this.$(".mailpoet_posts_non_title_list_options").removeClass("mailpoet_hidden"),this.$(".mailpoet_posts_title_as_link").removeClass("mailpoet_hidden")),this.changeField("titleFormat",e)}}),Ue.PostsWidgetView=je.WidgetView.extend({className:je.WidgetView.prototype.className+" mailpoet_droppable_layout_block",getTemplate:function(){return window.templates.postsInsertion},behaviors:{DraggableBehavior:{cloneOriginal:!0,drop:function(){return new Ue.PostsBlockModel({},{parse:!0})}}}}),T.on("before:start",function(e){e.registerBlockType("posts",{blockModel:Ue.PostsBlockModel,blockView:Ue.PostsBlockView}),e.registerWidget({name:"posts",widgetView:Ue.PostsWidgetView,priority:96})});var qe,Ye,Xe,Je,Ge,Ke={},Qe=ue;Ke.ProductsBlockModel=Qe.BlockModel.extend({stale:["_selectedProducts","_availableProducts","_transformedProducts"],defaults:function(){return this._getDefaults({type:"products",withLayout:!0,amount:"10",offset:0,contentType:"product",postStatus:"publish",terms:[],search:"",inclusionType:"include",displayType:"excerpt",titleFormat:"h1",titleAlignment:"left",titleIsLink:!1,imageFullWidth:!1,titlePosition:"abovePost",featuredImagePosition:"alternate",pricePosition:"below",readMoreType:"link",readMoreText:"Buy now",readMoreButton:{text:"Buy now",url:"[postLink]"},sortBy:"newest",showDivider:!0,divider:{},_selectedProducts:[],_availableProducts:[],_transformedProducts:new(T.getBlockTypeModel("container"))},T.getConfig().get("blockDefaults.products"))},relations:function(){return{readMoreButton:T.getBlockTypeModel("button"),divider:T.getBlockTypeModel("divider"),_selectedProducts:N.a.Collection,_availableProducts:N.a.Collection,_transformedProducts:T.getBlockTypeModel("container")}},initialize:function(){var e=M.a.debounce(this.fetchAvailableProducts.bind(this),500),t=M.a.debounce(this._refreshTransformedProducts.bind(this),500);M.a.extend(this,y.a.Requests),this.fetchAvailableProducts(),this.on("change",this._updateDefaults,this),this.on("change:terms change:postStatus change:search",e),this.on("loadMoreProducts",this._loadMoreProducts,this),this.listenTo(this.get("_selectedProducts"),"add remove reset",t),this.on("change:displayType change:titleFormat change:featuredImagePosition change:titleAlignment change:titleIsLink change:imageFullWidth change:pricePosition change:readMoreType change:readMoreText change:showDivider change:titlePosition",t),this.listenTo(this.get("readMoreButton"),"change",t),this.listenTo(this.get("divider"),"change",t),this.on("insertSelectedProducts",this._insertSelectedProducts,this)},fetchAvailableProducts:function(){var e=this;this.set("offset",0),I.getPosts(this.toJSON()).done(function(t){e.get("_availableProducts").reset(t),e.get("_selectedProducts").reset(),e.trigger("change:_availableProducts")}).fail(function(){c.a.Notice.error(c.a.I18n.t("failedToFetchAvailablePosts"))})},_loadMoreProducts:function(){var e=this,t=this.get("_availableProducts").length,i=this.get("offset")+Number(this.get("amount"));return!(0===t||t<i)&&(this.set("offset",i),this.trigger("loadingMoreProducts"),I.getPosts(this.toJSON()).done(function(t){e.get("_availableProducts").add(t),e.trigger("change:_availableProducts")}).fail(function(){c.a.Notice.error(c.a.I18n.t("failedToFetchAvailablePosts"))}).always(function(){e.trigger("moreProductsLoaded")}),!0)},_refreshTransformedProducts:function(){var e=this,t=this.toJSON();t.posts=this.get("_selectedProducts").pluck("ID"),0!==t.posts.length?I.getTransformedPosts(t).done(function(t){e.get("_transformedProducts").get("blocks").reset(t,{parse:!0})}).fail(function(){c.a.Notice.error(c.a.I18n.t("failedToFetchRenderedPosts"))}):this.get("_transformedProducts").get("blocks").reset()},_insertSelectedProducts:function(){var e=this.toJSON(),t=this.collection.indexOf(this),i=this.collection;e.posts=this.get("_selectedProducts").pluck("ID"),0!==e.posts.length&&I.getTransformedPosts(e).done(function(e){i.add(JSON.parse(R()(e)),{at:t})}).fail(function(){c.a.Notice.error(c.a.I18n.t("failedToFetchRenderedPosts"))})}}),Ke.ProductsBlockView=Qe.BlockView.extend({className:"mailpoet_block mailpoet_products_block mailpoet_droppable_block",getTemplate:function(){return window.templates.productsBlock},modelEvents:{},regions:M.a.extend({productsRegion:".mailpoet_products_container"},Qe.BlockView.prototype.regions),onDragSubstituteBy:function(){return Ke.ProductsWidgetView},initialize:function(){Qe.BlockView.prototype.initialize.apply(this,arguments),this.toolsView=new Ke.ProductsBlockToolsView({model:this.model}),this.model.reply("blockView",this.notifyAboutSelf,this)},onRender:function(){var e,t;this.getRegion("toolsRegion").hasView()||this.showChildView("toolsRegion",this.toolsView),this.trigger("showSettings"),e=T.getBlockTypeView("container"),t={disableTextEditor:!0,disableDragAndDrop:!0,emptyContainerMessage:c.a.I18n.t("noPostsToDisplay")},this.showChildView("productsRegion",new e({model:this.model.get("_transformedProducts"),renderOptions:t}))},notifyAboutSelf:function(){return this},onBeforeDestroy:function(){this.model.stopReplying("blockView",this.notifyAboutSelf,this)}}),Ke.ProductsBlockToolsView=Qe.BlockToolsView.extend({getSettingsView:function(){return Ke.ProductsBlockSettingsView}}),Ke.ProductsBlockSettingsView=Qe.BlockSettingsView.extend({getTemplate:function(){return window.templates.productsBlockSettings},regions:{selectionRegion:".mailpoet_settings_products_selection",displayOptionsRegion:".mailpoet_settings_products_display_options"},events:{"click .mailpoet_settings_products_show_display_options":"switchToDisplayOptions","click .mailpoet_settings_products_show_product_selection":"switchToProductSelection","click .mailpoet_settings_products_insert_selected":"insertProducts"},templateContext:function(){return{model:this.model.toJSON()}},initialize:function(){this.model.trigger("startEditing"),this.selectionView=new Je({model:this.model}),this.displayOptionsView=new qe({model:this.model})},onRender:function(){var e=this;this.model.request("blockView"),this.showChildView("selectionRegion",this.selectionView),this.showChildView("displayOptionsRegion",this.displayOptionsView),c.a.Modal.panel({element:this.$el,template:"",position:"right",overlayRender:!1,width:T.getConfig().get("sidepanelWidth"),onCancel:function(){e.model.destroy()}}),this.selectionView.triggerMethod("attach"),this.displayOptionsView.triggerMethod("attach")},switchToDisplayOptions:function(){this.$(".mailpoet_settings_products_selection").addClass("mailpoet_closed"),this.$(".mailpoet_settings_products_display_options").removeClass("mailpoet_closed"),this.$(".mailpoet_settings_products_show_display_options").addClass("mailpoet_hidden"),this.$(".mailpoet_settings_products_show_product_selection").removeClass("mailpoet_hidden")},switchToProductSelection:function(){this.$(".mailpoet_settings_products_display_options").addClass("mailpoet_closed"),this.$(".mailpoet_settings_products_selection").removeClass("mailpoet_closed"),this.$(".mailpoet_settings_products_show_product_selection").addClass("mailpoet_hidden"),this.$(".mailpoet_settings_products_show_display_options").removeClass("mailpoet_hidden")},insertProducts:function(){this.model.trigger("insertSelectedProducts"),this.model.destroy(),this.close()}}),Ge=v.a.CollectionView.extend({className:"mailpoet_products_scroll_container",childView:function(){return Ye},emptyView:function(){return Xe},childViewOptions:function(){return{blockModel:this.blockModel}},initialize:function(e){this.blockModel=e.blockModel},events:{scroll:"onProductsScroll"},onProductsScroll:function(e){var t=x()(e.target);t.scrollTop()+t.innerHeight()>=t[0].scrollHeight&&this.blockModel.trigger("loadMoreProducts")}}),Je=v.a.View.extend({getTemplate:function(){return window.templates.postSelectionProductsBlockSettings},regions:{posts:".mailpoet_product_selection_container"},events:function(){return{"change .mailpoet_products_post_status":M.a.partial(this.changeField,"postStatus"),"input .mailpoet_products_search_term":M.a.partial(this.changeField,"search")}},modelEvents:{"change:offset":function(e,t){0===t&&this.$(".mailpoet_products_scroll_container").scrollTop(0)},loadingMoreProducts:function(){this.$(".mailpoet_product_selection_loading").css("visibility","visible")},moreProductsLoaded:function(){this.$(".mailpoet_product_selection_loading").css("visibility","hidden")}},templateContext:function(){return{model:this.model.toJSON()}},onRender:function(){var e;e=new Ge({collection:this.model.get("_availableProducts"),blockModel:this.model}),this.showChildView("posts",e)},onAttach:function(){var e=this;this.$(".mailpoet_products_categories_and_tags").select2({multiple:!0,allowClear:!0,placeholder:c.a.I18n.t("categoriesAndTags"),ajax:{data:function(e){return{term:e.term,page:e.page||1}},transport:function(t,i,o){var n,r=I.getTaxonomies(e.model.get("contentType")).then(function(e){return n=e,I.getTerms({search:t.data.term,page:t.data.page,taxonomies:M.a.keys(n)}).then(function(e){return{taxonomies:n,terms:e}})});return r.then(i),r.fail(o),r},processResults:function(e){return{results:M.a.map(e.terms,function(t){return M.a.defaults({text:e.taxonomies[t.taxonomy].labels.singular_name+": "+t.name,id:t.term_id},t)}),pagination:{more:100===e.terms.length}}}}}).on({"select2:select":function(t){var i=e.model.get("terms");i.add(t.params.data),e.model.set("terms",i.toJSON())},"select2:unselect":function(t){var i=e.model.get("terms");i.remove(t.params.data),e.model.set("terms",i.toJSON())}}).trigger("change")},changeField:function(e,t){this.model.set(e,x()(t.target).val())}}),Xe=v.a.View.extend({getTemplate:function(){return window.templates.emptyPostProductsBlockSettings}}),Ye=v.a.View.extend({getTemplate:function(){return window.templates.singlePostProductsBlockSettings},events:function(){return{"change .mailpoet_select_product_checkbox":"productSelectionChange"}},templateContext:function(){return{model:this.model.toJSON(),index:this._index}},initialize:function(e){this.blockModel=e.blockModel},productSelectionChange:function(e){var t=x()(e.target),i=this.blockModel.get("_selectedProducts");t.prop("checked")?i.add(this.model):i.remove(this.model)}}),qe=Qe.BlockSettingsView.extend({getTemplate:function(){return window.templates.displayOptionsProductsBlockSettings},events:function(){return{"click .mailpoet_products_select_button":"showButtonSettings","click .mailpoet_products_select_divider":"showDividerSettings","change .mailpoet_products_read_more_type":"changeReadMoreType","change .mailpoet_products_display_type":"changeDisplayType","change .mailpoet_products_title_format":"changeTitleFormat","change .mailpoet_products_title_as_links":M.a.partial(this.changeBoolField,"titleIsLink"),"change .mailpoet_products_show_divider":M.a.partial(this.changeBoolField,"showDivider"),"change .mailpoet_products_title_alignment":M.a.partial(this.changeField,"titleAlignment"),"change .mailpoet_products_image_full_width":M.a.partial(this.changeBoolField,"imageFullWidth"),"change .mailpoet_products_featured_image_position":M.a.partial(this.changeField,"featuredImagePosition"),"change .mailpoet_products_price_position":M.a.partial(this.changeField,"pricePosition"),"input .mailpoet_products_read_more_text":M.a.partial(this.changeField,"readMoreText"),"change .mailpoet_products_title_position":M.a.partial(this.changeField,"titlePosition")}},templateContext:function(){return{model:this.model.toJSON()}},showButtonSettings:function(){new we.ButtonBlockSettingsView({model:this.model.get("readMoreButton"),renderOptions:{displayFormat:"subpanel",hideLink:!0,hideApplyToAll:!0}}).render()},showDividerSettings:function(){new Te.DividerBlockSettingsView({model:this.model.get("divider"),renderOptions:{displayFormat:"subpanel",hideApplyToAll:!0}}).render()},changeReadMoreType:function(e){var t=x()(e.target).val();"link"===t?(this.$(".mailpoet_products_read_more_text").removeClass("mailpoet_hidden"),this.$(".mailpoet_products_select_button").addClass("mailpoet_hidden")):"button"===t&&(this.$(".mailpoet_products_read_more_text").addClass("mailpoet_hidden"),this.$(".mailpoet_products_select_button").removeClass("mailpoet_hidden")),this.changeField("readMoreType",e)},changeDisplayType:function(e){"titleOnly"!==x()(e.target).val()?(this.$(".mailpoet_products_title_position").removeClass("mailpoet_hidden"),this.$(".mailpoet_products_title_position_separator").removeClass("mailpoet_hidden")):(this.$(".mailpoet_products_title_position").addClass("mailpoet_hidden"),this.$(".mailpoet_products_title_position_separator").addClass("mailpoet_hidden")),this.changeField("displayType",e)},changeTitleFormat:function(e){this.changeField("titleFormat",e)}}),Ke.ProductsWidgetView=Qe.WidgetView.extend({className:Qe.WidgetView.prototype.className+" mailpoet_droppable_layout_block",id:"automation_editor_block_products",getTemplate:function(){return window.templates.productsInsertion},behaviors:{DraggableBehavior:{cloneOriginal:!0,drop:function(){return new Ke.ProductsBlockModel({},{parse:!0})}}}}),T.on("before:start",function(e){window.mailpoet_woocommerce_active&&(e.registerBlockType("products",{blockModel:Ke.ProductsBlockModel,blockView:Ke.ProductsBlockView}),e.registerWidget({name:"products",widgetView:Ke.ProductsWidgetView,priority:98}))});var Ze,et,tt,it,ot,nt={},rt=ue;nt.SocialIconModel=B.a.extend({defaults:function(){var e=T.getConfig().get("socialIcons.custom");return{type:"socialIcon",iconType:"custom",link:e.get("defaultLink"),image:T.getAvailableStyles().get("socialIconSets.default.custom"),height:"32px",width:"32px",text:e.get("title")}},initialize:function(){var e=this;this.on("change:iconType",function(){var t=T.getConfig().get("socialIcons").get(e.get("iconType")),i=e.collection.iconBlockModel.getIconSet();this.set({link:t.get("defaultLink"),image:i.get(e.get("iconType")),text:t.get("title")})},this),this.on("change",function(){T.getChannel().trigger("autoSave")})}}),nt.SocialIconCollectionModel=N.a.Collection.extend({model:nt.SocialIconModel}),nt.SocialBlockModel=rt.BlockModel.extend({name:"iconBlockModel",defaults:function(){return this._getDefaults({type:"social",iconSet:"default",styles:{block:{textAlign:"center"}},icons:new nt.SocialIconCollectionModel},T.getConfig().get("blockDefaults.social"))},relations:{icons:nt.SocialIconCollectionModel},initialize:function(){this.get("icons").on("add remove change",this._iconsChanged,this),this.on("change:iconSet",this.changeIconSet,this),this.on("change",this._updateDefaults,this)},getIconSet:function(){return T.getAvailableStyles().get("socialIconSets").get(this.get("iconSet"))},changeIconSet:function(){var e=this.getIconSet();M.a.each(this.get("icons").models,function(t){t.set("image",e.get(t.get("iconType")))})},_iconsChanged:function(){this._updateDefaults(),T.getChannel().trigger("autoSave")}}),ot=v.a.View.extend({tagName:"span",getTemplate:function(){return window.templates.socialIconBlock},modelEvents:{change:"render"},templateContext:function(){var e=T.getAvailableStyles().get("socialIconSets");return{model:this.model.toJSON(),allIconSets:e.toJSON(),imageMissingSrc:T.getConfig().get("urls.imageMissing")}}}),nt.SocialIconCollectionView=v.a.CollectionView.extend({childView:ot}),nt.SocialBlockView=rt.BlockView.extend({className:"mailpoet_block mailpoet_social_block mailpoet_droppable_block",getTemplate:function(){return window.templates.socialBlock},regions:M.a.extend({},rt.BlockView.prototype.regions,{icons:".mailpoet_social"}),ui:{tools:"> .mailpoet_tools"},behaviors:M.a.extend({},rt.BlockView.prototype.behaviors,{ShowSettingsBehavior:{}}),onDragSubstituteBy:function(){return nt.SocialWidgetView},onRender:function(){this.toolsView=new nt.SocialBlockToolsView({model:this.model}),this.showChildView("toolsRegion",this.toolsView),this.showChildView("icons",new nt.SocialIconCollectionView({collection:this.model.get("icons")}))}}),nt.SocialBlockToolsView=rt.BlockToolsView.extend({getSettingsView:function(){return nt.SocialBlockSettingsView}}),nt.SocialBlockSettingsView=rt.BlockSettingsView.extend({getTemplate:function(){return window.templates.socialBlockSettings},regions:{iconRegion:"#mailpoet_social_icons_selection",stylesRegion:"#mailpoet_social_icons_styles"},events:function(){return{"click .mailpoet_done_editing":"close","change .mailpoet_social_block_alignment":M.a.partial(this.changeField,"styles.block.textAlign")}},initialize:function(){rt.BlockSettingsView.prototype.initialize.apply(this,arguments),this._iconSelectorView=new Ze({model:this.model}),this._stylesView=new it({model:this.model})},onRender:function(){this.showChildView("iconRegion",this._iconSelectorView),this.showChildView("stylesRegion",this._stylesView)}}),et=v.a.View.extend({getTemplate:function(){return window.templates.socialSettingsIcon},events:function(){return{"click .mailpoet_delete_block":"deleteIcon","change .mailpoet_social_icon_field_type":M.a.partial(this.changeField,"iconType"),"input .mailpoet_social_icon_field_image":M.a.partial(this.changeField,"image"),"input .mailpoet_social_icon_field_link":this.changeLink,"input .mailpoet_social_icon_field_text":M.a.partial(this.changeField,"text")}},modelEvents:{"change:iconType":"render","change:image":function(){this.$(".mailpoet_social_icon_image").attr("src",this.model.get("image"))},"change:text":function(){this.$(".mailpoet_social_icon_image").attr("alt",this.model.get("text"))}},templateContext:function(){var e=T.getConfig().get("socialIcons"),t=M.a.map(M.a.keys(e.attributes),function(t){return{iconType:t,title:e.get(t).get("title")}}),i=T.getAvailableStyles().get("socialIconSets");return M.a.extend({},rt.BlockView.prototype.templateContext.apply(this,arguments),{iconTypes:t,currentType:e.get(this.model.get("iconType")).toJSON(),allIconSets:i.toJSON()})},deleteIcon:function(){this.model.destroy()},changeLink:function(e){if("email"!==this.model.get("iconType"))return this.changeField("link",e);this.model.set("link","mailto:"+x()(e.target).val())},changeField:function(e,t){this.model.set(e,x()(t.target).val())}}),tt=v.a.CollectionView.extend({behaviors:{SortableBehavior:{items:"> div"}},childViewContainer:"#mailpoet_social_icon_selector_contents",childView:et}),Ze=v.a.View.extend({getTemplate:function(){return window.templates.socialSettingsIconSelector},regions:{icons:"#mailpoet_social_icon_selector_contents"},events:{"click .mailpoet_add_social_icon":"addSocialIcon"},modelEvents:{"change:iconSet":"render"},addSocialIcon:function(){this.model.get("icons").add({})},onRender:function(){this.showChildView("icons",new tt({collection:this.model.get("icons")}))}}),it=v.a.View.extend({getTemplate:function(){return window.templates.socialSettingsStyles},modelEvents:{change:"render"},events:{"click .mailpoet_social_icon_set":"changeSocialIconSet"},initialize:function(){this.listenTo(this.model.get("icons"),"add remove change",this.render)},templateContext:function(){var e=T.getAvailableStyles().get("socialIconSets");return{activeSet:this.model.get("iconSet"),socialIconSets:e.toJSON(),availableSets:M.a.keys(e.toJSON()),availableSocialIcons:this.model.get("icons").pluck("iconType")}},changeSocialIconSet:function(e){this.model.set("iconSet",x()(e.currentTarget).data("setname"))},onBeforeDestroy:function(){this.model.get("icons").off("add remove",this.render,this)}}),nt.SocialWidgetView=rt.WidgetView.extend({id:"automation_editor_block_social",getTemplate:function(){return window.templates.socialInsertion},behaviors:{DraggableBehavior:{cloneOriginal:!0,drop:function(){return new nt.SocialBlockModel}}}}),T.on("before:start",function(e){e.registerBlockType("social",{blockModel:nt.SocialBlockModel,blockView:nt.SocialBlockView}),e.registerWidget({name:"social",widgetView:nt.SocialWidgetView,priority:95})})},93:function(e,t,i){e.exports=function(e,t){"use strict";e="default"in e?e.default:e,t="default"in t?t.default:t;var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},o=t.Radio,n=t.Radio={};n.VERSION="2.0.0",n.noConflict=function(){return t.Radio=o,this},n.DEBUG=!1,n._debugText=function(e,t,i){return e+(i?" on the "+i+" channel":"")+': "'+t+'"'},n.debugLog=function(e,t,i){n.DEBUG&&console&&console.warn&&console.warn(n._debugText(e,t,i))};var r=/\s+/;function s(e,t,i,o){var n=e[t];if(!(i&&i!==n.callback&&i!==n.callback._callback||o&&o!==n.context))return delete e[t],!0}n._eventsApi=function(t,o,n,s){if(!n)return!1;var a={};if("object"===(void 0===n?"undefined":i(n))){for(var l in n){var c=t[o].apply(t,[l,n[l]].concat(s));r.test(l)?e.extend(a,c):a[l]=c}return a}if(r.test(n)){for(var d=n.split(r),h=0,p=d.length;h<p;h++)a[d[h]]=t[o].apply(t,[d[h]].concat(s));return a}return!1},n._callHandler=function(e,t,i){var o=i[0],n=i[1],r=i[2];switch(i.length){case 0:return e.call(t);case 1:return e.call(t,o);case 2:return e.call(t,o,n);case 3:return e.call(t,o,n,r);default:return e.apply(t,i)}};var a,l,c={};function d(t){return c[t]||(c[t]=e.bind(n.log,n,t))}function h(t){return e.isFunction(t)?t:function(){return t}}e.extend(n,{log:function(t,i){if("undefined"!=typeof console){var o=e.toArray(arguments).slice(2);console.log("["+t+'] "'+i+'"',o)}},tuneIn:function(e){var t=n.channel(e);return t._tunedIn=!0,t.on("all",d(e)),this},tuneOut:function(e){var t=n.channel(e);return t._tunedIn=!1,t.off("all",d(e)),delete c[e],this}}),n.Requests={request:function(t){var i=e.toArray(arguments).slice(1),o=n._eventsApi(this,"request",t,i);if(o)return o;var r=this.channelName,s=this._requests;if(r&&this._tunedIn&&n.log.apply(this,[r,t].concat(i)),s&&(s[t]||s.default)){var a=s[t]||s.default;return i=s[t]?i:arguments,n._callHandler(a.callback,a.context,i)}n.debugLog("An unhandled request was fired",t,r)},reply:function(e,t,i){return n._eventsApi(this,"reply",e,[t,i])?this:(this._requests||(this._requests={}),this._requests[e]&&n.debugLog("A request was overwritten",e,this.channelName),this._requests[e]={callback:h(t),context:i||this},this)},replyOnce:function(t,i,o){if(n._eventsApi(this,"replyOnce",t,[i,o]))return this;var r=this,s=e.once(function(){return r.stopReplying(t),h(i).apply(this,arguments)});return this.reply(t,s,o)},stopReplying:function(t,i,o){return n._eventsApi(this,"stopReplying",t)?this:(t||i||o?function(t,i,o,n){t||(t={});for(var r=i?[i]:e.keys(t),a=!1,l=0,c=r.length;l<c;l++)i=r[l],t[i]&&s(t,i,o,n)&&(a=!0);return a}(this._requests,t,i,o)||n.debugLog("Attempted to remove the unregistered request",t,this.channelName):delete this._requests,this)}},n._channels={},n.channel=function(e){if(!e)throw new Error("You must provide a name for the channel.");return n._channels[e]?n._channels[e]:n._channels[e]=new n.Channel(e)},n.Channel=function(e){this.channelName=e},e.extend(n.Channel.prototype,t.Events,n.Requests,{reset:function(){return this.off(),this.stopListening(),this.stopReplying(),this}});var p=[t.Events,n.Requests];return e.each(p,function(t){e.each(t,function(t,i){n[i]=function(t){return l=e.toArray(arguments).slice(1),(a=this.channel(t))[i].apply(a,l)}})}),n.reset=function(t){var i=t?[this._channels[t]]:this._channels;e.each(i,function(e){e.reset()})},n}(i(3),i(34))}},[[515,0,1]]]);